function stackBlurImage(e,t,i,o){var a=document.getElementById(e),n=a.naturalWidth,r=a.naturalHeight,s=document.getElementById(t);s.style.width=n+"px",s.style.height=r+"px",s.width=n,s.height=r;var l=s.getContext("2d");l.clearRect(0,0,n,r),l.drawImage(a,0,0),isNaN(i)||1>i||(o?stackBlurCanvasRGBA(t,0,0,n,r,i):stackBlurCanvasRGB(t,0,0,n,r,i))}function stackBlurCanvasRGBA(e,t,i,o,a,n){if(!(isNaN(n)||1>n)){n|=0;var r,s=document.getElementById(e),l=s.getContext("2d");try{try{r=l.getImageData(t,i,o,a)}catch(d){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),r=l.getImageData(t,i,o,a)}catch(d){throw alert("Cannot access local image"),new Error("unable to access local image data: "+d)}}}catch(d){throw alert("Cannot access image"),new Error("unable to access image data: "+d)}var c,h,u,m,p,g,_,f,v,b,y,z,S,w,x,C,k,I,T,E,M,A,O,P,F=r.data,B=n+n+1,N=o-1,D=a-1,V=n+1,L=V*(V+1)/2,H=new BlurStack,W=H;for(u=1;B>u;u++)if(W=W.next=new BlurStack,u==V)var R=W;W.next=H;var j=null,G=null;_=g=0;var U=mul_table[n],Z=shg_table[n];for(h=0;a>h;h++){for(C=k=I=T=f=v=b=y=0,z=V*(E=F[g]),S=V*(M=F[g+1]),w=V*(A=F[g+2]),x=V*(O=F[g+3]),f+=L*E,v+=L*M,b+=L*A,y+=L*O,W=H,u=0;V>u;u++)W.r=E,W.g=M,W.b=A,W.a=O,W=W.next;for(u=1;V>u;u++)m=g+((u>N?N:u)<<2),f+=(W.r=E=F[m])*(P=V-u),v+=(W.g=M=F[m+1])*P,b+=(W.b=A=F[m+2])*P,y+=(W.a=O=F[m+3])*P,C+=E,k+=M,I+=A,T+=O,W=W.next;for(j=H,G=R,c=0;o>c;c++)F[g+3]=O=y*U>>Z,0!=O?(O=255/O,F[g]=(f*U>>Z)*O,F[g+1]=(v*U>>Z)*O,F[g+2]=(b*U>>Z)*O):F[g]=F[g+1]=F[g+2]=0,f-=z,v-=S,b-=w,y-=x,z-=j.r,S-=j.g,w-=j.b,x-=j.a,m=_+((m=c+n+1)<N?m:N)<<2,C+=j.r=F[m],k+=j.g=F[m+1],I+=j.b=F[m+2],T+=j.a=F[m+3],f+=C,v+=k,b+=I,y+=T,j=j.next,z+=E=G.r,S+=M=G.g,w+=A=G.b,x+=O=G.a,C-=E,k-=M,I-=A,T-=O,G=G.next,g+=4;_+=o}for(c=0;o>c;c++){for(k=I=T=C=v=b=y=f=0,g=c<<2,z=V*(E=F[g]),S=V*(M=F[g+1]),w=V*(A=F[g+2]),x=V*(O=F[g+3]),f+=L*E,v+=L*M,b+=L*A,y+=L*O,W=H,u=0;V>u;u++)W.r=E,W.g=M,W.b=A,W.a=O,W=W.next;for(p=o,u=1;n>=u;u++)g=p+c<<2,f+=(W.r=E=F[g])*(P=V-u),v+=(W.g=M=F[g+1])*P,b+=(W.b=A=F[g+2])*P,y+=(W.a=O=F[g+3])*P,C+=E,k+=M,I+=A,T+=O,W=W.next,D>u&&(p+=o);for(g=c,j=H,G=R,h=0;a>h;h++)m=g<<2,F[m+3]=O=y*U>>Z,O>0?(O=255/O,F[m]=(f*U>>Z)*O,F[m+1]=(v*U>>Z)*O,F[m+2]=(b*U>>Z)*O):F[m]=F[m+1]=F[m+2]=0,f-=z,v-=S,b-=w,y-=x,z-=j.r,S-=j.g,w-=j.b,x-=j.a,m=c+((m=h+V)<D?m:D)*o<<2,f+=C+=j.r=F[m],v+=k+=j.g=F[m+1],b+=I+=j.b=F[m+2],y+=T+=j.a=F[m+3],j=j.next,z+=E=G.r,S+=M=G.g,w+=A=G.b,x+=O=G.a,C-=E,k-=M,I-=A,T-=O,G=G.next,g+=o}l.putImageData(r,t,i)}}function stackBlurCanvasRGB(e,t,i,o,a,n){if(!(isNaN(n)||1>n)){n|=0;var r,s=document.getElementById(e),l=s.getContext("2d");try{try{r=l.getImageData(t,i,o,a)}catch(d){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),r=l.getImageData(t,i,o,a)}catch(d){throw alert("Cannot access local image"),new Error("unable to access local image data: "+d)}}}catch(d){throw alert("Cannot access image"),new Error("unable to access image data: "+d)}var c,h,u,m,p,g,_,f,v,b,y,z,S,w,x,C,k,I,T,E,M=r.data,A=n+n+1,O=o-1,P=a-1,F=n+1,B=F*(F+1)/2,N=new BlurStack,D=N;for(u=1;A>u;u++)if(D=D.next=new BlurStack,u==F)var V=D;D.next=N;var L=null,H=null;_=g=0;var W=mul_table[n],R=shg_table[n];for(h=0;a>h;h++){for(w=x=C=f=v=b=0,y=F*(k=M[g]),z=F*(I=M[g+1]),S=F*(T=M[g+2]),f+=B*k,v+=B*I,b+=B*T,D=N,u=0;F>u;u++)D.r=k,D.g=I,D.b=T,D=D.next;for(u=1;F>u;u++)m=g+((u>O?O:u)<<2),f+=(D.r=k=M[m])*(E=F-u),v+=(D.g=I=M[m+1])*E,b+=(D.b=T=M[m+2])*E,w+=k,x+=I,C+=T,D=D.next;for(L=N,H=V,c=0;o>c;c++)M[g]=f*W>>R,M[g+1]=v*W>>R,M[g+2]=b*W>>R,f-=y,v-=z,b-=S,y-=L.r,z-=L.g,S-=L.b,m=_+((m=c+n+1)<O?m:O)<<2,w+=L.r=M[m],x+=L.g=M[m+1],C+=L.b=M[m+2],f+=w,v+=x,b+=C,L=L.next,y+=k=H.r,z+=I=H.g,S+=T=H.b,w-=k,x-=I,C-=T,H=H.next,g+=4;_+=o}for(c=0;o>c;c++){for(x=C=w=v=b=f=0,g=c<<2,y=F*(k=M[g]),z=F*(I=M[g+1]),S=F*(T=M[g+2]),f+=B*k,v+=B*I,b+=B*T,D=N,u=0;F>u;u++)D.r=k,D.g=I,D.b=T,D=D.next;for(p=o,u=1;n>=u;u++)g=p+c<<2,f+=(D.r=k=M[g])*(E=F-u),v+=(D.g=I=M[g+1])*E,b+=(D.b=T=M[g+2])*E,w+=k,x+=I,C+=T,D=D.next,P>u&&(p+=o);for(g=c,L=N,H=V,h=0;a>h;h++)m=g<<2,M[m]=f*W>>R,M[m+1]=v*W>>R,M[m+2]=b*W>>R,f-=y,v-=z,b-=S,y-=L.r,z-=L.g,S-=L.b,m=c+((m=h+F)<P?m:P)*o<<2,f+=w+=L.r=M[m],v+=x+=L.g=M[m+1],b+=C+=L.b=M[m+2],L=L.next,y+=k=H.r,z+=I=H.g,S+=T=H.b,w-=k,x-=I,C-=T,H=H.next,g+=o}l.putImageData(r,t,i)}}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function RGBColor(e){this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var i in t)e==i&&(e=t[i]);for(var o=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],a=0;a<o.length;a++){var n=o[a].re,r=o[a].process,s=n.exec(e);s&&(channels=r(s),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),i=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==i.length&&(i="0"+i),"#"+e+t+i},this.getHelpXML=function(){for(var e=new Array,i=0;i<o.length;i++)for(var a=o[i].example,n=0;n<a.length;n++)e[e.length]=a[n];for(var r in t)e[e.length]=r;var s=document.createElement("ul");s.setAttribute("id","rgbcolor-examples");for(var i=0;i<e.length;i++)try{var l=document.createElement("li"),d=new RGBColor(e[i]),c=document.createElement("div");c.style.cssText="margin: 3px; border: 1px solid black; background:"+d.toHex()+"; color:"+d.toHex(),c.appendChild(document.createTextNode("test"));var h=document.createTextNode(" "+e[i]+" -> "+d.toRGB()+" -> "+d.toHex());l.appendChild(c),l.appendChild(h),s.appendChild(l)}catch(u){}return s}}function ZAlertDialog(){}var FComponents=function(e){function t(e){return e&&(a=e.split("#")[1],a&&(a=a.split("=")[1],document.cookie=o.clientTokenName+"="+a+"; domain="+o.domain+"; path=/; secure")),a}function i(i){o.serviceName=i.serviceName,o.domain=i.domain;var a=o.clientTokenServiceURL;if("tokenpair.do"===a){var n=window.location;a=n.protocol+"//"+n.hostname+FComponents.option("contextPath")+a}var r=i.clientTokenReqURL+"client_auth=true&servicename="+i.serviceName+"&serviceurl="+a,s=e("<iframe>").attr({id:"zfc-iam-clienttoken",src:r,style:"display:none;"});s.appendTo("body"),s.load(function(){t(this.contentWindow.location.href)})}var o={csrfParamName:"fccsrf",csrfCookieName:"FC_CSRF_TOKEN",csrfRequestURL:void 0,contextPath:"fcomponents/",clientTokenIsEnabled:!1,clientTokenName:"x-uds-clitoken",clientTokenServiceParamName:"x-cli-service-name",serviceName:"ZohoWriter",clientTokenReqURL:"https://accounts.localzoho.com/login",clientTokenServiceURL:"tokenpair.do",service:"WR"},a=void 0;return{getClientToken:function(){return a},init:function(t){var a=window.location.hostname.split(".");a.length>2&&(a.reverse().pop(),a.reverse()),o.domain=a.join(".");var n=!1;void 0!==t.csrfRequestURL&&""!==t.csrfRequestURL&&FCUtil.ajaxUtil(t.csrfRequestURL,"GET"),!t.csrfInitRequest||void 0!==t.csrfParamName&&""!==t.csrfParamName||(n=!0,t.csrfParamName=o.csrfParamName,t.csrfCookieName=o.csrfCookieName),o=e.extend({},o,t);var r=o.clientToken;o.clientTokenIsEnabled!==!0||void 0!==r&&""!==r||FCUtil.ajaxUtil("getproperties.do","get","",{success:function(e){"success"===e.request&&i(e)}}),n&&FCUtil.ajaxUtil("html/blank.html","get","","")},option:function(e,t){return t?void(o[e]=t):o[e]}}}(jQuery),FCUtil=function(e){function t(e){for(var t=e+"=",i=document.cookie.split(";"),o=0;o<i.length;o++){var a=i[o].trim();if(0===a.indexOf(t))return a.substring(t.length,a.length)}return""}return{ajaxUtil:function(t,i,o,a,n,r){o=o||{},n=n||{},a=a||{},n.responseType=n.responseType?n.responseType:"application/json","post"===i.toLowerCase()&&(o[FComponents.option("csrfParamName")]=this.getCSRFToken()),t=r?t:FComponents.option("contextPath")+t,a.errorNotified=!1;var s=e.ajax({type:i,url:t,data:o,beforeSend:function(e){a.progress&&a.progress(e)},fail:function(e){a.fail&&!a.errorNotified&&(a.errorNotified=!0,a.fail(e))},error:function(e){a.fail&&!a.errorNotified&&(a.errorNotified=!0,a.fail(e))},success:function(t){if(a.success){var i=t;"object"!=typeof i&&"application/json"===n.responseType&&(i=e.parseJSON(t)),a.success(i)}}});return s},commonKeys:{insert:"Insert",close:"Close",cancel:"Cancel"},getString:function(e,t,i){return this.getI18NString("fcommon",e,i,t||this.commonKeys)},getI18NString:function(e,t,i,o){return i=i||[],ZComponents.getI18NText(e,t,o,i)},removeProgressDialog:function(){e("#zfc-progress-dialog").remove()},showProgressDialog:function(t,i,o){if(o===!0){var o=e("<div>").attr({id:"zfc-progress-dialog-overlay"}).appendTo("body");o.css({overflow:"scroll",position:"fixed",width:"100%",height:"100%","z-index":e.ui.dialog&&e.ui.dialog.zIndex?e.ui.dialog.zIndex:1e4,top:0,left:0});var a=e("<div>").attr({id:"zfc-progress-dialog"}).appendTo(o)}else var a=e("<div>").attr({id:"zfc-progress-dialog"}).appendTo("body");a.css({height:i.outerHeight(),width:i.outerWidth(),left:i.offset().left,top:i.offset().top});var n=e("<span>").attr({id:"zfc-dialog-loader","class":"ui-zfc-loader-circle"}).appendTo(a),r=e("<span>").attr({"class":"zfc-dialog-loader-msg"}).appendTo(a);r.text(t),a.animate({height:110,width:220,marginTop:100,marginLeft:i.outerWidth()/3},100,function(){var e=(a.outerWidth()-(n.outerWidth()+r.width()+4))/2,t=(a.outerHeight()-n.outerHeight()-2)/2;n.css({left:e,top:t}),r.css({left:e,top:t}),n.fadeIn(50),r.fadeIn(100)})},showError:function(t,i,o,a,n){t=""===t||void 0===t?FCUtil.getString("internalserver.label"):t;var r=i.find("#ui-fc-server-error");r.length||(r=e('<div id="ui-fc-server-error" class="ui-fc-server-error"><div class="zc-server-error"><span id="zc-server-error-close" title="'+FCUtil.getString("close","fcommon")+'" class="ui-zfc-icon ui-icon-closethick"></span><div class="zc-server-error-msg" id="zfc-server-error"></div> </div> </div>'),r[void 0!==n?n:"insertBefore"](o)),r.find("#zfc-server-error").text(t);var s={openDelay:200,closeDelay:200};if(a=e.extend({},s,a),r.slideDown(a.openDelay,function(){a.onOpen&&a.onOpen(r)}),a.autoCloseDelay){i.data("zfcAutoClose")&&clearTimeout(i.data("zfcAutoClose"));var l=setTimeout(function(){r.slideUp(a.closeDelay,function(){a.onAutoClose&&a.onAutoClose(r)})},a.autoCloseDelay);i.data("zfcAutoClose",l)}r.find("#zc-server-error-close").off("click").on("click",function(){a.beforeClose&&a.beforeClose(r),r.slideUp(a.closeDelay,function(){a.onClose&&a.onClose(r)})})},getCSRFToken:function(){return t(FComponents.option("csrfCookieName"))},getCSRFCookie:function(e){return t(e)}}}(jQuery),mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];!function(){function e(e){var t=[0,0,0],i=function(i,o){var a=e.match(i);null!=a&&(t[o]+=a.length,e=e.replace(i," "))};return e=e.replace(/:not\(([^\)]*)\)/g,"     $1 "),e=e.replace(/{[^]*/gm," "),i(a,1),i(n,0),i(r,1),i(s,2),i(l,1),i(d,1),e=e.replace(/[\*\s\+>~]/g," "),e=e.replace(/[#\.]/g," "),i(c,2),t.join("")}function t(t){var a={opts:t};a.FRAMERATE=30,a.MAX_VIRTUAL_PIXELS=3e4,a.log=function(){},1==a.opts.log&&"undefined"!=typeof console&&(a.log=function(e){console.log(e)}),a.init=function(e){var t=0;a.UniqueId=function(){return t++,"canvg"+t},a.Definitions={},a.Styles={},a.StylesSpecificity={},a.Animations=[],a.Images=[],a.ctx=e,a.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(e,t){this.viewPorts.push({width:e,height:t})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(e){return null!=e&&"number"==typeof e?e:"x"==e?this.width():"y"==e?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},a.init(),a.ImagesLoaded=function(){for(var e=0;e<a.Images.length;e++)if(!a.Images[e].loaded)return!1;return!0},a.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},a.compressSpaces=function(e){return e.replace(/[\s\r\t\n]+/gm," ")},a.ajax=function(e){var t;return t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t?(t.open("GET",e,!1),t.send(null),t.responseText):null},a.parseXml=function(e){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var t=new Windows.Data.Xml.Dom.XmlDocument,i=new Windows.Data.Xml.Dom.XmlLoadSettings;return i.prohibitDtd=!1,t.loadXml(e,i),t}if(window.DOMParser){var o=new DOMParser;return o.parseFromString(e,"text/xml")}e=e.replace(/<!DOCTYPE svg[^>]*>/,"");var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t},a.Property=function(e,t){this.name=e,this.value=t},a.Property.prototype.getValue=function(){return this.value},a.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},a.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var e=parseFloat(this.value);return(this.value+"").match(/%$/)&&(e/=100),e},a.Property.prototype.valueOrDefault=function(e){return this.hasValue()?this.value:e},a.Property.prototype.numValueOrDefault=function(e){return this.hasValue()?this.numValue():e},a.Property.prototype.addOpacity=function(e){var t=this.value;if(null!=e.value&&""!=e.value&&"string"==typeof this.value){var i=new RGBColor(this.value);i.ok&&(t="rgba("+i.r+", "+i.g+", "+i.b+", "+e.numValue()+")")}return new a.Property(this.name,t)},a.Property.prototype.getDefinition=function(){var e=this.value.match(/#([^\)'"]+)/);return e&&(e=e[1]),e||(e=this.value),a.Definitions[e]},a.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},a.Property.prototype.getFillStyleDefinition=function(e,t){var i=this.getDefinition();if(null!=i&&i.createGradient)return i.createGradient(a.ctx,e,t);if(null!=i&&i.createPattern){if(i.getHrefAttribute().hasValue()){var o=i.attribute("patternTransform");i=i.getHrefAttribute().getDefinition(),o.hasValue()&&(i.attribute("patternTransform",!0).value=o.value)}return i.createPattern(a.ctx,e)}return null},a.Property.prototype.getDPI=function(){return 96},a.Property.prototype.getEM=function(e){var t=12,i=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);return i.hasValue()&&(t=i.toPixels(e)),t},a.Property.prototype.getUnits=function(){var e=this.value+"";return e.replace(/[0-9\.\-]/g,"")},a.Property.prototype.toPixels=function(e,t){if(!this.hasValue())return 0;var i=this.value+"";if(i.match(/em$/))return this.numValue()*this.getEM(e);if(i.match(/ex$/))return this.numValue()*this.getEM(e)/2;if(i.match(/px$/))return this.numValue();if(i.match(/pt$/))return this.numValue()*this.getDPI(e)*(1/72);if(i.match(/pc$/))return 15*this.numValue();if(i.match(/cm$/))return this.numValue()*this.getDPI(e)/2.54;if(i.match(/mm$/))return this.numValue()*this.getDPI(e)/25.4;if(i.match(/in$/))return this.numValue()*this.getDPI(e);if(i.match(/%$/))return this.numValue()*a.ViewPort.ComputeSize(e);var o=this.numValue();return t&&1>o?o*a.ViewPort.ComputeSize(e):o},a.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/s$/)?1e3*this.numValue():(e.match(/ms$/),this.numValue())},a.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/deg$/)?this.numValue()*(Math.PI/180):e.match(/grad$/)?this.numValue()*(Math.PI/200):e.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var n={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return a.Property.prototype.toTextBaseline=function(){return this.hasValue()?n[this.value]:null},a.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(e,t,i,o,n,r){var s=null!=r?this.Parse(r):this.CreateFont("","","","","",a.ctx.font);return{fontFamily:n||s.fontFamily,fontSize:o||s.fontSize,fontStyle:e||s.fontStyle,fontWeight:i||s.fontWeight,fontVariant:t||s.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var e=this;this.Parse=function(t){for(var i={},o=a.trim(a.compressSpaces(t||"")).split(" "),n={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},r="",s=0;s<o.length;s++)n.fontStyle||-1==e.Styles.indexOf(o[s])?n.fontVariant||-1==e.Variants.indexOf(o[s])?n.fontWeight||-1==e.Weights.indexOf(o[s])?n.fontSize?"inherit"!=o[s]&&(r+=o[s]):("inherit"!=o[s]&&(i.fontSize=o[s].split("/")[0]),n.fontStyle=n.fontVariant=n.fontWeight=n.fontSize=!0):("inherit"!=o[s]&&(i.fontWeight=o[s]),n.fontStyle=n.fontVariant=n.fontWeight=!0):("inherit"!=o[s]&&(i.fontVariant=o[s]),n.fontStyle=n.fontVariant=!0):("inherit"!=o[s]&&(i.fontStyle=o[s]),n.fontStyle=!0);return""!=r&&(i.fontFamily=r),i}},a.ToNumberArray=function(e){for(var t=a.trim(a.compressSpaces((e||"").replace(/,/g," "))).split(" "),i=0;i<t.length;i++)t[i]=parseFloat(t[i]);return t},a.Point=function(e,t){this.x=e,this.y=t},a.Point.prototype.angleTo=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},a.Point.prototype.applyTransform=function(e){var t=this.x*e[0]+this.y*e[2]+e[4],i=this.x*e[1]+this.y*e[3]+e[5];this.x=t,this.y=i},a.CreatePoint=function(e){var t=a.ToNumberArray(e);return new a.Point(t[0],t[1])},a.CreatePath=function(e){for(var t=a.ToNumberArray(e),i=[],o=0;o<t.length;o+=2)i.push(new a.Point(t[o],t[o+1]));return i},a.BoundingBox=function(e,t,o,a){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(e,t){null!=e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),null!=t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},this.addX=function(e){this.addPoint(e,null)},this.addY=function(e){this.addPoint(null,e)},this.addBoundingBox=function(e){this.addPoint(e.x1,e.y1),this.addPoint(e.x2,e.y2)},this.addQuadraticCurve=function(e,t,i,o,a,n){var r=e+2/3*(i-e),s=t+2/3*(o-t),l=r+1/3*(a-e),d=s+1/3*(n-t);this.addBezierCurve(e,t,r,l,s,d,a,n)},this.addBezierCurve=function(e,t,o,a,n,r,s,l){var d=[e,t],c=[o,a],h=[n,r],u=[s,l];for(this.addPoint(d[0],d[1]),this.addPoint(u[0],u[1]),i=0;1>=i;i++){var m=function(e){return Math.pow(1-e,3)*d[i]+3*Math.pow(1-e,2)*e*c[i]+3*(1-e)*Math.pow(e,2)*h[i]+Math.pow(e,3)*u[i]},p=6*d[i]-12*c[i]+6*h[i],g=-3*d[i]+9*c[i]-9*h[i]+3*u[i],_=3*c[i]-3*d[i];if(0!=g){var f=Math.pow(p,2)-4*_*g;if(!(0>f)){var v=(-p+Math.sqrt(f))/(2*g);v>0&&1>v&&(0==i&&this.addX(m(v)),1==i&&this.addY(m(v)));var b=(-p-Math.sqrt(f))/(2*g);b>0&&1>b&&(0==i&&this.addX(m(b)),1==i&&this.addY(m(b)))}}else{if(0==p)continue;var y=-_/p;y>0&&1>y&&(0==i&&this.addX(m(y)),1==i&&this.addY(m(y)))}}},this.isPointInBox=function(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2},this.addPoint(e,t),this.addPoint(o,a)},a.Transform=function(e){var t=this;this.Type={},this.Type.translate=function(e){this.p=a.CreatePoint(e),this.apply=function(e){e.translate(this.p.x||0,this.p.y||0)},this.unapply=function(e){e.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(e){e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(e){var t=a.ToNumberArray(e);this.angle=new a.Property("angle",t[0]),this.cx=t[1]||0,this.cy=t[2]||0,this.apply=function(e){e.translate(this.cx,this.cy),e.rotate(this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.unapply=function(e){e.translate(this.cx,this.cy),e.rotate(-1*this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.applyToPoint=function(e){var t=this.angle.toRadians();e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),e.applyTransform([Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0]),e.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(e){this.p=a.CreatePoint(e),this.apply=function(e){e.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(e){e.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(e){e.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(e){this.m=a.ToNumberArray(e),this.apply=function(e){e.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(e){var t=this.m[0],i=this.m[2],o=this.m[4],a=this.m[1],n=this.m[3],r=this.m[5],s=0,l=0,d=1,c=1/(t*(n*d-r*l)-i*(a*d-r*s)+o*(a*l-n*s));e.transform(c*(n*d-r*l),c*(r*s-a*d),c*(o*l-i*d),c*(t*d-o*s),c*(i*r-o*n),c*(o*a-t*r))},this.applyToPoint=function(e){e.applyTransform(this.m)}},this.Type.SkewBase=function(e){this.base=t.Type.matrix,this.base(e),this.angle=new a.Property("angle",e)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(e){this.base=t.Type.SkewBase,this.base(e),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(e){this.base=t.Type.SkewBase,this.base(e),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(e)},this.unapply=function(e){for(var t=this.transforms.length-1;t>=0;t--)this.transforms[t].unapply(e)},this.applyToPoint=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].applyToPoint(e)};for(var i=a.trim(a.compressSpaces(e)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),o=0;o<i.length;o++){var n=a.trim(i[o].split("(")[0]),r=i[o].split("(")[1].replace(")",""),s=new this.Type[n](r);s.type=n,this.transforms.push(s)}},a.AspectRatio=function(e,t,i,o,n,r,s,l,d,c){t=a.compressSpaces(t),t=t.replace(/^defer\s/,"");var h=t.split(" ")[0]||"xMidYMid",u=t.split(" ")[1]||"meet",m=i/o,p=n/r,g=Math.min(m,p),_=Math.max(m,p);"meet"==u&&(o*=g,r*=g),"slice"==u&&(o*=_,r*=_),d=new a.Property("refX",d),c=new a.Property("refY",c),d.hasValue()&&c.hasValue()?e.translate(-g*d.toPixels("x"),-g*c.toPixels("y")):(h.match(/^xMid/)&&("meet"==u&&g==p||"slice"==u&&_==p)&&e.translate(i/2-o/2,0),h.match(/YMid$/)&&("meet"==u&&g==m||"slice"==u&&_==m)&&e.translate(0,n/2-r/2),h.match(/^xMax/)&&("meet"==u&&g==p||"slice"==u&&_==p)&&e.translate(i-o,0),h.match(/YMax$/)&&("meet"==u&&g==m||"slice"==u&&_==m)&&e.translate(0,n-r)),"none"==h?e.scale(m,p):"meet"==u?e.scale(g,g):"slice"==u&&e.scale(_,_),e.translate(null==s?0:-s,null==l?0:-l)},a.Element={},a.EmptyProperty=new a.Property("EMPTY",""),a.Element.ElementBase=function(e){if(this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(e,t){var i=this.attributes[e];return null!=i?i:(1==t&&(i=new a.Property(e,""),this.attributes[e]=i),i||a.EmptyProperty)},this.getHrefAttribute=function(){for(var e in this.attributes)if("href"==e||e.match(/:href$/))return this.attributes[e];return a.EmptyProperty},this.style=function(e,t,i){var o=this.styles[e];if(null!=o)return o;var n=this.attribute(e);if(null!=n&&n.hasValue())return this.styles[e]=n,n;if(1!=i){var r=this.parent;if(null!=r){var s=r.style(e);if(null!=s&&s.hasValue())return s}}return 1==t&&(o=new a.Property(e,""),this.styles[e]=o),o||a.EmptyProperty},this.render=function(e){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(e.save(),this.attribute("mask").hasValue()){var t=this.attribute("mask").getDefinition();null!=t&&t.apply(e,this)}else if(this.style("filter").hasValue()){var i=this.style("filter").getDefinition();null!=i&&i.apply(e,this)}else this.setContext(e),this.renderChildren(e),this.clearContext(e);e.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(e){for(var t=0;t<this.children.length;t++)this.children[t].render(e)},this.addChild=function(e,t){var i=e;t&&(i=a.CreateElement(e)),i.parent=this,"title"!=i.type&&this.children.push(i)},this.addStylesFromStyleDefinition=function(){for(var t in a.Styles)if("@"!=t[0]&&o(e,t)){var i=a.Styles[t],n=a.StylesSpecificity[t];if(null!=i)for(var r in i){var s=this.stylesSpecificity[r];"undefined"==typeof s&&(s="000"),n>s&&(this.styles[r]=i[r],this.stylesSpecificity[r]=n)}}},null!=e&&1==e.nodeType){for(var t=0;t<e.attributes.length;t++){var i=e.attributes[t];this.attributes[i.nodeName]=new a.Property(i.nodeName,i.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue())for(var n=this.attribute("style").value.split(";"),t=0;t<n.length;t++)if(""!=a.trim(n[t])){var r=n[t].split(":"),s=a.trim(r[0]),l=a.trim(r[1]);this.styles[s]=new a.Property(s,l)}this.attribute("id").hasValue()&&null==a.Definitions[this.attribute("id").value]&&(a.Definitions[this.attribute("id").value]=this);for(var t=0;t<e.childNodes.length;t++){var d=e.childNodes[t];if(1==d.nodeType&&this.addChild(d,!0),this.captureTextNodes&&(3==d.nodeType||4==d.nodeType)){var c=d.value||d.text||d.textContent||"";""!=a.compressSpaces(c)&&this.addChild(new a.Element.tspan(d),!1)}}}},a.Element.RenderedElementBase=function(e){this.base=a.Element.ElementBase,this.base(e),this.setContext=function(e){if(this.style("fill").isUrlDefinition()){var t=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=t&&(e.fillStyle=t)}else if(this.style("fill").hasValue()){var i=this.style("fill");"currentColor"==i.value&&(i.value=this.style("color").value),"inherit"!=i.value&&(e.fillStyle="none"==i.value?"rgba(0,0,0,0)":i.value)}if(this.style("fill-opacity").hasValue()){var i=new a.Property("fill",e.fillStyle);i=i.addOpacity(this.style("fill-opacity")),e.fillStyle=i.value}if(this.style("stroke").isUrlDefinition()){var t=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=t&&(e.strokeStyle=t)}else if(this.style("stroke").hasValue()){var o=this.style("stroke");"currentColor"==o.value&&(o.value=this.style("color").value),"inherit"!=o.value&&(e.strokeStyle="none"==o.value?"rgba(0,0,0,0)":o.value)}if(this.style("stroke-opacity").hasValue()){var o=new a.Property("stroke",e.strokeStyle);o=o.addOpacity(this.style("stroke-opacity")),e.strokeStyle=o.value}if(this.style("stroke-width").hasValue()){var n=this.style("stroke-width").toPixels();e.lineWidth=0==n?.001:n}if(this.style("stroke-linecap").hasValue()&&(e.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(e.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(e.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var r=a.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof e.setLineDash?e.setLineDash(r):"undefined"!=typeof e.webkitLineDash?e.webkitLineDash=r:"undefined"==typeof e.mozDash||1==r.length&&0==r[0]||(e.mozDash=r);var s=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof e.lineDashOffset?e.lineDashOffset=s:"undefined"!=typeof e.webkitLineDashOffset?e.webkitLineDashOffset=s:"undefined"!=typeof e.mozDashOffset&&(e.mozDashOffset=s)}if("undefined"!=typeof e.font&&(e.font=a.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.style("transform",!1,!0).hasValue()){var l=new a.Transform(this.style("transform",!1,!0).value);l.apply(e)}if(this.attribute("clip-path",!1,!0).hasValue()){var d=this.attribute("clip-path",!1,!0).getDefinition();null!=d&&d.apply(e)}this.style("opacity").hasValue()&&(e.globalAlpha=this.style("opacity").numValue())}},a.Element.RenderedElementBase.prototype=new a.Element.ElementBase,a.Element.PathElementBase=function(e){this.base=a.Element.RenderedElementBase,this.base(e),this.path=function(e){return null!=e&&e.beginPath(),new a.BoundingBox},this.renderChildren=function(e){this.path(e),a.Mouse.checkPath(this,e),""!=e.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?e.fill(this.style("fill-rule").value):e.fill()),""!=e.strokeStyle&&e.stroke();var t=this.getMarkers();if(null!=t){if(this.style("marker-start").isUrlDefinition()){var i=this.style("marker-start").getDefinition();null!=i&&i.render(e,t[0][0],t[0][1])}if(this.style("marker-mid").isUrlDefinition()){var i=this.style("marker-mid").getDefinition();if(null!=i)for(var o=1;o<t.length-1;o++)i.render(e,t[o][0],t[o][1])}if(this.style("marker-end").isUrlDefinition()){var i=this.style("marker-end").getDefinition();null!=i&&i.render(e,t[t.length-1][0],t[t.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},a.Element.PathElementBase.prototype=new a.Element.RenderedElementBase,a.Element.svg=function(e){this.base=a.Element.RenderedElementBase,this.base(e),this.baseClearContext=this.clearContext,this.clearContext=function(e){this.baseClearContext(e),a.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(e){e.strokeStyle="rgba(0,0,0,0)",e.lineCap="butt",e.lineJoin="miter",e.miterLimit=4,"undefined"!=typeof e.font&&"undefined"!=typeof window.getComputedStyle&&(e.font=window.getComputedStyle(e.canvas).getPropertyValue("font")),this.baseSetContext(e),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),e.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var t=a.ViewPort.width(),i=a.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){t=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");var o=0,n=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(o=-this.attribute("refX").toPixels("x"),n=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(e.beginPath(),e.moveTo(o,n),e.lineTo(t,n),e.lineTo(t,i),e.lineTo(o,i),e.closePath(),e.clip())}if(a.ViewPort.SetCurrent(t,i),this.attribute("viewBox").hasValue()){var r=a.ToNumberArray(this.attribute("viewBox").value),s=r[0],l=r[1];t=r[2],i=r[3],a.AspectRatio(e,this.attribute("preserveAspectRatio").value,a.ViewPort.width(),t,a.ViewPort.height(),i,s,l,this.attribute("refX").value,this.attribute("refY").value),a.ViewPort.RemoveCurrent(),a.ViewPort.SetCurrent(r[2],r[3])}}},a.Element.svg.prototype=new a.Element.RenderedElementBase,a.Element.rect=function(e){this.base=a.Element.PathElementBase,this.base(e),this.path=function(e){var t=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),o=this.attribute("width").toPixels("x"),n=this.attribute("height").toPixels("y"),r=this.attribute("rx").toPixels("x"),s=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(s=r),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(r=s),r=Math.min(r,o/2),s=Math.min(s,n/2),null!=e&&(e.beginPath(),e.moveTo(t+r,i),e.lineTo(t+o-r,i),e.quadraticCurveTo(t+o,i,t+o,i+s),e.lineTo(t+o,i+n-s),e.quadraticCurveTo(t+o,i+n,t+o-r,i+n),e.lineTo(t+r,i+n),e.quadraticCurveTo(t,i+n,t,i+n-s),e.lineTo(t,i+s),e.quadraticCurveTo(t,i,t+r,i),e.closePath()),new a.BoundingBox(t,i,t+o,i+n)}},a.Element.rect.prototype=new a.Element.PathElementBase,a.Element.circle=function(e){this.base=a.Element.PathElementBase,this.base(e),this.path=function(e){var t=this.attribute("cx").toPixels("x"),i=this.attribute("cy").toPixels("y"),o=this.attribute("r").toPixels();return null!=e&&(e.beginPath(),e.arc(t,i,o,0,2*Math.PI,!0),e.closePath()),new a.BoundingBox(t-o,i-o,t+o,i+o)}},a.Element.circle.prototype=new a.Element.PathElementBase,a.Element.ellipse=function(e){this.base=a.Element.PathElementBase,this.base(e),this.path=function(e){var t=4*((Math.sqrt(2)-1)/3),i=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y"),n=this.attribute("cx").toPixels("x"),r=this.attribute("cy").toPixels("y");return null!=e&&(e.beginPath(),e.moveTo(n,r-o),e.bezierCurveTo(n+t*i,r-o,n+i,r-t*o,n+i,r),e.bezierCurveTo(n+i,r+t*o,n+t*i,r+o,n,r+o),e.bezierCurveTo(n-t*i,r+o,n-i,r+t*o,n-i,r),e.bezierCurveTo(n-i,r-t*o,n-t*i,r-o,n,r-o),e.closePath()),new a.BoundingBox(n-i,r-o,n+i,r+o)}},a.Element.ellipse.prototype=new a.Element.PathElementBase,a.Element.line=function(e){this.base=a.Element.PathElementBase,this.base(e),this.getPoints=function(){return[new a.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new a.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(e){var t=this.getPoints();return null!=e&&(e.beginPath(),e.moveTo(t[0].x,t[0].y),e.lineTo(t[1].x,t[1].y)),new a.BoundingBox(t[0].x,t[0].y,t[1].x,t[1].y)},this.getMarkers=function(){var e=this.getPoints(),t=e[0].angleTo(e[1]);return[[e[0],t],[e[1],t]]}},a.Element.line.prototype=new a.Element.PathElementBase,a.Element.polyline=function(e){this.base=a.Element.PathElementBase,this.base(e),this.points=a.CreatePath(this.attribute("points").value),this.path=function(e){var t=new a.BoundingBox(this.points[0].x,this.points[0].y);null!=e&&(e.beginPath(),e.moveTo(this.points[0].x,this.points[0].y));for(var i=1;i<this.points.length;i++)t.addPoint(this.points[i].x,this.points[i].y),null!=e&&e.lineTo(this.points[i].x,this.points[i].y);return t},this.getMarkers=function(){for(var e=[],t=0;t<this.points.length-1;t++)e.push([this.points[t],this.points[t].angleTo(this.points[t+1])]);return e.push([this.points[this.points.length-1],e[e.length-1][1]]),e}},a.Element.polyline.prototype=new a.Element.PathElementBase,a.Element.polygon=function(e){this.base=a.Element.polyline,this.base(e),this.basePath=this.path,this.path=function(e){var t=this.basePath(e);return null!=e&&(e.lineTo(this.points[0].x,this.points[0].y),e.closePath()),t}},a.Element.polygon.prototype=new a.Element.polyline,a.Element.path=function(e){this.base=a.Element.PathElementBase,this.base(e);var t=this.attribute("d").value;t=t.replace(/,/gm," ");for(var i=0;2>i;i++)t=t.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");t=t.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),t=t.replace(/([0-9])([+\-])/gm,"$1 $2");for(var i=0;2>i;i++)t=t.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");t=t.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),t=a.compressSpaces(t),t=a.trim(t),this.PathParser=new function(e){this.tokens=e.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new a.Point(0,0),this.control=new a.Point(0,0),this.current=new a.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var e=new a.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(e)},this.getAsControlPoint=function(){var e=this.getPoint();return this.control=e,e},this.getAsCurrentPoint=function(){var e=this.getPoint();return this.current=e,e},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var e=new a.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return e},this.makeAbsolute=function(e){return this.isRelativeCommand()&&(e.x+=this.current.x,e.y+=this.current.y),e},this.addMarker=function(e,t,i){null!=i&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(i)),this.addMarkerAngle(e,null==t?null:t.angleTo(e))},this.addMarkerAngle=function(e,t){this.points.push(e),this.angles.push(t)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var e=0;e<this.angles.length;e++)if(null==this.angles[e])for(var t=e+1;t<this.angles.length;t++)if(null!=this.angles[t]){this.angles[e]=this.angles[t];break}return this.angles}}(t),this.path=function(e){var t=this.PathParser;t.reset();var i=new a.BoundingBox;for(null!=e&&e.beginPath();!t.isEnd();)switch(t.nextCommand(),t.command){case"M":case"m":var o=t.getAsCurrentPoint();for(t.addMarker(o),i.addPoint(o.x,o.y),null!=e&&e.moveTo(o.x,o.y),t.start=t.current;!t.isCommandOrEnd();){var o=t.getAsCurrentPoint();t.addMarker(o,t.start),i.addPoint(o.x,o.y),null!=e&&e.lineTo(o.x,o.y)}break;case"L":case"l":for(;!t.isCommandOrEnd();){var n=t.current,o=t.getAsCurrentPoint();t.addMarker(o,n),i.addPoint(o.x,o.y),null!=e&&e.lineTo(o.x,o.y)}break;case"H":case"h":for(;!t.isCommandOrEnd();){var r=new a.Point((t.isRelativeCommand()?t.current.x:0)+t.getScalar(),t.current.y);t.addMarker(r,t.current),t.current=r,i.addPoint(t.current.x,t.current.y),null!=e&&e.lineTo(t.current.x,t.current.y)}break;case"V":case"v":for(;!t.isCommandOrEnd();){var r=new a.Point(t.current.x,(t.isRelativeCommand()?t.current.y:0)+t.getScalar());t.addMarker(r,t.current),t.current=r,i.addPoint(t.current.x,t.current.y),null!=e&&e.lineTo(t.current.x,t.current.y)}break;case"C":case"c":for(;!t.isCommandOrEnd();){var s=t.current,l=t.getPoint(),d=t.getAsControlPoint(),c=t.getAsCurrentPoint();t.addMarker(c,d,l),i.addBezierCurve(s.x,s.y,l.x,l.y,d.x,d.y,c.x,c.y),null!=e&&e.bezierCurveTo(l.x,l.y,d.x,d.y,c.x,c.y)}break;case"S":case"s":for(;!t.isCommandOrEnd();){var s=t.current,l=t.getReflectedControlPoint(),d=t.getAsControlPoint(),c=t.getAsCurrentPoint();t.addMarker(c,d,l),i.addBezierCurve(s.x,s.y,l.x,l.y,d.x,d.y,c.x,c.y),null!=e&&e.bezierCurveTo(l.x,l.y,d.x,d.y,c.x,c.y)}break;case"Q":case"q":for(;!t.isCommandOrEnd();){var s=t.current,d=t.getAsControlPoint(),c=t.getAsCurrentPoint();t.addMarker(c,d,d),i.addQuadraticCurve(s.x,s.y,d.x,d.y,c.x,c.y),null!=e&&e.quadraticCurveTo(d.x,d.y,c.x,c.y)}break;case"T":case"t":for(;!t.isCommandOrEnd();){var s=t.current,d=t.getReflectedControlPoint();t.control=d;var c=t.getAsCurrentPoint();t.addMarker(c,d,d),i.addQuadraticCurve(s.x,s.y,d.x,d.y,c.x,c.y),null!=e&&e.quadraticCurveTo(d.x,d.y,c.x,c.y)}break;case"A":case"a":for(;!t.isCommandOrEnd();){var s=t.current,h=t.getScalar(),u=t.getScalar(),m=t.getScalar()*(Math.PI/180),p=t.getScalar(),g=t.getScalar(),c=t.getAsCurrentPoint(),_=new a.Point(Math.cos(m)*(s.x-c.x)/2+Math.sin(m)*(s.y-c.y)/2,-Math.sin(m)*(s.x-c.x)/2+Math.cos(m)*(s.y-c.y)/2),f=Math.pow(_.x,2)/Math.pow(h,2)+Math.pow(_.y,2)/Math.pow(u,2);f>1&&(h*=Math.sqrt(f),u*=Math.sqrt(f));var v=(p==g?-1:1)*Math.sqrt((Math.pow(h,2)*Math.pow(u,2)-Math.pow(h,2)*Math.pow(_.y,2)-Math.pow(u,2)*Math.pow(_.x,2))/(Math.pow(h,2)*Math.pow(_.y,2)+Math.pow(u,2)*Math.pow(_.x,2)));isNaN(v)&&(v=0);var b=new a.Point(v*h*_.y/u,v*-u*_.x/h),y=new a.Point((s.x+c.x)/2+Math.cos(m)*b.x-Math.sin(m)*b.y,(s.y+c.y)/2+Math.sin(m)*b.x+Math.cos(m)*b.y),z=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},S=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(z(e)*z(t))},w=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(S(e,t))},x=w([1,0],[(_.x-b.x)/h,(_.y-b.y)/u]),C=[(_.x-b.x)/h,(_.y-b.y)/u],k=[(-_.x-b.x)/h,(-_.y-b.y)/u],I=w(C,k);S(C,k)<=-1&&(I=Math.PI),S(C,k)>=1&&(I=0);var T=1-g?1:-1,E=x+T*(I/2),M=new a.Point(y.x+h*Math.cos(E),y.y+u*Math.sin(E));if(t.addMarkerAngle(M,E-T*Math.PI/2),t.addMarkerAngle(c,E-T*Math.PI),i.addPoint(c.x,c.y),null!=e){var S=h>u?h:u,A=h>u?1:h/u,O=h>u?u/h:1;e.translate(y.x,y.y),e.rotate(m),e.scale(A,O),e.arc(0,0,S,x,x+I,1-g),e.scale(1/A,1/O),e.rotate(-m),e.translate(-y.x,-y.y)}}break;case"Z":case"z":null!=e&&e.closePath(),t.current=t.start}return i},this.getMarkers=function(){for(var e=this.PathParser.getMarkerPoints(),t=this.PathParser.getMarkerAngles(),i=[],o=0;o<e.length;o++)i.push([e[o],t[o]]);return i}},a.Element.path.prototype=new a.Element.PathElementBase,a.Element.pattern=function(e){this.base=a.Element.ElementBase,this.base(e),this.createPattern=function(e){var t=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),o=new a.Element.svg;o.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),o.attributes.width=new a.Property("width",t+"px"),o.attributes.height=new a.Property("height",i+"px"),o.attributes.transform=new a.Property("transform",this.attribute("patternTransform").value),o.children=this.children;var n=document.createElement("canvas");n.width=t,n.height=i;var r=n.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&r.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var s=-1;1>=s;s++)for(var l=-1;1>=l;l++)r.save(),o.attributes.x=new a.Property("x",s*n.width),o.attributes.y=new a.Property("y",l*n.height),o.render(r),r.restore();var d=e.createPattern(n,"repeat");return d}},a.Element.pattern.prototype=new a.Element.ElementBase,a.Element.marker=function(e){this.base=a.Element.ElementBase,this.base(e),this.baseRender=this.render,this.render=function(e,t,i){e.translate(t.x,t.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&e.rotate(i),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&e.scale(e.lineWidth,e.lineWidth),e.save();var o=new a.Element.svg;o.attributes.viewBox=new a.Property("viewBox",this.attribute("viewBox").value),o.attributes.refX=new a.Property("refX",this.attribute("refX").value),o.attributes.refY=new a.Property("refY",this.attribute("refY").value),o.attributes.width=new a.Property("width",this.attribute("markerWidth").value),o.attributes.height=new a.Property("height",this.attribute("markerHeight").value),o.attributes.fill=new a.Property("fill",this.attribute("fill").valueOrDefault("black")),o.attributes.stroke=new a.Property("stroke",this.attribute("stroke").valueOrDefault("none")),o.children=this.children,o.render(e),e.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&e.scale(1/e.lineWidth,1/e.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&e.rotate(-i),e.translate(-t.x,-t.y)}},a.Element.marker.prototype=new a.Element.ElementBase,a.Element.defs=function(e){this.base=a.Element.ElementBase,this.base(e),this.render=function(){}},a.Element.defs.prototype=new a.Element.ElementBase,a.Element.GradientBase=function(e){this.base=a.Element.ElementBase,this.base(e),this.stops=[];for(var t=0;t<this.children.length;t++){var i=this.children[t];"stop"==i.type&&this.stops.push(i)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits"],this.inheritStopContainer=function(e){for(var t=0;t<this.attributesToInherit.length;t++){var i=this.attributesToInherit[t];!this.attribute(i).hasValue()&&e.attribute(i).hasValue()&&(this.attribute(i,!0).value=e.attribute(i).value)}},this.createGradient=function(e,t,i){var o=this;this.getHrefAttribute().hasValue()&&(o=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(o));var n=function(e){if(i.hasValue()){var t=new a.Property("color",e);return t.addOpacity(i).value}return e},r=this.getGradient(e,t);if(null==r)return n(o.stops[o.stops.length-1].color);for(var s=0;s<o.stops.length;s++)r.addColorStop(o.stops[s].offset,n(o.stops[s].color));if(this.attribute("gradientTransform").hasValue()){var l=a.ViewPort.viewPorts[0],d=new a.Element.rect;d.attributes.x=new a.Property("x",-a.MAX_VIRTUAL_PIXELS/3),d.attributes.y=new a.Property("y",-a.MAX_VIRTUAL_PIXELS/3),d.attributes.width=new a.Property("width",a.MAX_VIRTUAL_PIXELS),d.attributes.height=new a.Property("height",a.MAX_VIRTUAL_PIXELS);var c=new a.Element.g;c.attributes.transform=new a.Property("transform",this.attribute("gradientTransform").value),c.children=[d];var h=new a.Element.svg;h.attributes.x=new a.Property("x",0),h.attributes.y=new a.Property("y",0),h.attributes.width=new a.Property("width",l.width),h.attributes.height=new a.Property("height",l.height),h.children=[c];var u=document.createElement("canvas");u.width=l.width,u.height=l.height;var m=u.getContext("2d");return m.fillStyle=r,h.render(m),m.createPattern(u,"no-repeat")}return r}},a.Element.GradientBase.prototype=new a.Element.ElementBase,a.Element.linearGradient=function(e){this.base=a.Element.GradientBase,this.base(e),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(e,t){var i="objectBoundingBox"==this.gradientUnits()?t.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var o="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),a="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),n="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),r="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return o==n&&a==r?null:e.createLinearGradient(o,a,n,r)}},a.Element.linearGradient.prototype=new a.Element.GradientBase,a.Element.radialGradient=function(e){this.base=a.Element.GradientBase,this.base(e),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(e,t){var i=t.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var o="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),a="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),n=o,r=a;this.attribute("fx").hasValue()&&(n="objectBoundingBox"==this.gradientUnits()?i.x()+i.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(r="objectBoundingBox"==this.gradientUnits()?i.y()+i.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var s="objectBoundingBox"==this.gradientUnits()?(i.width()+i.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return e.createRadialGradient(n,r,0,o,a,s)}},a.Element.radialGradient.prototype=new a.Element.GradientBase,a.Element.stop=function(e){this.base=a.Element.ElementBase,this.base(e),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var t=this.style("stop-color",!0);""===t.value&&(t.value="#000"),this.style("stop-opacity").hasValue()&&(t=t.addOpacity(this.style("stop-opacity"))),this.color=t.value},a.Element.stop.prototype=new a.Element.ElementBase,a.Element.AnimateBase=function(e){this.base=a.Element.ElementBase,this.base(e),a.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var e=this.attribute("attributeType").value,t=this.attribute("attributeName").value;return"CSS"==e?this.parent.style(t,!0):this.parent.attribute(t,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(e){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+e;var t=!1;if(this.begin<this.duration){var i=this.calcValue();if(this.attribute("type").hasValue()){var o=this.attribute("type").value;i=o+"("+i+")"}this.getProperty().value=i,t=!0}return t},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var e={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var t=e.progress*(this.values.value.length-1),i=Math.floor(t),o=Math.ceil(t);e.from=new a.Property("from",parseFloat(this.values.value[i])),e.to=new a.Property("to",parseFloat(this.values.value[o])),e.progress=(t-i)/(o-i)}else e.from=this.from,e.to=this.to;return e}},a.Element.AnimateBase.prototype=new a.Element.ElementBase,a.Element.animate=function(e){this.base=a.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),t=e.from.numValue()+(e.to.numValue()-e.from.numValue())*e.progress;return t+this.initialUnits}},a.Element.animate.prototype=new a.Element.AnimateBase,a.Element.animateColor=function(e){this.base=a.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),t=new RGBColor(e.from.value),i=new RGBColor(e.to.value);if(t.ok&&i.ok){var o=t.r+(i.r-t.r)*e.progress,a=t.g+(i.g-t.g)*e.progress,n=t.b+(i.b-t.b)*e.progress;return"rgb("+parseInt(o,10)+","+parseInt(a,10)+","+parseInt(n,10)+")"}return this.attribute("from").value}},a.Element.animateColor.prototype=new a.Element.AnimateBase,a.Element.animateTransform=function(e){this.base=a.Element.AnimateBase,this.base(e),this.calcValue=function(){for(var e=this.progress(),t=a.ToNumberArray(e.from.value),i=a.ToNumberArray(e.to.value),o="",n=0;n<t.length;n++)o+=t[n]+(i[n]-t[n])*e.progress+" ";return o}},a.Element.animateTransform.prototype=new a.Element.animate,a.Element.font=function(e){this.base=a.Element.ElementBase,this.base(e),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var t=0;t<this.children.length;t++){var i=this.children[t];"font-face"==i.type?(this.fontFace=i,i.style("font-family").hasValue()&&(a.Definitions[i.style("font-family").value]=this)):"missing-glyph"==i.type?this.missingGlyph=i:"glyph"==i.type&&(""!=i.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[i.unicode]&&(this.glyphs[i.unicode]=[]),this.glyphs[i.unicode][i.arabicForm]=i):this.glyphs[i.unicode]=i)}},a.Element.font.prototype=new a.Element.ElementBase,a.Element.fontface=function(e){this.base=a.Element.ElementBase,this.base(e),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},a.Element.fontface.prototype=new a.Element.ElementBase,a.Element.missingglyph=function(e){this.base=a.Element.path,this.base(e),this.horizAdvX=0},a.Element.missingglyph.prototype=new a.Element.path,a.Element.glyph=function(e){this.base=a.Element.path,this.base(e),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},a.Element.glyph.prototype=new a.Element.path,a.Element.text=function(e){this.captureTextNodes=!0,this.base=a.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e);var t=this.style("dominant-baseline").toTextBaseline();null==t&&(t=this.style("alignment-baseline").toTextBaseline()),null!=t&&(e.textBaseline=t)},this.getBoundingBox=function(){var e=this.attribute("x").toPixels("x"),t=this.attribute("y").toPixels("y"),i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize);return new a.BoundingBox(e,t-i,e+Math.floor(2*i/3)*this.children[0].getText().length,t)},this.renderChildren=function(e){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(e,this,0);for(var t=0;t<this.children.length;t++)this.renderChild(e,this,t)},this.getAnchorDelta=function(e,t,i){var o=this.style("text-anchor").valueOrDefault("start");if("start"!=o){for(var a=0,n=i;n<t.children.length;n++){var r=t.children[n];if(n>i&&r.attribute("x").hasValue())break;a+=r.measureTextRecursive(e)}return-1*("end"==o?a:a/2)}return 0},this.renderChild=function(e,t,i){var o=t.children[i];o.attribute("x").hasValue()?(o.x=o.attribute("x").toPixels("x")+t.getAnchorDelta(e,t,i),o.attribute("dx").hasValue()&&(o.x+=o.attribute("dx").toPixels("x"))):(o.attribute("dx").hasValue()&&(t.x+=o.attribute("dx").toPixels("x")),o.x=t.x),t.x=o.x+o.measureText(e),o.attribute("y").hasValue()?(o.y=o.attribute("y").toPixels("y"),o.attribute("dy").hasValue()&&(o.y+=o.attribute("dy").toPixels("y"))):(o.attribute("dy").hasValue()&&(t.y+=o.attribute("dy").toPixels("y")),o.y=t.y),t.y=o.y,o.render(e);for(var i=0;i<o.children.length;i++)t.renderChild(e,o,i)}},a.Element.text.prototype=new a.Element.RenderedElementBase,a.Element.TextElementBase=function(e){this.base=a.Element.RenderedElementBase,this.base(e),this.getGlyph=function(e,t,i){var o=t[i],a=null;if(e.isArabic){var n="isolated";(0==i||" "==t[i-1])&&i<t.length-2&&" "!=t[i+1]&&(n="terminal"),i>0&&" "!=t[i-1]&&i<t.length-2&&" "!=t[i+1]&&(n="medial"),i>0&&" "!=t[i-1]&&(i==t.length-1||" "==t[i+1])&&(n="initial"),"undefined"!=typeof e.glyphs[o]&&(a=e.glyphs[o][n],null==a&&"glyph"==e.glyphs[o].type&&(a=e.glyphs[o]))}else a=e.glyphs[o];return null==a&&(a=e.missingGlyph),a},this.renderChildren=function(e){var t=this.parent.style("font-family").getDefinition();if(null==t)""!=e.fillStyle&&e.fillText(a.compressSpaces(this.getText()),this.x,this.y),""!=e.strokeStyle&&e.strokeText(a.compressSpaces(this.getText()),this.x,this.y);else{var i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),o=this.parent.style("font-style").valueOrDefault(a.Font.Parse(a.ctx.font).fontStyle),n=this.getText();t.isRTL&&(n=n.split("").reverse().join(""));for(var r=a.ToNumberArray(this.parent.attribute("dx").value),s=0;s<n.length;s++){var l=this.getGlyph(t,n,s),d=i/t.fontFace.unitsPerEm;e.translate(this.x,this.y),e.scale(d,-d);var c=e.lineWidth;e.lineWidth=e.lineWidth*t.fontFace.unitsPerEm/i,"italic"==o&&e.transform(1,0,.4,1,0,0),l.render(e),"italic"==o&&e.transform(1,0,-.4,1,0,0),e.lineWidth=c,e.scale(1/d,-1/d),e.translate(-this.x,-this.y),this.x+=i*(l.horizAdvX||t.horizAdvX)/t.fontFace.unitsPerEm,"undefined"==typeof r[s]||isNaN(r[s])||(this.x+=r[s])}}},this.getText=function(){},this.measureTextRecursive=function(e){for(var t=this.measureText(e),i=0;i<this.children.length;i++)t+=this.children[i].measureTextRecursive(e);return t},this.measureText=function(e){var t=this.parent.style("font-family").getDefinition();if(null!=t){var i=this.parent.style("font-size").numValueOrDefault(a.Font.Parse(a.ctx.font).fontSize),o=0,n=this.getText();t.isRTL&&(n=n.split("").reverse().join(""));for(var r=a.ToNumberArray(this.parent.attribute("dx").value),s=0;s<n.length;s++){var l=this.getGlyph(t,n,s);o+=(l.horizAdvX||t.horizAdvX)*i/t.fontFace.unitsPerEm,"undefined"==typeof r[s]||isNaN(r[s])||(o+=r[s])}return o}var d=a.compressSpaces(this.getText());if(!e.measureText)return 10*d.length;e.save(),this.setContext(e);var c=e.measureText(d).width;return e.restore(),c}},a.Element.TextElementBase.prototype=new a.Element.RenderedElementBase,a.Element.tspan=function(e){this.captureTextNodes=!0,this.base=a.Element.TextElementBase,this.base(e),this.text=a.compressSpaces(e.value||e.text||e.textContent||""),this.getText=function(){return this.children.length>0?"":this.text}},a.Element.tspan.prototype=new a.Element.TextElementBase,a.Element.tref=function(e){this.base=a.Element.TextElementBase,this.base(e),this.getText=function(){var e=this.getHrefAttribute().getDefinition();return null!=e?e.children[0].getText():void 0}},a.Element.tref.prototype=new a.Element.TextElementBase,a.Element.a=function(e){this.base=a.Element.TextElementBase,this.base(e),this.hasText=e.childNodes.length>0;for(var t=0;t<e.childNodes.length;t++)3!=e.childNodes[t].nodeType&&(this.hasText=!1);this.text=this.hasText?e.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(e){if(this.hasText){this.baseRenderChildren(e);var t=new a.Property("fontSize",a.Font.Parse(a.ctx.font).fontSize);a.Mouse.checkBoundingBox(this,new a.BoundingBox(this.x,this.y-t.toPixels("y"),this.x+this.measureText(e),this.y))}else if(this.children.length>0){var i=new a.Element.g;i.children=this.children,i.parent=this,i.render(e)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){a.ctx.canvas.style.cursor="pointer"}},a.Element.a.prototype=new a.Element.TextElementBase,a.Element.image=function(e){this.base=a.Element.RenderedElementBase,this.base(e);var t=this.getHrefAttribute().value;if(""!=t){var i=t.match(/\.svg$/);if(a.Images.push(this),this.loaded=!1,i)this.img=a.ajax(t),this.loaded=!0;else{this.img=document.createElement("img"),1==a.opts.useCORS&&(this.img.crossOrigin="Anonymous");var o=this;this.img.onload=function(){o.loaded=!0},this.img.onerror=function(){a.log('ERROR: image "'+t+'" not found'),o.loaded=!0},this.img.src=t}this.renderChildren=function(e){var t=this.attribute("x").toPixels("x"),o=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");0!=n&&0!=r&&(e.save(),i?e.drawSvg(this.img,t,o,n,r):(e.translate(t,o),a.AspectRatio(e,this.attribute("preserveAspectRatio").value,n,this.img.width,r,this.img.height,0,0),e.drawImage(this.img,0,0)),e.restore())},this.getBoundingBox=function(){var e=this.attribute("x").toPixels("x"),t=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");return new a.BoundingBox(e,t,e+i,t+o)}}},a.Element.image.prototype=new a.Element.RenderedElementBase,a.Element.g=function(e){this.base=a.Element.RenderedElementBase,this.base(e),this.getBoundingBox=function(){for(var e=new a.BoundingBox,t=0;t<this.children.length;t++)e.addBoundingBox(this.children[t].getBoundingBox());return e}},a.Element.g.prototype=new a.Element.RenderedElementBase,a.Element.symbol=function(e){this.base=a.Element.RenderedElementBase,this.base(e),this.render=function(){}},a.Element.symbol.prototype=new a.Element.RenderedElementBase,a.Element.style=function(t){this.base=a.Element.ElementBase,this.base(t);for(var i="",o=0;o<t.childNodes.length;o++)i+=t.childNodes[o].data;i=i.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),i=a.compressSpaces(i);for(var n=i.split("}"),o=0;o<n.length;o++)if(""!=a.trim(n[o]))for(var r=n[o].split("{"),s=r[0].split(","),l=r[1].split(";"),d=0;d<s.length;d++){var c=a.trim(s[d]);if(""!=c){for(var h={},u=0;u<l.length;u++){var m=l[u].indexOf(":"),p=l[u].substr(0,m),g=l[u].substr(m+1,l[u].length-m);null!=p&&null!=g&&(h[a.trim(p)]=new a.Property(a.trim(p),a.trim(g)))}if(a.Styles[c]=h,a.StylesSpecificity[c]=e(c),"@font-face"==c)for(var _=h["font-family"].value.replace(/"/g,""),f=h.src.value.split(","),v=0;v<f.length;v++)if(f[v].indexOf('format("svg")')>0)for(var b=f[v].indexOf("url"),y=f[v].indexOf(")",b),z=f[v].substr(b+5,y-b-6),S=a.parseXml(a.ajax(z)),w=S.getElementsByTagName("font"),x=0;x<w.length;x++){var C=a.CreateElement(w[x]);a.Definitions[_]=C}}}},a.Element.style.prototype=new a.Element.ElementBase,a.Element.use=function(e){this.base=a.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.attribute("x").hasValue()&&e.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&e.translate(0,this.attribute("y").toPixels("y"))};var t=this.getHrefAttribute().getDefinition();this.path=function(e){null!=t&&t.path(e)},this.getBoundingBox=function(){return null!=t?t.getBoundingBox():void 0},this.renderChildren=function(e){if(null!=t){var i=t;"symbol"==t.type&&(i=new a.Element.svg,i.type="svg",i.attributes.viewBox=new a.Property("viewBox",t.attribute("viewBox").value),i.attributes.preserveAspectRatio=new a.Property("preserveAspectRatio",t.attribute("preserveAspectRatio").value),i.attributes.overflow=new a.Property("overflow",t.attribute("overflow").value),i.children=t.children),"svg"==i.type&&(this.attribute("width").hasValue()&&(i.attributes.width=new a.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(i.attributes.height=new a.Property("height",this.attribute("height").value)));var o=i.parent;i.parent=null,i.render(e),i.parent=o}}},a.Element.use.prototype=new a.Element.RenderedElementBase,a.Element.mask=function(e){this.base=a.Element.ElementBase,this.base(e),this.apply=function(e,t){var i=this.attribute("x").toPixels("x"),o=this.attribute("y").toPixels("y"),n=this.attribute("width").toPixels("x"),r=this.attribute("height").toPixels("y");if(0==n&&0==r){for(var s=new a.BoundingBox,l=0;l<this.children.length;l++)s.addBoundingBox(this.children[l].getBoundingBox());var i=Math.floor(s.x1),o=Math.floor(s.y1),n=Math.floor(s.width()),r=Math.floor(s.height())}var d=t.attribute("mask").value;t.attribute("mask").value="";var c=document.createElement("canvas");c.width=i+n,c.height=o+r;var h=c.getContext("2d");this.renderChildren(h);var u=document.createElement("canvas");u.width=i+n,u.height=o+r;var m=u.getContext("2d");t.render(m),m.globalCompositeOperation="destination-in",m.fillStyle=h.createPattern(c,"no-repeat"),m.fillRect(0,0,i+n,o+r),e.fillStyle=m.createPattern(u,"no-repeat"),e.fillRect(0,0,i+n,o+r),t.attribute("mask").value=d},this.render=function(){}},a.Element.mask.prototype=new a.Element.ElementBase,a.Element.clipPath=function(e){this.base=a.Element.ElementBase,this.base(e),this.apply=function(e){var t=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var i=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},t.call(e);for(var o=0;o<this.children.length;o++){var n=this.children[o];if("undefined"!=typeof n.path){var r=null;n.style("transform",!1,!0).hasValue()&&(r=new a.Transform(n.style("transform",!1,!0).value),r.apply(e)),n.path(e),CanvasRenderingContext2D.prototype.closePath=i,r&&r.unapply(e)}}i.call(e),e.clip(),CanvasRenderingContext2D.prototype.beginPath=t,CanvasRenderingContext2D.prototype.closePath=i},this.render=function(){}},a.Element.clipPath.prototype=new a.Element.ElementBase,a.Element.filter=function(e){this.base=a.Element.ElementBase,this.base(e),this.apply=function(e,t){var i=t.getBoundingBox(),o=Math.floor(i.x1),a=Math.floor(i.y1),n=Math.floor(i.width()),r=Math.floor(i.height()),s=t.style("filter").value;t.style("filter").value="";for(var l=0,d=0,c=0;c<this.children.length;c++){var h=this.children[c].extraFilterDistance||0;l=Math.max(l,h),d=Math.max(d,h)}var u=document.createElement("canvas");u.width=n+2*l,u.height=r+2*d;var m=u.getContext("2d");m.translate(-o+l,-a+d),t.render(m);for(var c=0;c<this.children.length;c++)"function"==typeof this.children[c].apply&&this.children[c].apply(m,0,0,n+2*l,r+2*d);e.drawImage(u,0,0,n+2*l,r+2*d,o-l,a-d,n+2*l,r+2*d),t.style("filter",!0).value=s},this.render=function(){}},a.Element.filter.prototype=new a.Element.ElementBase,a.Element.feMorphology=function(e){this.base=a.Element.ElementBase,this.base(e),this.apply=function(){}},a.Element.feMorphology.prototype=new a.Element.ElementBase,a.Element.feComposite=function(e){this.base=a.Element.ElementBase,this.base(e),this.apply=function(){}},a.Element.feComposite.prototype=new a.Element.ElementBase,a.Element.feColorMatrix=function(e){function t(e,t,i,o,a,n){return e[i*o*4+4*t+n]}function i(e,t,i,o,a,n,r){e[i*o*4+4*t+n]=r}function o(e,t){var i=n[e];return i*(0>i?t-255:t)}this.base=a.Element.ElementBase,this.base(e);var n=a.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var r=n[0];n=[.213+.787*r,.715-.715*r,.072-.072*r,0,0,.213-.213*r,.715+.285*r,.072-.072*r,0,0,.213-.213*r,.715-.715*r,.072+.928*r,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var s=n[0]*Math.PI/180,l=function(e,t,i){return e+Math.cos(s)*t+Math.sin(s)*i};n=[l(.213,.787,-.213),l(.715,-.715,-.715),l(.072,-.072,.928),0,0,l(.213,-.213,.143),l(.715,.285,.14),l(.072,-.072,-.283),0,0,l(.213,-.213,-.787),l(.715,-.715,.715),l(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(e,a,n,r,s){for(var l=e.getImageData(0,0,r,s),n=0;s>n;n++)for(var a=0;r>a;a++){var d=t(l.data,a,n,r,s,0),c=t(l.data,a,n,r,s,1),h=t(l.data,a,n,r,s,2),u=t(l.data,a,n,r,s,3);i(l.data,a,n,r,s,0,o(0,d)+o(1,c)+o(2,h)+o(3,u)+o(4,1)),i(l.data,a,n,r,s,1,o(5,d)+o(6,c)+o(7,h)+o(8,u)+o(9,1)),i(l.data,a,n,r,s,2,o(10,d)+o(11,c)+o(12,h)+o(13,u)+o(14,1)),i(l.data,a,n,r,s,3,o(15,d)+o(16,c)+o(17,h)+o(18,u)+o(19,1))}e.clearRect(0,0,r,s),e.putImageData(l,0,0)}},a.Element.feColorMatrix.prototype=new a.Element.ElementBase,a.Element.feGaussianBlur=function(e){this.base=a.Element.ElementBase,this.base(e),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(e,t,i,o,n){return"undefined"==typeof stackBlurCanvasRGBA?void a.log("ERROR: StackBlur.js must be included for blur to work"):(e.canvas.id=a.UniqueId(),e.canvas.style.display="none",document.body.appendChild(e.canvas),stackBlurCanvasRGBA(e.canvas.id,t,i,o,n,this.blurRadius),void document.body.removeChild(e.canvas))}},a.Element.feGaussianBlur.prototype=new a.Element.ElementBase,a.Element.title=function(){},a.Element.title.prototype=new a.Element.ElementBase,a.Element.desc=function(){},a.Element.desc.prototype=new a.Element.ElementBase,a.Element.MISSING=function(e){a.log("ERROR: Element '"+e.nodeName+"' not yet implemented.")},a.Element.MISSING.prototype=new a.Element.ElementBase,a.CreateElement=function(e){var t=e.nodeName.replace(/^[^:]+:/,"");t=t.replace(/\-/g,"");var i=null;return i="undefined"!=typeof a.Element[t]?new a.Element[t](e):new a.Element.MISSING(e),i.type=e.nodeName,i},a.load=function(e,t){a.loadXml(e,a.ajax(t))},a.loadXml=function(e,t){a.loadXmlDoc(e,a.parseXml(t))},a.loadXmlDoc=function(e,t){a.init(e);var i=function(t){for(var i=e.canvas;i;)t.x-=i.offsetLeft,t.y-=i.offsetTop,i=i.offsetParent;return window.scrollX&&(t.x+=window.scrollX),window.scrollY&&(t.y+=window.scrollY),t};1!=a.opts.ignoreMouse&&(e.canvas.onclick=function(e){var t=i(new a.Point(null!=e?e.clientX:event.clientX,null!=e?e.clientY:event.clientY));a.Mouse.onclick(t.x,t.y)},e.canvas.onmousemove=function(e){var t=i(new a.Point(null!=e?e.clientX:event.clientX,null!=e?e.clientY:event.clientY));a.Mouse.onmousemove(t.x,t.y)});var o=a.CreateElement(t.documentElement);o.root=!0,o.addStylesFromStyleDefinition();var n=!0,r=function(){a.ViewPort.Clear(),e.canvas.parentNode&&a.ViewPort.SetCurrent(e.canvas.parentNode.clientWidth,e.canvas.parentNode.clientHeight),1!=a.opts.ignoreDimensions&&(o.style("width").hasValue()&&(e.canvas.width=o.style("width").toPixels("x"),e.canvas.style.width=e.canvas.width+"px"),o.style("height").hasValue()&&(e.canvas.height=o.style("height").toPixels("y"),e.canvas.style.height=e.canvas.height+"px"));var i=e.canvas.clientWidth||e.canvas.width,r=e.canvas.clientHeight||e.canvas.height;if(1==a.opts.ignoreDimensions&&o.style("width").hasValue()&&o.style("height").hasValue()&&(i=o.style("width").toPixels("x"),r=o.style("height").toPixels("y")),a.ViewPort.SetCurrent(i,r),null!=a.opts.offsetX&&(o.attribute("x",!0).value=a.opts.offsetX),null!=a.opts.offsetY&&(o.attribute("y",!0).value=a.opts.offsetY),null!=a.opts.scaleWidth||null!=a.opts.scaleHeight){var s=null,l=null,d=a.ToNumberArray(o.attribute("viewBox").value);null!=a.opts.scaleWidth&&(o.attribute("width").hasValue()?s=o.attribute("width").toPixels("x")/a.opts.scaleWidth:isNaN(d[2])||(s=d[2]/a.opts.scaleWidth)),null!=a.opts.scaleHeight&&(o.attribute("height").hasValue()?l=o.attribute("height").toPixels("y")/a.opts.scaleHeight:isNaN(d[3])||(l=d[3]/a.opts.scaleHeight)),null==s&&(s=l),null==l&&(l=s),o.attribute("width",!0).value=a.opts.scaleWidth,o.attribute("height",!0).value=a.opts.scaleHeight,o.style("transform",!0,!0).value+=" scale("+1/s+","+1/l+")"}1!=a.opts.ignoreClear&&e.clearRect(0,0,i,r),o.render(e),n&&(n=!1,"function"==typeof a.opts.renderCallback&&a.opts.renderCallback(t))},s=!0;a.ImagesLoaded()&&(s=!1,r()),a.intervalID=setInterval(function(){var e=!1;if(s&&a.ImagesLoaded()&&(s=!1,e=!0),1!=a.opts.ignoreMouse&&(e|=a.Mouse.hasEvents()),1!=a.opts.ignoreAnimation)for(var t=0;t<a.Animations.length;t++)e|=a.Animations[t].update(1e3/a.FRAMERATE);"function"==typeof a.opts.forceRedraw&&1==a.opts.forceRedraw()&&(e=!0),e&&(r(),a.Mouse.runEvents())},1e3/a.FRAMERATE)},a.stop=function(){a.intervalID&&clearInterval(a.intervalID)},a.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(e,t){this.events.push({type:"onclick",x:e,y:t,run:function(e){e.onclick&&e.onclick()}})},this.onmousemove=function(e,t){this.events.push({type:"onmousemove",x:e,y:t,run:function(e){e.onmousemove&&e.onmousemove()}})},this.eventElements=[],this.checkPath=function(e,t){for(var i=0;i<this.events.length;i++){var o=this.events[i];t.isPointInPath&&t.isPointInPath(o.x,o.y)&&(this.eventElements[i]=e)}},this.checkBoundingBox=function(e,t){for(var i=0;i<this.events.length;i++){var o=this.events[i];t.isPointInBox(o.x,o.y)&&(this.eventElements[i]=e)}},this.runEvents=function(){a.ctx.canvas.style.cursor="";for(var e=0;e<this.events.length;e++)for(var t=this.events[e],i=this.eventElements[e];i;)t.run(i),i=i.parent;this.events=[],this.eventElements=[]}},a}this.canvg=function(e,i,o){if(null!=e||null!=i||null!=o){"string"==typeof e&&(e=document.getElementById(e)),null!=e.svg&&e.svg.stop();var a=t(o||{});(1!=e.childNodes.length||"OBJECT"!=e.childNodes[0].nodeName)&&(e.svg=a);var n=e.getContext("2d");"undefined"!=typeof i.documentElement?a.loadXmlDoc(n,i):"<"==i.substr(0,1)?a.loadXml(n,i):a.load(n,i)}else for(var r=document.querySelectorAll("svg"),s=0;s<r.length;s++){var l=r[s],d=document.createElement("canvas");d.width=l.clientWidth,d.height=l.clientHeight,l.parentNode.insertBefore(d,l),l.parentNode.removeChild(l);var c=document.createElement("div");c.appendChild(l),canvg(d,c.innerHTML)}};var o;"undefined"!=typeof Element.prototype.matches?o=function(e,t){return e.matches(t)}:"undefined"!=typeof Element.prototype.webkitMatchesSelector?o=function(e,t){return e.webkitMatchesSelector(t)}:"undefined"!=typeof Element.prototype.mozMatchesSelector?o=function(e,t){return e.mozMatchesSelector(t)}:"undefined"!=typeof Element.prototype.msMatchesSelector?o=function(e,t){return e.msMatchesSelector(t)}:"undefined"!=typeof Element.prototype.oMatchesSelector?o=function(e,t){return e.oMatchesSelector(t)}:(("function"==typeof jQuery||"function"==typeof Zepto)&&(o=function(e,t){return $(e).is(t)}),"undefined"==typeof o&&(o=Sizzle.matchesSelector));var a=/(\[[^\]]+\])/g,n=/(#[^\s\+>~\.\[:]+)/g,r=/(\.[^\s\+>~\.\[:]+)/g,s=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,l=/(:[\w-]+\([^\)]*\))/gi,d=/(:[^\s\+>~\.\[:]+)/g,c=/([^\s\+>~\.\[:]+)/g}(),"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(e,t,i,o,a){canvg(this.canvas,e,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:t,offsetY:i,scaleWidth:o,scaleHeight:a})});var ZDOMUtil=function(){var e=void 0;return{init:function(){e={div:document.createElement("div")}},clone:function(t){return e[t].cloneNode()}}}(window),ZComponents=function(e){function t(){var e=document.createElement("div"),t=!1;return e.addEventListener("DOMAttrModified",function(){t=!0},!1),e.setAttribute("class","zcomponents"),t}var i=!0,o=navigator.userAgent.toLowerCase(),a=document.createElement("div"),n=document.createTextNode(" ");return{version:"3.3",isRTL:!1,selector:"data-ctype",userAgent:o,DOMUtil:e,locale:navigator.language,zIndex:1e3,$document:e(document),$window:e(window),hasHandlebars:window.Handlebars?!0:!1,keys:{},localeInfo:{"en-US":{daysAbbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsAbbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],firstDayOfWeek:0,dateFormat:{"short":"M/d/yyyy",medium:"MMM d, yyyy","long":"MMMM d, yyyy",full:"dddd, MMMM d, yyyy"},timeFormat:{"short":"h:mm tt",medium:"h:mm:ss tt","long":"hh:mm:ss tt"},dateTimeFormat:{"short":"MMM d, yyyy, hh:mm:ss tt",medium:"MMM d, yyyy, hh:mm:ss tt","long":"dddd, MMMM d, yyyy 'at' h:mm tt",full:"dddd, MMMM d, yyyy 'at' h:mm tt"},numberFormat:{thousandSeparator:",",decimalSeparator:"."},currency:{code:"USD",name:"United States Dollar",symbol:"$"}}},keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38,ALT:18},initDeferredComponents:function(t,i,o){var a=this;setTimeout(function(){e.each(t,function(t,i){e(i).each(function(i,o){a._initComponent(e(o),t)})}),o&&o(t)},i?i:1e4)},init:function(t,o,a,n){i&&this._init(),n=n||{},t=e(t?t:"body");var r=a?a:this.selector,s="["+r+"]",l=n.nodeArray||(document.querySelectorAll?t[0].querySelectorAll(s):e(s,t));if((t[0].attributes[r]||t[0].dataset&&t[0].dataset[r])&&(l=e(t).add(l)),l.length){var d=this;this.eachAsync(l,{delay:n.delay||20,chunkSize:n.chunkSize||500,loop:function(e,t){d._initComponent(t,void 0,a)},end:function(){d._end(t,l,o)}})}else this._end(t,l,o)},destroy:function(t,i,o){t=e(t?t:"body"),o=o?o:this.selector;var a="["+o+"]",n=e(a,t);if(t.is(a)&&(n=e(t).add(n)),n.length){var r=this;this.eachAsync(n,{delay:20,loop:function(t,i){e(i)[i.getAttribute(o)]("destroy")},end:function(){r._end(t,n,i,!0)}})}else this._end(t,n,i,!0)},eachAsync:function(e,t){var i=0,o=e.length,a=t.loop||function(){};t=t||{},t.test=function(){return o>i},t.loop=function(){var t=e[i];return a.call(t,i++,t)},this.whileAsync(t)},whileAsync:function(e){var t=Math.abs(e.delay)||10,i=e.chunkSize?e.chunkSize:isNaN(e.bulk)?500:Math.abs(e.bulk),o=e.test||function(){return!0},a=e.loop||function(){},n=e.end||function(){};!function r(){for(var e=!1,s=new Date;(e=o())&&(a(),!(0===i||new Date-s>i)););e?setTimeout(r,t):n()}()},_initComponent:function(t,i,o){o=o?o:this.selector,t=e(t),t[i?i:t.attr(o)]()},_end:function(e,t,i,o){this.$document.trigger(o?"zcomponentdestroyed":"zcomponentinitialized",e),i&&i(t)},clearMetadata:function(t){t&&e(t).removeData("metadata")},_getDataAttributes:function(e,t){for(var i=e.attributes,o=i.length,a=0;o>a;a++){var n=i[a].nodeName,r=""===i[a].nodeValue?"true":i[a].nodeValue;"data"!==n&&n.match(/^data-/)&&(n=n.replace(/^data-/,""),n=n.replace(/-([a-zA-Z])/g,this._stringReplace.bind(this)),n=n.replace(/(Html|Svg|Hsv|Hsl|Rgb)/gi,this._toUpperCase),t[n]="true"===r||"false"===r?"true"===r:-1!==r.indexOf("{")?ZComponents._getObject(r):r)}return t},_stringReplace:function(e){return e[1].toUpperCase()},_toUpperCase:function(e){return e.toUpperCase()},_getDataSet:function(e,t){var i,o=e.dataset;for(var a in o)o.hasOwnProperty(a)&&(i=o[a],a=a.replace(/(Html|Svg|Hsv|Hsl|Rgb)/gi,this._toUpperCase),t[a]="true"===i||"false"===i?"true"===i:-1!==i.indexOf("{")?ZComponents._getObject(i):i);return t},_getOptions:void 0,getMetadata:function(e){return this.getOptions(e)},getOptions:function(t){t=t instanceof e?t[0]:t;var i=e.data(t,"metadata");if(!i&&t.attributes){var o=t.getAttribute("data");o&&(i=ZComponents._getObject(void 0,t)),i=this._getOptions(t,i?i:{}),e.data(t,"metadata",i)}return i?i:{}},getTemplate:function(e){var t;return this.hasHandlebars&&Handlebars.templates&&(t=Handlebars.templates[e]),t},_getObject:function(t,i){if("object"==typeof t)return t;t=t||i.getAttribute("data"),t=t.indexOf("{")<0?"{"+t+"}":t;try{t=JSON.parse(t.replace(/'/g,'"'))}catch(o){return e.metadata?e(i).metadata():{}}return t},_extend:function(t,i){t.prototype=e.extend({},i.prototype,t.prototype),e.each(t.prototype,function(o,a){"function"===e.type(a)&&(t.prototype[o]=function(){var e=function(){return i.prototype[o].apply(this,arguments)};return function(){return this._super=e,a.apply(this,arguments)}}())})},OS:{isLinux:function(){return-1!=navigator.appVersion.indexOf("Linux")}},Browser:{isMobile:function(){return/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase())},isIE:function(){return-1!==o.indexOf("msie")||-1!==o.indexOf(".net")},isSafari:function(){return-1!==o.indexOf("safari")&&-1===o.indexOf("chrome")},isChrome:function(){return window.chrome},isFirefox:function(){return o.indexOf("firefox")>-1?!0:!1},isMac:function(){return navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)?!0:!1},isWindows:function(){return-1!==navigator.platform.indexOf("Win")},getIEVersion:function(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=i.exec(t)&&(e=parseFloat(RegExp.$1))}return e}},AJAX:{transport:function(t,i,o){var a=e.ajax({url:t.sourceURL,data:t.data,type:t.type,dataType:t.dataType,success:function(e){i(e)},fail:function(e,t){o(e,t)},error:function(e,t){o(e,t)}});return a}},setI18NKeys:function(t,i,o){if("object"==typeof t)for(var a in t)this.keys[a]=e.extend({},this.keys[a],t[a]);else this.keys[t]=o?i:e.extend({},this.keys[t],i)},getI18NText:function(e,t,i){var o=void 0;4===arguments.length&&(o=i,i=arguments[3]);var a=ZComponents.keys[e]||{},n=a[t]||"";if(""===n&&o&&(n=o[t]),i)for(var r=0;r<i.length;r++)n=n.replace("{"+r+"}",i[r]);return n},create:function(e){var t=e.ctype.replace(e.ctype.charAt(0),""),i="create"+t.charAt(0).toUpperCase()+t.substring(1);return this[i](e)},setProperties:function(){var e=document.documentElement||{},t=document.body||{};ZComponents.documentObject={height:Math.max(e.clientHeight,e.scrollHeight,e.offsetHeight,t.offsetHeight,t.scrollHeight),width:Math.max(e.clientWidth,e.scrollHeight,e.offsetHeight,t.offsetWidth,t.scrollWidth)},ZComponents.windowObject={height:window.innerHeight,width:window.innerWidth}},createSVGElement:function(e,t,i){var o=document.createElementNS("http://www.w3.org/2000/svg",e);for(var a in t)o.setAttribute(a,t[a]);if(i)for(var n=0;n<i.length;n++)for(var r in i[n]){var s=document.createElementNS("http://www.w3.org/2000/svg",r),l=i[n][r];if(l.nodes)s=this.createSVGElement(r,l.props,l.nodes);else for(var d in l)s.setAttribute(d,l[d]);o.appendChild(s)}return o},createIcon:function(t,i,o,a,n){if(i=o?-1===o.indexOf("#")?"#"+o:o:a?a:i)if(-1===i.indexOf("#"))t.addClass(" "+i);else{var o=i.split(" ")[0],r=i.slice(o.length).trim()+" "+(n?n+"__svg":"");t.empty().append(e("<svg class='"+r+"'><use xlink:href='"+o+"'></use></svg>"))}return t},_handleIcon:function(t,i,o,a,n,r,s,l){s&&t.removeClass(l);var d=!1;if(void 0!==r||void 0!==a||void 0!==n)if(r&&0===r.indexOf("#")||void 0!==n){var c=n||r;if(c){var h=c.split(" ");n=h[0],a=h[1]||"",d=!0}}else a=a||r;else if(void 0!==o&&void 0!==i){var c=this._svgSprite.querySelector("#"+o);if(!c){var u=i.props||{};u.id=o;var m=this.createSVGElement("symbol",u,i.nodes);m.removeAttribute("class"),this._svgSprite.appendChild(m)}n="#"+o,a=i.props&&i.props["class"]?i.props["class"]:o,d=!0}return d?(n=-1!==n.indexOf("#")?n:"#"+n,t.empty().append(e("<svg class='"+a+"'><use xlink:href='"+n+"'></use></svg>"))):t.addClass(a),t},_handleFocus:function(t,i){t=e(t),t.off("keyup.fs."+i).on("keyup.fs."+i,function(e){e.keyCode===ZComponents.keyCode.TAB&&t.addClass("has-focus")}).off("keydown.fs."+i).on("keydown.fs."+i,function(e){(e.keyCode===ZComponents.keyCode.ENTER||e.keyCode===ZComponents.keyCode.SPACE)&&t.addClass("has-focus")}).off("blur.fs."+i).on("blur.fs."+i,function(){t.removeClass("has-focus")}).off("focus.fs."+i).on("focus.fs."+i,function(e){e.originalEvent||t.addClass("has-focus")})},encodeHTML:function(e){return n.nodeValue=e,a.innerHTML},_init:function(){ZDOMUtil.init();var o=ZComponents;return i?(i=!1,o._getOptions=ZDOMUtil.clone("div").dataset?o._getDataSet:o._getDataAttributes,o.isDOMAttrModifiedSupported=t(),a.appendChild(n),o.Browser.isIE()&&o.isDOMAttrModifiedSupported&&(o.core._attachObserver=function(e){var t=this;this.observer=function(e){-1!==t.attributeList.indexOf(e.attrName)&&t._handleObserver(e.attrName,e.newValue)},e.addEventListener("DOMAttrModified",this.observer,!1)},o.core.destroy=function(){this.element[0].removeEventListener("DOMAttrModified",this.observer)}),o.setProperties(),o._svgSprite=o.createSVGElement("svg",{id:"zcomponents__svg"}),void e(o._svgSprite).appendTo("body").hide()):!1},registerComponent:function(t,o,a){a||(a=o,o=this.core),a.componentName=t,e[t]=function(e,t,i){arguments.length&&this._init(e,t,i)};var n=new o;n.options=e.extend(!0,{},n.options),e[t].prototype=e.extend(!0,{},n,a),this[t]||(this[t]={DEFAULTS:{}}),this[t]._DEFAULTS=e[t].prototype.options,e.fn[t]=function(o){i&&ZComponents._init();var a=this,n=this.length;if(o&&"object"!=typeof o){if("string"!=typeof o||-1!==o.indexOf("_"))return!1;for(var r=Array.prototype.slice.call(arguments,1),s=0;n>s;s++){var l=e(this[s]).data(t);l&&("option"===o?o=r&&2===r.length?"setAttribute":"getAttribute":"options"===o&&(o=r&&0===r.length?"getAttributes":"setAttributes"),a=l[o].apply(l,r))}}else{o=o?o:{};for(var s=0;n>s;s++){var l=e(this[s]).data(t);if(l){if(n>1)continue;return a}var d=ZComponents.getOptions(this[s],{});if(d.override){var c={};for(var h in d)if(0===h.indexOf(t)){var u=h.replace(t,""),m=u[0].toLowerCase()+u.substring(1);c[m]=d[h]}d=c}var p=e.extend(!0,{},ZComponents[t]._DEFAULTS,ZComponents[t].DEFAULTS,d,o);e(this[s]).data(t,new e[t](p,this[s],o)),e(this[s]).data("componentName",t)}}return a},this._extend(e[t],o)}}}(jQuery);!function(e){"object"==typeof module&&"object"==typeof module.exports&&(module.exports=function(){return e}())}(ZComponents),function(e){var t=e.DOMUtil;e.core=function(e,t){arguments.length&&this._init(e,t)},e.core.prototype={_init:function(e,i,o){this.element=t(i),this.options=e,this._create(t(i),e,o)},_create:function(){},_trigger:function(e,t,i,o,a){return this._dispatchEvent(e,t,i,o,a)},_dispatchEvent:function(e,i,o,a,n){var r=this._EVENTS[e]||e;a=a?a:this.element;var s,l,d,c=this.options[r];o=o||{},o.fromUI=n,o.fromui=n,o.element=a,o.options=o.options||this.options;var i=t.Event(i);if(i.type=(this.componentName?this.componentName+r:""+r).toLowerCase(),i.originalTarget=i.target||i.originalEvent&&i.originalEvent.target,i.target=a,l=i.originalEvent)for(s in l)s in i||(i[s]=l[s]);return a.trigger(i,o),o=[i].concat(o),d=c&&"string"==typeof c?this._triggerFunction(c,a[0],o):t.isFunction(c)?c.apply(a,o):void 0,void 0!==d?d:!i.isDefaultPrevented()},_handleIcon:function(t,i,o,a,n,r,s,l,d,c){return c=c||this.componentName+"__"+o,e._handleIcon(t,i,c,a,n,r,s,l,d)},_triggerFunction:function(e,t,i){for(var o=e.split("."),a=window,n=0;n<o.length&&a;n++)a=a[o[n]];return a&&a.apply(t,i)},_handleObserver:function(e,t){var i=e.replace(/^data-/,"");i=i.replace(/-([a-zA-Z])/g,function(e){return e[1].toUpperCase()}),this.setAttribute(i,t)},_attachObserver:function(e){var t=this;this.observer=new MutationObserver(function(e){var i=e[0].attributeName,o=e[0].target.getAttribute(i);t._handleObserver(i,o)}),this.observer.observe(e,{attributes:!0,attributeFilter:this.attributeList})},_handleFocus:function(t){e._handleFocus(t||this.container,this.componentName)},getData:function(t){return e.getOptions(t?t:this.element[0])},_setAttribute:function(){return!0},_checkIsObject:function(e){return!(e instanceof Array||e instanceof Date||e instanceof RegExp||e instanceof t||e instanceof Element||t.isWindow(e)||e.nodeName)},setAttribute:function(e,i){var o=this.options[e];if("string"!=typeof o||o!==i){i=i&&"object"==typeof i&&"object"==typeof o&&this._checkIsObject(i)?t.extend(!0,{},o,i):i;var a=this._setAttribute(e,i);"disable"===e&&(this._handleDisable(i),a=!0),a&&(this.options[e]=i)}},setAttributes:function(e){for(var t in e)this.setAttribute(t,e[t])},getAttribute:function(e){return this.options[e]},getAttributes:function(){return t.extend(!0,{},this.options)},_localize:function(e,t,i){var o=this.options.labels||this.options.messages,a=i?this.options[i][e]:void 0;return a||this._getI18N(this.componentName,e,o,t)},_getI18N:function(t,i,o,a){var n=e.keys[t]||{},r=n[i]||"";if(""===r&&o&&(r=o[i]),a)for(var s=0;s<a.length;s++)r=r.replace("{"+s+"}",a[s]);return r},enable:function(){this._handleDisable(!0)},disable:function(){this._handleDisable(!1)},_handleDisable:function(e){var i=t(this.container||this.element);e?i.removeClass("is-disabled").removeAttr("aria-disabled disabled"):i.addClass("is-disabled").attr({"aria-disabled":!0,disabled:!0}),this.setAttribute("disabled",!e)},getElement:function(){return this.container||this.element},_destroy:function(){},destroy:function(){this.element.off("."+this.eventPrefix),this.element.removeData(this.componentName).removeData("metadata"),this._destroy();var e=this.container;e&&e[0]!==this.element[0]&&e.remove()}};var i=[],o=[],a=function(e){return o[i.indexOf(e)]};e.bindDocumentEvents=function(n){var r=".zclosehandler-"+Math.floor(1e6*Math.random()),s=n.ctype,l=t(n.element),d=t(n.container||n.element),c=t(n.forElement),h=n.closeMethodName,u=s+(n.closeEvent||h),m={},p=a(l[0]);p&&c.is(p.forElement)||(e.unBindDocumentEvents(l),i.forEach(function(e){var t=a(e);t.contextElements=c.closest(t.container).length?t.contextElements.add(c).add(d):t.contextElements.not(l)}),i.push(l[0]),m.contextElements=d.add(c),m.uniqueNamespace=r,m.forElement=c,m.container=d,m.ctype=s,m.closeFn=h,o.push(m),l.on(u+".zclosehandler",function(){e.unBindDocumentEvents(l)}),m.timer=setTimeout(function(){e.$document.on("mousedown"+r+" contextmenu"+r,function(i){var o=a(l[0]);if(!o||!t.contains(document.documentElement,l[0]))return void e.unBindDocumentEvents(l);if(o.uniqueNamespace===m.uniqueNamespace){var n=t(i.target);if(!n.closest(m.contextElements).length){var r=t.Event("zclosehandlerbeforehide",{originalEvent:i});l.trigger(r),r.isDefaultPrevented()||l[s](h)}}})},10))},e.unBindDocumentEvents=function(a,n){var r=i.indexOf(a[0]);if(-1!==r){var s=o[r];clearTimeout(s.timer);var l=s.contextElements.not(a);l.each(function(i,o){e.unBindDocumentEvents(t(o),!0)}),a.off(".zclosehandler"),e.$document.off(s.uniqueNamespace),r=i.indexOf(a[0]),i.splice(r,1),o.splice(r,1),n&&a[s.ctype](s.closeFn)}}}(ZComponents),document.addEventListener("DOMContentLoaded",ZComponents._init),window.addEventListener("resize",ZComponents.setProperties);var ZPosition=function(e,t){function i(){var t=e("body");if(L)return L;if(L={left:0,top:0},/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){var i=e("<span>").css({position:"absolute",height:"20px",width:"20px",top:"0px",left:"0px"}).appendTo(t);L=i.offset(),L.left=L.left-parseFloat(t.css("margin-left"))-parseFloat(t.css("border-left-width")),L.top=L.top-parseFloat(t.css("margin-top"))-parseFloat(t.css("border-top-width")),i.remove()}return L}function o(t){if(t.preventDefault)return{width:0,height:0,offset:{left:t.pageX,top:t.pageY}};var t=e(t);if(9===t.nodeType)return{width:t.width(),height:t.height(),offset:{left:0,top:0}};if(e.isWindow(t))return{width:t.width(),height:t.height(),offset:{left:t.scrollLeft(),top:t.scrollTop()}};var i={width:w(t[0],"outerWidth"),height:w(t[0],"outerHeight"),offset:a(t)};return i}function a(e){var t=e.offset(),o=i();return t.left-=o.left,t.top-=o.top,t}function n(e){var t=e.split("-");if(/^(top|bottom)$/.test(t[0])||/^corner$/.test(t[2])){B&&B.callback.call(this,B.element,W[t[0]]);var i=A.width+(B?B.width?B.width:B.element.outerWidth():0),o=A.height+(B?B.height?B.height:B.element.outerHeight():0),a=j.top(e,o);if(e=a.direction,a.overTop>0&&R.flipall.test(T.positionAlterable)){var n=j.left("right",i);n.overLeft<=0&&(e=n.direction)}}if(t=e.split("-"),/^(left|right)$/.test(t[0])||/^corner$/.test(t[2])){B&&B.callback.call(this,B.element,W[t[0]]);var i=A.width+(B?B.width?B.width:B.element.outerWidth():0),o=A.height+(B?B.height?B.height:B.element.outerHeight():0),a=j.left(e,i);if(e=a.direction,a.overLeft>0&&R.flipall.test(T.positionAlterable)){var n=j.top("bottom",o);e=n.direction}}return e}function r(e){var t=e.split("-"),i=0,o=0;if(k.preventDefault&&B&&(i=2*B.width+B.width/2,o=2*B.height+B.height/2),/^(left|right)$/.test(t[1])){var a=j.left(t[1],A.width-("corner"===t[0]?0:M.width)-o);e=e.replace(t[1],a.direction)}else if(/^(top|bottom)$/.test(t[1])){var a=j.top(t[1],A.height-M.height-i);e=e.replace(t[1],a.direction)}return e}function s(t){if(T.arrow&&T.arrow.element){var i={},o=T.arrow.element;if(("string"==typeof o||o.jquery||o.nodeType)&&(o=e(o),o.length&&(i.element=o)),i.element&&"static"!==i.element.css("position"))return i.centeredToTarget=/^(center|undefined)$/.test(T.arrow.direction)&&!k.preventDefault?!0:!1,i.callback=e.isFunction(T.arrow.callback)?T.arrow.callback:e.isFunction(T.arrowCallback)?T.arrowCallback:e.noop,i.direction=W[t],i.callback.call(this,i.element,i.direction.split("-")[0]),i.height="number"==typeof T.arrow.height?T.arrow.height:0,i.width="number"==typeof T.arrow.height?T.arrow.width:0,i.minSpace=T.arrow.minSpace,i.margin=T.arrow.margin||{left:0,top:0},i;T.arrow=void 0}}function l(){return A.height>p(T.direction)?p(T.direction):A.height}function d(){return A.width>g(T.direction)?g(T.direction):A.width}function c(e,t){var i,o=e.direction.split("-"),a=o[1],n=0,r=d(),s=l();/^(left|right)$/.test(o[1])?i=r-e.width:/^(top|bottom)$/.test(o[1])?i=s-e.height:/^(top|bottom)$/.test(o[0])?(i=r-e.width,a="left"):/^(left|right)$/.test(o[0])&&(i=s-e.height,a="top"),t[a]>i&&(t[a]=i),t[a]<n&&(t[a]=n)}function h(e,t){e.element.css({left:"auto",top:"auto",right:"auto",bottom:"auto"});var i={},o=e.direction.split("-");if(/^(top|bottom)$/.test(o[0])?(i[o[0]]=-e.height,o[1]||(i.left=A.width/2-e.width/2-t.left)):/^(left|right)$/.test(o[0])&&(i[o[0]]=-e.width,o[1]||(i.top=A.height/2-e.height/2-t.top)),/^(left|right)$/.test(o[1])){var a=t.left;"left"===o[1]&&(a=-a),M.width&&A.width>M.width?i[o[1]]=M.width/2-e.width/2+a:i.left=A.width/2-e.width/2}else if(/^(top|bottom)$/.test(o[1])){var a=t.top;"top"===o[1]&&(a=-a),M.height&&A.height>M.height?i[o[1]]=M.height/2-e.height/2+a:i.top=A.height/2-e.height/2}var n="none"!==I.css("box-shadow");return"top"===e.direction.split("-")[0]?i.top=i.top+(parseFloat(I.css("border-top-width"))||n?1:0):"bottom"===e.direction.split("-")[0]?i.bottom=i.bottom+(parseFloat(I.css("border-bottom-width"))||n?1:0):"right"===e.direction.split("-")[0]?i.right=i.right+(parseFloat(I.css("border-right-width"))||n?1:0):"left"===e.direction.split("-")[0]&&(i.left=i.left+(parseFloat(I.css("border-left-width"))||n?1:0)),/^(bottom|top)/.test(e.direction)?i.top=i.bottom="":i.left=i.right="",i}function u(t){var i=e.extend({},t),o=T.direction,a=(A.width+B?B.width:0,A.height+B?B.height:0,o.split("-"));if(a[1]=void 0===a[1]?/^(top|bottom)$/.test(a[0])?"left":"top":a[1],E.isWindow?{left:F.scrollLeft,top:F.scrollTop}:E.offset,/^(top|bottom)$/.test(a[1])||k.preventDefault){var n=E.scrollTop-i.top;n>0&&(i.top+=n);var r=i.top+A.height-(E.scrollTop+p().complete);r>0&&(i.top-=r)}if(/^(left|right)$/.test(a[1])||k.preventDefault){var s=E.scrollLeft-i.left;s>0&&(i.left+=s);var l=i.left+A.width-(E.scrollLeft+g().complete)+1;l>0&&(i.left-=l)}return i}function m(t){var i,o;T.direction=t,/corner/.test(T.direction)||(B=s(T.direction)),T.callbacks.beforeComputingDir.dimensionModifier(M,A,E),R.flip.test(T.positionAlterable)&&!N&&(T.direction=n(T.direction)),B&&(B.direction=W[T.direction],B.callback.call(this,B.element,B.direction.split("-")[0]),B.height||(B.height=B.element.outerHeight()),B.width||(B.width=B.element.outerWidth())),R.flipside.test(T.positionAlterable)&&(T.direction=r(T.direction)),T.callbacks.beforeComputingPos.dimensionModifier(M,A,E),o=_(T.direction),i=e.extend({},o),R.fit.test(T.positionAlterable)&&(i=u(o)),i.top<E.scrollTop&&(i.top=E.scrollTop),i.left<E.scrollLeft&&(i.left=E.scrollLeft);var a;if(B&&R.flipall.test(T.positionAlterable)&&!N&&!k.preventDefault){var p=B.minSpace;if(void 0!==p){var g,f,v,y,z=T.direction.split("-"),S=d(),w=l();g=M.offset.left-S+B.width,f=M.offset.top-w+B.height,v=M.offset.left+M.width-B.width,y=M.offset.top+M.height-B.height,/^(top|bottom)$/.test(z[0])?(i.left<g&&(a="left"),i.left>v&&(a="right")):/^(left|right)$/.test(z[0])&&(i.top<f&&(a="top"),i.top>y&&(a="bottom"))}}if(!a||N){var x=b(i,I);if(B){B.direction=W[T.direction];var C={left:i.left-o.left,top:i.top-o.top};B.position=h(B,C),c(B,B.position)}}else N=!0,x=m(a);return x}function p(e){if(!O)if(E.isWindow||E.isDocument)O={top:M.offset.top-E.scrollTop,bottom:E.height-(M.offset.top+M.height-E.scrollTop),complete:E.height};else{O={},O.top=E.offset.top<F.scrollTop?M.offset.top-F.scrollTop:M.offset.top-E.scrollTop,O.bottom=E.offset.top+E.height-(M.offset.top+M.height);var t=F.height+F.scrollTop-(E.offset.top+E.height);0>t&&(O.bottom+=t),O.complete=O.top+O.bottom+M.height}return e?(e=e.split("-")[0],"top"===e?O.top:"bottom"===e?O.bottom:O.complete):O}function g(e){if(!P)if(E.isWindow||E.isDocument)P={left:M.offset.left-E.scrollLeft,right:E.width-(M.offset.left+M.width-E.scrollLeft),complete:E.width};else{P={},P.left=E.offset.left<F.scrollLeft?M.offset.left-F.scrollLeft:M.offset.left-E.scrollLeft,P.right=E.offset.left+E.width-(M.offset.left+M.width);var t=F.width+F.scrollLeft-(E.offset.left+E.width);0>t&&(P.right+=t),P.complete=P.left+P.right+M.width}if(!e)return P;var i=e.split("-"),o="corner"===i[2]?i[1]:i[0];return"left"===o?P.left:"right"===o?P.right:P.complete}function _(t){t=t||T.direction,R.relDirections.test(t)||(T.direction=t="top-left");var i=t.split("-"),o=e.extend({},M.offset);return"top"===i[0]?o.top-=A.height+(B?B.height:0):"bottom"===i[0]?o.top+=M.height+(B?B.height:0):"left"===i[0]?o.left-=A.width+(B?B.width:0):"right"===i[0]&&(o.left+=M.width+(B?B.width:0)),void 0===i[1]?i[0].match(/^left|right$/)?o.top=o.top-A.height/2+M.height/2:o.left=o.left-A.width/2+M.width/2:"top"===i[1]?o.top=o.top+M.height-A.height:"left"===i[1]?o.left=o.left-A.width+("corner"===i[2]?0:M.width):"right"===i[1]&&"corner"===i[2]&&(o.left=o.left+M.width),o}function f(t){if(t=e(t),t.is(":hidden"))for(var i=1,o=t;i&&o&&!o.is("body");)"none"===o.css("display")&&(D.push(o),V.push(o.attr("style")||""),o.css({display:"block",position:"absolute",opacity:1,visibility:"hidden"}),i=o.is(":hidden")),o=o.parent()}function v(){D&&D.length&&(D.forEach(function(e,t){e.attr("style",V[t])}),D=[],V=[])}function b(t,i){var o=e.extend({},t),a=i.css("position"),n=i.parent()[0],r=e("<span>").css({position:a,height:"20px",width:"20px",top:"0px",left:"0px",transform:"none",margin:"0px",display:"",visibility:"hidden"});n.appendChild(r[0]);var s=r.offset();return n.removeChild(r[0]),o.top=o.top-s.top,o.left=o.left-s.left,o}function y(){var t=document.createElement("div"),i="width:100px;height:100px;overflow:scroll;";document.querySelector("body").appendChild(t),t.style.cssText=i;var o=e(t).width()-t.scrollWidth;return document.querySelector("body").removeChild(t),o||0}function z(i){i=i.length?i:t;var o,n,r,s=e.isWindow(i[0]),l=!!i[0]&&9===i[0].nodeType,d=s||l?{left:0,top:0}:a(i)||{left:0,top:0},c=s||l?F.scrollLeft:d.left<F.scrollLeft?F.scrollLeft:d.left,h=s||l?F.scrollTop:d.top<F.scrollTop?F.scrollTop:d.top;if(s?(o=F.width,n=F.height):l?(o=document.documentElement.scrollWidth,n=document.documentElement.scrollHeight):(o=i.outerWidth(),n=i.outerHeight(),r=i),r){var u,m=r.css("overflow-x"),p=r.css("overflow-y"),g="scroll"===m||("auto"===m||r.is("body")&&"visible"===m)&&o<r[0].scrollWidth,_="scroll"===p||("auto"===p||r.is("body")&&"visible"===p)&&n<r[0].scrollHeight;g&&(n-=void 0===u?y():u),_&&(o-=u=y())}return{element:i,isWindow:s,isDocument:l,offset:d,scrollLeft:c,scrollTop:h,width:o,height:n}}function S(e){return"top-left"===e?e="top-right":"bottom-left"===e?e="bottom-right":"top-right"===e?e="top-left":"bottom-right"===e&&(e="bottom-left"),e}function w(t,i){var o,a,n=window.getComputedStyle(t).transform;if(t instanceof SVGElement&&(a=!0),a||!n||"none"===n){var r=t.getBoundingClientRect();if(r)switch(i){case"outerWidth":o=r.width;break;case"outerHeight":o=r.height}}return(isNaN(o)||!o)&&(o=e(t)[i]()),o}function x(i,a,n){if(T=e.extend(!0,{},H,n),k=i,I=a,T.showWithinTarget)return C();var r=T.direction;I.css({top:"0px",left:"0px"}),A=T.computeElementDim?o(I):{};var s,l;A.height>document.documentElement.clientHeight&&R.flip.test(T.positionAlterable)&&(s=!0,l=I[0].style.display||"",I.css("display","none")),F={scrollLeft:t.scrollLeft(),scrollTop:t.scrollTop()+T.withinPadding,height:document.documentElement.clientHeight-2*T.withinPadding,width:document.documentElement.clientWidth},M=T.customDimensions?k:T.computeTargetDim?o(k):{},E=T.computeWithinDim?z(e(T.within)):{},s&&I.css("display",l),T.direction=R.relDirections.test(T.direction)?S(T.direction):"top-right";var d=m(T.direction),c={elementPosition:d||{left:0,top:0},oldDirection:r,direction:S(T.direction),arrowPosition:B?B.position:{left:0,top:0},arrowDirection:W[T.direction]&&W[T.direction].split("-")[0]},h=T.direction.split("-");return/^(top|bottom)$/.test(h[0])?(c.availableHeight=p(h[0])-(B?B.height:0),c.availableWidth=g(h[0])):/^(left|right)$/.test(h[0])&&(c.availableHeight=p(h[0]),c.availableWidth=g(h[0])-(B?B.width:0)),c}function C(){k=e(k);var t,i={};k.length&&k[0]!==window&&9!==k[0].nodeType||(k=e(window),t=!0),R.withinDirections.test(T.direction)||(T.direction="top-left");var o={width:k.outerWidth()-(t?0:parseFloat(k.css("border-right-width"))+parseFloat(k.css("border-left-width"))),height:k.outerHeight()-(t?0:parseFloat(k.css("border-top-width"))-parseFloat(k.css("border-bottom-width")))};o.offset=t?{left:window.scrollX,top:window.scrollY}:a(k)||{left:0,top:0};var n={width:I.outerWidth(),height:I.outerHeight()},r=["center","left","right","top","bottom"],s={left:"width",top:"height"};for(var l in s){var d="left"===l?"right":"bottom",c=s[l];-1!==T.direction.indexOf(l)?i[l]=o.offset[l]:-1!==T.direction.indexOf(d)?i[l]=o.offset[l]+o[c]-n[c]:-1!==r.indexOf(T.direction)&&(i[l]=o.offset[l]+o[c]/2-n[c]/2)}return i=b(i,I),{elementPosition:i}}var k,I,T,E,M,A,O,P,F,I,B,N,D,V,L,H={direction:"top-left",showWithinTarget:!1,within:t,computeElementDim:!0,computeTargetDim:!0,computeWithinDim:!0,arrow:{minSpace:0,margin:{left:0,top:0},callback:void 0},callbacks:{beforeComputingDir:{dimensionModifier:e.noop,directionModifier:e.noop},beforeComputingPos:{dimensionModifier:e.noop,directionModifier:e.noop}},withinPadding:0,customDimensions:!1,positionAlterable:"flipallfit"},W={"top-left":"bottom-right","top-right":"bottom-left","bottom-left":"top-right","bottom-right":"top-left",top:"bottom",bottom:"top",left:"right",right:"left","left-top":"right-bottom","left-bottom":"right-top","right-top":"left-bottom","right-bottom":"left-top"},R={relDirections:/^(top|top-right|top-left|bottom|bottom-right|bottom-left|left|left-top|left-bottom|right|right-top|right-bottom|top-left-corner|top-right-corner|bottom-left-corner|bottom-right-corner)$/,withinDirections:/^(top|bottom|left|right|top-left|top-right|bottom-left|bottom-right|center)$/,fit:/^(fit|flipfit|flipallfit|flipsidefit|flipsideallfit|true)$/,flip:/^(flip|flipfit|flipall|flipallfit|flipside|flipsidefit|flipsideall|flipsideallfit|true)$/,flipside:/^(flipside|flipsidefit|flipsideall|flipsideallfit|true)$/,flipall:/^(flipall|flipallfit|flipsideall|flipsideallfit|true)$/},j={top:function(e,t){var i=e.split("-")[0],o={direction:e},a=p(e);if(o.overTop=t-a,o.overTop>0){var n="top"===i?"bottom":"top",r=p(e.replace(i,n));r>a&&(o.direction=e.replace(i,n),o.overTop=t-r)}return o},left:function(e,t){var i,o,a=e.split("-"),n={direction:e},r=g(e);if(n.overLeft=t-r,n.overLeft>0){i=a[0],"corner"===a[2]&&(i=a[1]),o="left"===i?"right":"left";var s=g(e.replace(i,o));s>r&&(n.direction=e.replace(i,o),n.overLeft=t-s)}return n}};return{get:function(t,i,o){if(t&&e(i).length&&(t instanceof e&&(t=t[0]),i instanceof e&&(i=i[0]),1===i.nodeType&&(1===t.nodeType||o.showWithinTarget&&(t===window||t===document)||t.preventDefault||o.customDimensions))){D=[],V=[],f(t),f(i),o=o||{};var a=x(t,e(i),o);return v(),k=I=N=B=T=E=A=O=P=F=L=D=V=void 0,a}}}}(jQuery,jQuery(window),jQuery(document));!function(e){function t(){var e=document.createElement("div");return s._iconDiv=e.cloneNode(),s._iconDiv.className="zmenu__iconcontainer",s._icon=document.createElement("i"),document.querySelector("body").appendChild(e),e.style.cssText="width:50px;height:50px;overflow:scroll;",r._scrollWidth=i(e).width()-e.scrollWidth,i(e).remove(),s._text=document.createElement("span"),s._hint=s._text.cloneNode(),s._key=s._text.cloneNode(),s._text.className="zmenu__text",s._hint.className="zmenu__hint",s._key.className="zmenu__shortcut",r._scrollWidth}var i=e.DOMUtil,o=e.getTemplate("zmenu.hbs"),a=e.getTemplate("zmenujson.hbs"),n=!1;!e.Browser.isIE()&&o&&a&&(Handlebars.partials=Handlebars.templates,n=!0);var r={options:{displayType:"box",direction:"auto",type:"list",toggle:!0,contentType:"text",renderInPlace:!1,columnCount:void 0,columns:3,search:!1,forElement:void 0,width:void 0,height:void 0,menuClass:"",className:"",animation:void 0,pointer:!1,checkedRadioItemIconClassName:void 0,checkedRadioItemSVGIconId:void 0,checkedCheckboxItemIconClassName:void 0,checkedCheckboxItemSVGIconId:void 0,isCustomHTMLEncoded:!0,htmlSafe:!0,offset:void 0,scroll:"slider",constructMenu:!0,EFFECTS:{slide:{open:"slideDown",close:"slideUp"},fade:{open:"fadeIn",close:"fadeOut"}},minWidth:200,handleAccessKeyNavigation:!0},ANIMATION_EVENTS:"webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend webkitTransitionEnd msTransitionEnd oTransitionEnd transitionEnd transitionend",ARIA_ROLES:{"default":"menuitem",custom:"menuitem",radio:"menuitemradio",checkbox:"menuitemcheckbox",itemgroup:"group",separator:"separator"},EFFECTS:{slide:{open:"slideDown",close:"slideUp"},fade:{open:"fadeIn",close:"fadeOut"}},_MENU_CONTENT_TYPES:{text:"",icon:"zmenu--icononly","icon-text":"zmenu--iconwithtext"},_MENU_ITEM_TYPES:{"default":"zmenu__item",separator:"zmenu__separator",splitmenu:"zmenu__item zmenu--split",itemgroup:"zmenu__title"},_DIRECTIONS:{menu:"bottom-left",submenu:"right-bottom",pointer:"bottom"},_attrNames:["id","name","data-item-type","disabled","checked","hidden","data-fixed","data-is-footer","data-item-value","data-label","data-icon","data-icon-class-name","data-svg-icon-id","data-text-as-icon","data-shortcutkey","data-shortcut-key","data-hint","data-description","data-menu-id"],_EVENTS:{ONBEFORESHOW:"beforeshow",ONBEFOREHIDE:"beforehide",ONSHOW:"show",ONHIDE:"hide",ONSUBMENUMENUITEMCLICKED:"submenuitemclick",ONBEFORESUBMENUSHOW:"beforesubmenushow",ONSUBMENUSHOW:"submenushow",ONBEFORESUBMENUHIDE:"beforesubmenuhide",ONSUBMENUHIDE:"submenuhide",ONMENUITEMHOVERED:"itemhover",ONMENUITEMCLICKED:"itemclick",ONBEFOREFOCUS:"beforefocus",ONKEYDOWN:"keydown"},_lastOverlayedMenuItem:void 0,_lastOverlayedMenu:void 0,_create:function(o,a){this.scrollWidth=void 0===r._scrollWidth?t():r._scrollWidth,this.options.appendTo=void 0!==a.appendTo&&a.appendTo.length?i(a.appendTo):void 0,a.usingJSON||this._buildMenu(o),"DIV"===this.element[0].tagName&&o.find("ul:first").addClass("zmenu__list"),o[0].setAttribute("role","menu"),this._initEvents(),this._menuTextArray=[],a.search&&this._createSearchContainer(o),a.renderInPlace?(this._resetMenuTextArray(o),this.show()):o[0].style.display="none",o.data("toggle",a.toggle),o[0].setAttribute("tabindex",0),o[0].style.outline=0,a.height&&o.data("height",a.height),a.width&&o.data("width",a.width),e.isRTL&&(this._DIRECTIONS.submenu="left-bottom")},_buildMenu:function(e){var t=e[0].querySelectorAll("li");if(this.options.constructMenu){for(var o=0;o<t.length;o++)this._buildMenuItem(i(t[o]),e);e[0].className+=" zmenu "+("grid"===this.options.type?"zmenu--thumbnail":this._MENU_CONTENT_TYPES[this.options.contentType])+" "+(this.options.menuClass?this.options.menuClass:"")+" "+(this.options.className?this.options.className:"")}else for(var o=0;o<t.length;o++)this._handleCheckedandDisabled(i(t[o]),this.getData(t[o])),this._addEventsForMenuItems(i(t[o]))},_createSearchContainer:function(t){var o=i("<div class='zmenu__header'></div>"),a=i("<input type='text' class='zmenu__textbox' placeholder='Search' />"),n=i("<i class='zmenu__icon'></i>"),r=e.createSVGElement("svg",{"class":"zmenu__search",viewBox:"0 0 16 16",width:"100%",height:"100%"},[{path:{d:"M15.6,15.6c-0.6,0.6-1.5,0.6-2.1,0l-2.7-2.7C9.7,13.6,8.4,14,7,14c-3.9,0-7-3.1-7-7s3.1-7,7-7c3.9,0,7,3.1,7,7c0,1.4-0.4,2.7-1.1,3.8l2.7,2.7C16.1,14,16.1,15,15.6,15.6z M7,2C4.2,2,2,4.2,2,7s2.2,5,5,5c2.8,0,5-2.2,5-5C12,4.2,9.8,2,7,2z"}}]);n[0].appendChild(r),o.append(a,n),this.element.prepend(o),t.data("_styleElement",i("<style id='zmenu-search-filter' type='text/css'>").appendTo("head")),a.on("keydown."+this.componentName,function(t){t.keyCode===e.keyCode.TAB&&t.preventDefault()})},_buildMenuItem:function(t,a){var r=this.getData(t),l=r.menuId||(t[0].firstElementChild&&"object"==typeof t[0].firstElementChild&&t[0].firstElementChild.tagName?"UL"===t[0].firstElementChild.tagName:!1),d=r.className?r.className:r.itemCssClass?r.itemCssClass:"";if(r.isGrid="grid"===this.options.type,t[0].className+=" "+(this._MENU_ITEM_TYPES[r.itemType]?this._MENU_ITEM_TYPES[r.itemType]:"zmenu__item")+" "+d,r.parentMenu=t.parent(),r.disabled=void 0!==r.disabled?r.disabled:null!=t[0].getAttribute("disabled"),r.hidden=void 0!==r.hidden?r.hidden:null!=t[0].getAttribute("hidden"),r.checked=void 0!==r.checked?r.checked:null!=t[0].getAttribute("checked"),l&&(r.hasSubmenu=!0,this._buildSubmenu(t,r)),t[0].setAttribute("role",this.ARIA_ROLES[r.itemType?r.itemType:"default"]),"separator"===r.itemType)return void this._handleCheckedandDisabled(t,r);if("custom"===r.itemType||r.custom){if(t[0].className+=" zmenu__custom",r.innerHTML){var c=r.innerHTML.content,h=r.innerHTML.replaceArray;if(c&&h){for(var u=0;u<h.length;u++)c=c.replace("{"+u+"}",e.encodeHTML(h[u]));t.html(c)}else t.html(this.options.isCustomHTMLEncoded||this.options.htmlSafe?r.innerHTML:e.encodeHTML(r.innerHTML))}return r.hasSubmenu&&this._createArrowIcon(t),this._handleCheckedandDisabled(t,r),this._addEventsForMenuItems(t)}r.label=r.label?r.label:t.text().trim(),r.label=r.ellipsis?r.label+"...":r.label;var m=r.shortcutkey||r.shortcutKey;r.shortcutkey=window.ZShortCut?ZShortCut.getInfo(r.actionName,t,!0):m,t[0].innerHTML="";var p=t;if(r.action&&"string"==typeof r.action&&-1!==r.action.indexOf("URL:")&&(r.target=r.target?r.target:"_blank",t.addClass("zmenu--withlink").append("<a class='zmenu__link' href='"+r.action.replace("URL:","")+"' target='"+r.target+"'>"),p=t.find(".zmenu__link"),"_blank"===r.target&&p.attr("rel","noopener noreferrer")),n)r.icon=r.SVGIconId?"#"+r.SVGIconId:r.iconClassName?r.iconClassName:r.icon,r.icon&&-1!==r.icon.indexOf("#")&&(r.svgId=r.icon.split(" ")[0],r.svgClass=r.icon.slice(r.svgId.length).trim()),"itemgroup"!==r.itemType&&(r["icon"===this.options.contentType?"icon-only":this.options.contentType]=this.options.contentType),p.append(o(r));else{if("text"!==this.options.contentType)if("itemgroup"!==r.itemType){var g=r.isGrid,_=g?void 0:s._iconDiv.cloneNode(),f=s._icon.cloneNode();f.className=g?"zmenu__image ":"zmenu__icon ",this._handleIcon(i(f),void 0,void 0,r.iconClassName,r.SVGIconId,r.icon),!g&&_.appendChild(f),p[0].appendChild(g?f:_)}else"icon"===this.options.contentType&&this._domUpdate(s._text,r.label,p);"icon"!==this.options.contentType&&(this._domUpdate(s._text,r.label,p),r.hint||r.description?this._domUpdate(s._hint,r.hint?r.hint:r.description,p):r.shortcutkey&&this._domUpdate(s._key,r.shortcutkey,p)),r.hasSubmenu&&this._createArrowIcon(p)}r.icon&&0===r.icon.indexOf("text:")&&"text"!==this.options.contentType&&t.find("i:first").removeClass(r.icon).text(r.icon.replace("text:","")),(r.fixed||r.isFooter)&&this._addFixedItem(t,a,r),t[0].setAttribute("data-item-type",r.itemType),"icon"!==this.options.contentType&&t[0].setAttribute("data-label",r.label),this._handleCheckedandDisabled(t,r),this._addEventsForMenuItems(t,r)},_domUpdate:function(e,t,i){var o=e.cloneNode();i[0].appendChild(o),o.textContent=t},_createArrowIcon:function(e){var t=i("<i class='zmenu__icon h-alignright'/>"),o={props:{"class":"zmenu__arrow",viewBox:"0 0 16 16",width:"100%",height:"100%"},nodes:[{polygon:{points:"6.5,12.5 5.5,11.5 9,8 5.5,4.5 6.5,3.5 11,8"}}]};return this._handleIcon(t,o,"arrow",this.options.arrowIconClassName,this.options.arrowSVGIconId),e.append(t),t},_addFixedItem:function(e,t,o){if(o.label&&"icon"===this.options.contentType&&"grid"===this.options.type&&!e.find(".zmenu__text").length&&e.append(i("<span class='zmenu__text'>"+o.label+"</span>")),t.find(".zmenu__footer").length)t.find(".zmenu__footer ul").append(e);else{var a=i("<div class='zmenu__footer'><ul class='zmenu__list'></ul></div>");t.append(a),a.find("ul").append(e.addClass("is-fixed")),t.data("fixedArea",a.find("ul"))}},_buildSubmenu:function(e,t){var o=this.getSubmenu(e);if(o&&(e.addClass(t.splitmenu||"splitmenu"===t.itemType?"zmenu--split":"zmenu--submenu"),e.data("submenu",o),!t.menuId)){var a=this.getData(o);i(a.appendTo?a.appendTo:"body").append(o),this.getData(e).menuId=o.attr("id"),o.zmenu()}},getSubmenu:function(e){if(e.data("submenu"))return e.data("submenu");var t=this.getData(e).menuId;return t?(t=i("#"+t),t.length?(t.data("zmenu")||t.zmenu(),t.data("isExternalSubmenu",!0),t):void 0):e.children("ul:first")},_handleCheckedandDisabled:function(e,t,i){var o=void 0!==i;(o?"hidden"===i:void 0!==t.hidden)&&this._hideMenuItem(e,!t.hidden),(o?"disabled"===i:void 0!==t.disabled)&&(e[t.disabled?"addClass":"removeClass"]("is-disabled"),e.attr("aria-disabled",t.disabled),t.disabled?e.attr("disabled",!0):e.removeAttr("disabled"));var a=o?"checked"===i:!0;!a||"text"===this.options.contentType||void 0===t.checked||"checkbox"!==t.itemType&&"radio"!==t.itemType||this._checkMenuItem(e,t.checked,t)},_initEvents:function(e){var t=this,o=this.componentName;e=i(e?e:this.element),e.data("initialized")&&!e||e.data("isExternalSubmenu")||(e.data("initialized",!0),e.on("mouseup."+o,function(o){(3!==o.which||i(o.target).closest(".zmenu--withlink").length)&&t._handleMenuItemClick(o,e)}).on("contextmenu."+o,function(e){var t=i(e.target).closest(".zmenu__item");t.length&&t.hasClass("zmenu--withlink")&&e.stopPropagation()}))},_handleMenuItemClick:function(e,t){t=t||this.element;var o=i(e.target);if(o.is("li")||(o=o.closest("li")),o&&0!==o.length&&!o.hasClass("separator")&&!o.hasClass("zmenu__title")){var a=this.getData(o),n=o.data("submenu")&&o.data("submenu").length&&!o.hasClass("zmenu--split")?!0:!1;if(!a.disabled){if(n&&"click"===a.openOn){var r=this.getSubmenu(o),s=this;r.is(":visible")?this.hide(r,function(){r.data("forElement")[0]!==o[0]&&s._showSubmenu(o,{event:e},!1,e)}):(this._checkAndHideAllOpenedSubMenus(t,!0),this._showSubmenu(o,{event:e},!0,e)),e.preventDefault(),e.stopPropagation()}var l=a.action;void 0!==l&&("function"!=typeof l&&"string"==typeof l&&-1===l.indexOf("URL:")?this._triggerFunction(l,o,[e,{menuitem:o,options:a}]):"function"==typeof l&&l.call(o,e,{menuitem:o,options:a})),this._triggerEvent("beforeitemchecked",e,t,o,{})&&("checkbox"===a.itemType||"radio"===a.itemType)&&this._checkMenuItem(o,"checkbox"===a.itemType?!o.prop("checked"):!0,a),this._triggerEvent(void 0!==t.data("parent")?"ONSUBMENUMENUITEMCLICKED":"ONMENUITEMCLICKED",e,t,o,{})&&(this.options.renderInPlace||(!n&&this.hide(void 0,void 0,e),o&&!o.is(".zmenu--withlink")&&e&&e.preventDefault&&(e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation())))}}},show:function(t,o){t=t?t:{};var a=i(this.options.appendTo),n=t.isSubMenu=o?!0:!1,o=o?o:this.element,r=i(t.forElement?t.forElement:this.options.forElement),s=this._isGridMenu(o),l=t.offset?t.offset:this.options.offset?this.options.offset:void 0;if(this._uninitSliders(o),n||(this.options.forElement=t.forElement=r),o.is(":visible")&&!t.mustBeShown)return void(this.options.toggle&&!n&&this.hide());if(n?o.data({forElement:r,parent:r}):(this.options.handleAccessKeyNavigation&&this._initRuntimeEvents(),this.element.data("forElement",r)),this.options.renderInPlace&&!n||t.mustBeShown||(void 0!==a&&a.length?a.append(o):i("body").append(o)),t.within=this.options.viewport&&i(this.options.viewport).length?i(this.options.viewport):a,this.updateLastMenuChain(o),o.data("modified")&&(o.find("#noresultFound").remove(),o.data("_styleElement").empty()),s||this.options.renderInPlace||o.addClass("zmenu__width"),this.options.renderInPlace)o.css({width:"inherit",height:"inherit",position:"relative"}),this._openWithAnimation(o,t,d);else{e.bindDocumentEvents&&e.bindDocumentEvents({element:o,forElement:t.isRightClick?void 0:r,ctype:this.componentName,closeMethodName:"hide",closeEvent:"hide"});var d=t.event?t.event:{};if(t.isRightClick=t.isRightClick?t.isRightClick:t.direction?"after-pointer"===t.direction||"at-cursor"===t.direction:"after-pointer"===this.options.direction||"at-cursor"===this.options.direction,!this._triggerEvent(n?"ONBEFORESUBMENUSHOW":"ONBEFORESHOW",d,o,void 0,{currentTarget:t.isRightClick?d.target:r}))return;var c=this;if(o.css({display:"block",opacity:"0"}),this._setFocus(),o.data("width")){var h=parseInt(o.outerWidth(!0)),u=parseInt(o.data("width"));if(h>u){var m=o.find("li").map(function(e,t){return i(t).find(".zmenu__shortcut").length?parseInt(i(t).find(".zmenu__shortcut").outerWidth(!0)):0});m=Math.max.apply(null,m),m&&o.find("li:not(li.zmenu__title) .zmenu__text").css("width","calc(100% - "+m+"px)")}o.removeClass("zmenu__width"),o.width(u)}else o.outerWidth()<parseInt(this.options.minWidth)&&"icon"!==o.data("zmenu").options.contentType&&(o.removeClass("zmenu__width"),o.width("border-box"===o.css("box-sizing")?parseInt(this.options.minWidth)-parseInt(o.css("border-left-width"))-parseInt(o.css("border-right-width"))-1:parseInt(this.options.minWidth)-1));var p=!1;if(s&&this._fixFloatingMenuWidth(o),o.css("height","auto"),o.find("ul").length&&o.find("ul").css("height","auto"),o.data("height")<=o.outerHeight()&&(o.outerHeight(parseInt(o.data("height"))),p=!0),o.removeClass("zmenu__width"),!s){var g=o.innerWidth()+1+(p?this.scrollWidth:0);o.width(g)}if(this.refresh(o),t&&!t.position){if(t.direction=t.direction?"auto"===t.direction||t.isRightClick?this.options.pointer||"callout"===this.options.displayType?this._DIRECTIONS.pointer:this._DIRECTIONS.menu:t.direction:n?this._DIRECTIONS.submenu:"auto"===this.options.direction||t.isRightClick?this.options.pointer||"callout"===this.options.displayType?this._DIRECTIONS.pointer:this._DIRECTIONS.menu:this.options.direction,t.eventObj=t.event,t.positionAlterable=t.positionAlterable||this.options.positionAlterable,t.positionAlterable=void 0!==t.positionAlterable?t.positionAlterable:n?"flipfit":"auto"===this.options.direction||"after-pointer"===this.options.direction||"at-cursor"===this.options.direction,t.positionAlterable="after-pointer"!==this.options.direction&&"at-cursor"!==this.options.direction&&!t.isRightClick||n?t.positionAlterable:"fit","object"!=typeof t.position){if((this.options.pointer||"callout"===this.options.displayType)&&!n){this._createPointerElement();var c=this;t.arrowCallback=function(e,t){c._arrowDirection=t,e.removeClass("h-top h-bottom h-right h-left").addClass("h-"+t)}}o.data("isRightClick",t.isRightClick),t.withinPadding=8;var _=ZPosition.get(t.isRightClick&&!n?t.event:r,o,i.extend({},{arrow:{element:n?null:this._pointerElement,callback:t.arrowCallback}},t),this._pointerElement?this._pointerElement:void 0);if(t.availableHeight=_.availableHeight,t.position=_.elementPosition,t.position.direction=_.direction,o.data("direction",_.direction),this._pointerElement&&!n)l&&(_.arrowDirection.match(/^top|bottom$/)?_.arrowPosition.left=_.arrowPosition.left-l.left:_.arrowPosition.top=_.arrowPosition.top-l.top),this._pointerElement.css(_.arrowPosition);else if(!this._pointerElement&&!l)if(o.removeClass("zmenu--bottomleft zmenu--bottomright zmenu--topleft zmenu--topright zmenu--top zmenu--bottom zmenu--left zmenu--right"),n)"right-top"===_.direction?(o.addClass("zmenu--bottomleft"),t.position.left=t.position.left-1):"right-bottom"===_.direction?(o.addClass("zmenu--topleft"),t.position.left=t.position.left-1):"left-top"===_.direction?(o.addClass("zmenu--bottomright"),t.position.left=t.position.left+1):"left-bottom"===_.direction&&(o.addClass("zmenu--topright"),t.position.left=t.position.left+1);else{var f=r.length?parseInt(r.css("border-top-left-radius")):0,v=r.length?parseInt(r.css("border-top-right-radius")):0,b=r.length?parseInt(r.css("border-bottom-left-radius")):0,y=r.length?parseInt(r.css("border-bottom-right-radius")):0;5>=f&&5>=v&&5>=b&&5>=y?t.isRightClick?o.removeClass("zmenu--bottomleft zmenu--bottomright zmenu--topleft zmenu--topright zmenu--top zmenu--bottom zmenu--left zmenu--right"):0===_.direction.indexOf("bottom")?("bottom-right"===_.direction?r.outerWidth(!0)<o.width()?(o.addClass("zmenu--topright"),r.css({"border-bottom-left-radius":"0px","border-bottom-right-radius":"0px"})):(o.addClass("zmenu--top"),r.css({"border-bottom-right-radius":"0px"})):"bottom-left"===_.direction&&(r.outerWidth(!0)<o.width()?(o.addClass("zmenu--topleft"),r.css({"border-bottom-left-radius":"0px","border-bottom-right-radius":"0px"})):(o.addClass("zmenu--top"),r.css({"border-bottom-left-radius":"0px"}))),t.position.top=t.position.top-1):0===_.direction.indexOf("top")?("top-right"===_.direction?r.outerWidth(!0)<o.width()?(o.addClass("zmenu--bottomright"),r.css({"border-top-left-radius":"0px","border-top-right-radius":"0px"})):(o.addClass("zmenu--bottom"),r.css({"border-top-right-radius":"0px"})):"top-left"===_.direction&&(r.outerWidth(!0)<o.width()?(o.addClass("zmenu--bottomleft"),r.css({"border-top-left-radius":"0px","border-top-right-radius":"0px"})):(o.addClass("zmenu--bottom"),r.css({"border-top-left-radius":"0px"}))),t.position.top=t.position.top+1):0===_.direction.indexOf("left")?(o.addClass("zmenu--right"),r.css({"border-top-left-radius":"0px","border-bottom-left-radius":"0px"})):0===_.direction.indexOf("right")&&(o.addClass("zmenu--left"),r.css({"border-top-right-radius":"0px","border-bottom-right-radius":"0px"})):t.position.top=t.position.top+2}}if(o.find(".zmenu__textbox").length){o.data("initialDirection",t.position.direction);var z=o.find(".zmenu__search").parent();if(t.position.top<i(r).position().top){o.append(z.addClass("zmenu__footer").removeClass("zmenu__header"));var _=ZPosition.get(t.isRightClick&&!n?t.event:r,o,t,this._pointerElement?this._pointerElement:void 0);t.position=_.elementPosition,t.position.top=t.position.top+1}else o.prepend(z.addClass("zmenu__header").removeClass("zmenu__footer"))}l&&(t.position.top=t.position.top+(parseInt(l.top)||0),t.position.left=t.position.left+(parseInt(l.left)||0))}t.position&&(t.isRightClick&&(t.position.top=t.position.top+2,t.position.left=t.position.left+2),o.css(t.position)),this._fixMenuUI(o,t,n),0===o.find("ul:first .zmenu__item").length&&o.find(".zmenu__footer").length&&o.find(".zmenu__footer").css("border-top","0px"),o.css({display:"block",opacity:""}),this._pointerElement&&this._pointerElement.hide(),this._openWithAnimation(o,t,d)}n||(e.currentMenu&&e.currentMenu.get(0)!=o.get(0)&&(e.prevMenu=e.currentMenu),e.currentMenu=o)},_openWithAnimation:function(e,t,i){var o=this.options.animation;if(t.isSubMenu&&(o=e.data("zmenu").options.animation),o||t&&t.animation){var a=this,n=o?o.open:t.animation.open,r=n.className,s=n.name,l=n.duration?n.duration:0,d=function(){a._handleMenuOpen(e,t,i)};r?(this._pointerElement&&this._pointerElement.show().addClass(r),e.show().addClass(r).on(this.ANIMATION_EVENTS,function(){e.removeClass(r),d&&d(),d=void 0,e.off(a.ANIMATION_EVENTS)})):"object"==typeof s?(this._pointerElement&&this._pointerElement.show().animate(s,l,d),e.show().animate(s,l,d)):this.options.EFFECTS[s]&&(this._pointerElement&&this._pointerElement[this.options.EFFECTS[s].open](l,d),e[this.options.EFFECTS[s].open](l,d))}else e.show(),this._pointerElement&&this._pointerElement.show(),this._handleMenuOpen(e,t,i)},_handleMenuOpen:function(e,t,i){this._resetMenuTextArray(e),!this.options.renderInPlace&&this._triggerEvent(t.isSubMenu?"ONSUBMENUSHOW":"ONSHOW",i,e,void 0,{forElement:t.forElement})},_createPointerElement:function(){return this._pointerElement?this._pointerElement.removeAttr("class").addClass("zmenu__pointer"):(this._pointerElement=i("<div class='zmenu__pointer' />"),void this.element.prepend(this._pointerElement))},_isGridMenu:function(e,t){var i=t?e.closest(".zmenu"):e?e:this.element;if(i.length){var o=this.getMenuType(i);return this._isTypeFloating(o,i)}},_addEventsForMenuItems:function(e){var t=this,i=this.getData(t.element);e.hover(function(o,a){o.data=a;var n=t._isDirectEvent(o),r=function(){t._handleMouseOverOnMenuItems(e,o,void 0,!0)};t._clearMouseHoverTimeout(),n&&t._isToBeDelayed(o)?i.mouseOverTimeout=setTimeout(r,300):r()},function(o,a){o.data=a;var n=t._isDirectEvent(o),r=function(){t._handleMouseOutOnMenuItems(e,o)};n&&(e.data("submenu")||i.mouseOverTimeout)?i.mouseOutTimeout=setTimeout(r,300):r()})},hide:function(e,t,o){if(!this.options.renderInPlace){var a=e&&e.length||this.element.data("parent")&&i(this.element.data("parent")).is(".zmenu__item")&&!o?!0:!1;if(e=e?i(e):this.element,!e.is(":hidden")){var n=this._triggerEvent(a?"ONBEFORESUBMENUHIDE":"ONBEFOREHIDE",o,e);n&&(a||(this._hideAllSubMenus(e),this._destroyRuntimeEvents()),i("li.on-hover",e).each(function(e,t){i(t).is(".zmenu--split")&&i(t).find(".zmenu__icon.h-alignright").removeClass("on-hover"),i(t).removeClass("on-hover")}),e.get(0)!==this.element.get(0)?this.updateLastMenuChain(e.data("parent").parent()):this._lastOverlayedMenuItem=void 0,this._uninitSliders(e),this._closeWithAnimation(e,a,t,o))}}},_closeWithAnimation:function(e,t,i,o){var a=this.options.animation;if(t&&(a=e.data("zmenu").options.animation),a&&a.close){a=a.close;var n=this,r=a.className,s=a.name,l=a.duration?a.duration:0,d=function(){n._handleMenuClose(e,t,i,o)};if(r)e.addClass(r).on(this.ANIMATION_EVENTS,function(){e.removeClass(r),e.hide(),d&&d(),d=void 0,e.off(n.ANIMATION_EVENTS)});else if("object"==typeof s){var n=this;e.animate(s,l,d)}else this.options.EFFECTS[s]&&e[this.options.EFFECTS[s].close](l,d);t&&e.data("parent").closest(".zmenu").data("waitingTime",l)}else{var n=this;e.data("waitingTime")>0?window.setTimeout(function(){e.hide(),n._handleMenuClose(e,t,i,o),e.data("waitingTime",0)},e.data("waitingTime")):(e.hide(),n._handleMenuClose(e,t,i,o))}},_handleMenuClose:function(e,t,o,a){if(t){var n=i(e.data("parent")).closest(".zmenu");this._resetMenuTextArray(n)}else this._resetMenuTextArray(e);e.css({top:"",left:"",height:"",width:""}),e.removeClass("zmenu--bottomleft zmenu--bottomright zmenu--topright zmenu--topleft zmenu--bottom zmenu--top zmenu--left zmenu--right"),i(e.data("forElement")).css({"border-radius":""}),void 0!==e.data("_styleElement")&&e.data("_styleElement").empty(),this._triggerEvent(t?"ONSUBMENUHIDE":"ONHIDE",a,e),o&&o()},_clearMouseHoverTimeout:function(){var e=this.getData(this.element);if(clearTimeout(e.mouseOverTimeout),clearTimeout(e.mouseOutTimeout),void 0!==this.element.data("parent")){var t=this.getData(this.element.data("parent").closest(".zmenu"));clearTimeout(t.mouseOverTimeout),clearTimeout(t.mouseOutTimeout),t.constantLoc=void 0}},_isElementInMenu:function(e,t){return t||(t=this.element),e=i(e)[0],1===t.has(e).length},_isToBeDelayed:function(e){var t=this.getData(this.element);if(void 0!==t.constantLoc){var i={x:e.pageX,y:e.pageY},o=this._slope(i,this.decreasingCorner),a=this._slope(i,this.increasingCorner);if(o<this.prevDecreasingSlope&&a>this.prevIncreasingSlope)return!0}return!1},_scrollToView:function(e){var t=e.closest("ul"),i=e.offset().top-t.offset().top,o=t[0].scrollTop;0>i?o+=i:o<i+o+e.outerHeight(!0)-t.outerHeight()&&(o+=i),t.scrollTop(o)},_handleMouseOverOnMenuItems:function(e,t,i,o,a){if(e.is(".is-disabled")||e.is(".zmenu__title"))return void(this._lastOverlayedMenuItem&&this._lastOverlayedMenuItem.removeClass("on-hover"));if(i&&this._scrollToView(e,e.closest(".zmenu").is("ul")?e.closest(".zmenu"):e.closest(".zmenu").find("ul:first")),e.is(".on-hover")&&this._isMenuOfMenuItemShown(e))return void this._setLastOverlayedMenuItem(e);if(a||o&&this._triggerEvent("ONMENUITEMHOVERED",t,e.closest(".zmenu"),e)){this._checkAndHideAllOpenedSubMenus(e.closest(".zmenu")),this._setLastOverlayedMenuItem(e),this._clearMenuTimeout(),e.addClass("on-hover");var n=t?this._isDirectEvent(t):!1,r=this,s=function(){"click"!==this.getData(e).openOn&&e.data("submenu")&&n?(this._checkAndHideAllOpenedSubMenus(e.closest(".zmenu"),!0),this._showSubmenu(e,{event:t},!1,t)):this.getData(this.element).constantLoc=void 0};e.is(".zmenu--split")?window.setTimeout(function(){e.hasClass("on-hover")&&(e.find(".zmenu__icon.h-alignright").addClass("on-hover"),s.bind(r)())},150):s.bind(this)()}},_showSubmenu:function(e,t,i,o){var a=this;t.forElement||(t.forElement=e);var n=function(){if(e.is(":visible")){var i=a.getSubmenu(e);t.direction=i.data("zmenu").options.submenuDirection?i.data("zmenu").options.submenuDirection:a._DIRECTIONS.submenu,a.show(t,i,!1),a._saveMenuPoints(o,e)}};i?n():a._menuTimeout=setTimeout(n,100)},_clearMenuTimeout:function(){this._menuTimeout&&(clearTimeout(this._menuTimeout),this._menuTimeout=void 0)},_handleMouseOutOnMenuItems:function(e,t){var o=this._isDirectEvent(t);if(o){if(!e.parent().has(t.relatedTarget).length){if(e.data("submenu")&&this._isMenuOfMenuItemShown(e))return;this._setLastOverlayedMenuItem(void 0)}}else{var a=t.data;if((!this._isMenuOfMenuItemShown(e)||!this._isElementInMenu(a,i(this.getSubmenu(e))))&&(this._clearMenuTimeout(),e.removeClass("on-hover"),e.is(".zmenu--split")&&e.find(".zmenu__icon.h-alignright").removeClass("on-hover"),e.data("submenu"))){var n=this.getSubmenu(e);if(!n||"click"===this.getData(e).openOn)return;!this._isElementInMenu(a,i(n))&&i(n).data("parent")&&i(n).data("parent")[0]===e[0]&&this.hide(n)}}},_isMenuOfMenuItemShown:function(e){return e.data("submenu")&&i(this.getSubmenu(e)).is(":visible")},_isDirectEvent:function(e){return!!e.originalEvent},_hideMenuItem:function(e,t){var e="string"==typeof e?i("#"+e,this.element):i(e);e.length&&(e[t?"show":"hide"](),e.attr({hidden:t?!1:!0,"aria-hidden":t?!1:!0}))},_checkMenuItem:function(e,t,i){"radio"===i.itemType?this._handleRadioChecked(e,t,i):"checkbox"===i.itemType&&this._handleCheckboxChecked(e,t,i)},_checkAndHideAllOpenedSubMenus:function(e,t,o){for(var a=e.find("li"),n=0;n<a.length;n++){var r=i(a[n]),s=this.getSubmenu(r),l=s&&"click"==this.getData(r).openOn;s&&s.is(":visible")&&(!l||t)&&(this._checkAndHideAllOpenedSubMenus(s,t,o),s.data("parent")&&"click"===this.getData(s.data("parent")).openOn?e.zmenu("hide",s,o):r.trigger("mouseleave"))}},_setLastOverlayedMenuItem:function(e,t){if(!this._lastOverlayedMenuItem||!e||this._lastOverlayedMenuItem.get(0)!==e.get(0)){if(this._lastOverlayedMenuItem&&e&&e.length&&!this._lastOverlayedMenu.has(e.get(0)).length){var i=e.data("submenu");if(!i||i[0]!==this._lastOverlayedMenu[0]){var o=this._lastOverlayedMenu.data("parent");o&&o.parent().has(e[0]).length&&o.trigger("mouseleave",e)}}if(this._lastOverlayedMenuItem&&!t&&this._lastOverlayedMenuItem.trigger("mouseleave",e),this._lastOverlayedMenuItem=e,e&&e.length){var a=e.closest(".zmenu"),n=this.element;for(this.updateLastMenuChain(a),this.getData(n)._lastOverlayedMenuItem=e;n.data("isSubMenu");){var o=this.getData(n).parent;n=o.closest(".zmenu")}this.getData(n)._lastOverlayedMenuItem=e}}},_fixFloatingMenuWidth:function(e){var t=e.data("zmenu").options,o=(t.type,t.columnCount||t.columns);if(!o||-1===o){var a=e.closest(".zmenu");if(o=a.data("isExternalSubmenu")?this.getData(a).columns?this.getData(a).columns:this.getData(a).columnCount:this.options.columns,!o||-1===o)return}for(var n,r=this._getAllMenuItems(e,!1,!1,!0),s=(i(r[0]).outerWidth(!0),0),l=0;o>l&&l<r.length;l++)n=window.getComputedStyle(r[l]),s+=Math.round(parseFloat(n.width))+Math.round(parseFloat(n.marginLeft))+Math.round(parseFloat(n.marginRight));e.width(s),(e.data("height")<=e.outerHeight()||e.hasClass("h-scroll_y")||e.find(".h-scroll_y").length)&&(s+=this.scrollWidth,e.width(s)),e.data("width",s),this.getData(e).search&&e.data("container").width(s).find("input").width(s)},getItemCount:function(){return i(this.element).children(".zmenu__item").length},removeMenuItems:function(e){var t,o=this;if(e)for(var a=0;a<e.length;a++)t=i(e[a],this.element),t.length&&o.removeMenuItem(t);else this.element.empty(),this.element.is("div")&&(this._pointerElement&&this.element.append(this._pointerElement),this.element.append(i("<ul class='zmenu__list'>")))},removeMenuItem:function(e){if(e=i(e,this.element),e.length){var t=e.attr("name");e.remove();var o=t?this.element.find("#"+t+".zmenu__title"):void 0;if(o&&o.length){var a=this.element.find("li[name="+t+"]:not(.zmenu__title)");a.length||o.remove()}this.element.find(".zmenu__footer")&&!this.element.find(".zmenu__footer li").length&&this.element.find(".zmenu__footer").remove(),this._fixMenuUI(this.element),this._resetMenuTextArray(this.element)}},getMenuItemAt:function(e,t,i){return t=t?t:this.element,i?this._getMenuItemAsObject(t.find(".zmenu__item:eq("+e+")")):t.find(".zmenu__item:eq("+e+")")},_getMenuItemAsObject:function(e){var t={},o=this.getData(e),a=this;i(this._attrNames).each(function(i,a){var n=e.attr(a)||o[a];void 0!==n&&(t[a]=n)});for(var n in o)-1===i.inArray(n,a._attrNames)&&"menuItems"!==n&&void 0!==o[n]&&(t[n]=o[n]);if("custom"==t.itemType||t.custom?t.innerHTML=e[0].innerHTML:void 0===t.label&&(t.label=e.find(".zmenu__text").length&&e.find(".zmenu__text").text()),t.text=void 0,e.data("submenu")){var r=this.getSubmenu(e);r&&(t.menuItems=this._getMenuAsObject(r))}return t},_getMenuAsObject:function(e){e=e?e:this.element;var t=this,o=[],a=e.find("li");return a.each(function(e,a){o.push(t._getMenuItemAsObject(i(a)))}),o},addMenuItems:function(e,t,i){for(var o=[],a=this,n=Object.create(e),r=void 0,s=n.length,l=0;s>l;l++)r=a.addMenuItem(n[l],t,!0,i),o.push(r);return i&&this.element.find("ul.zmenu__list:first").append(o),(this.element.is(":visible")||this.options.renderInPlace)&&(this._fixMenuUI(this.element),this._resetMenuTextArray(this.element)),o},addMenuItem:function(t,o,a,r){var s=void 0,l=i(this.element);"object"==typeof t&&(t=Object.create(t)),t.menu&&t.menu.length&&"object"==typeof t.menu&&(l="UL"===!i(t.menu)[0].tagName?i(t.menu).children("ul"):t.menu);var d="UL"===l[0].tagName?!1:!0;if(s=n?this._menuItemUsingTemplate(l,t,o):i(this._menuItemUsingElementCreation(l,t,o)),!r){var c=l[0].querySelectorAll("li");if("undefined"!=typeof t.index&&c.length){var h=!1;t.index>=c.length&&(t.index=c.length-1,h=!0),t.index<0&&(t.index=0),s[h?"insertAfter":"insertBefore"](i(c[t.index]))}else d?l[0].querySelector("ul").appendChild(s[0]):l[0].appendChild(s[0])}"object"!=typeof t.menuItems&&o&&"separator"!==t.mtype&&o(s,t);var u=void 0;for(var m in this._attrNames)u=this._attrNames[m],t[u]&&s[0].setAttribute(u,t[u]+"");var p=this.getData(s);for(var m in t)-1===i.inArray(m,this._attrNames)&&"menuItems"!==m&&"action"!==m&&t[m]&&(p[m]=t[m]);if(t.action&&"string"==typeof t.action&&-1!==t.action.indexOf("URL:")&&(p.action=t.action),t.checked&&(s.data("checked",t.checked),s.attr({"data-checked":t.checked,"aria-checked":t.checked})),t.hidden&&s.attr({"data-hidden":t.hidden,"aria-hidden":t.hidden}),t.disabled&&s.attr({"data-disabled":t.disabled,"aria-disabled":t.disabled}),t.customAttributes){if(t.customAttributes.data){var g=t.customAttributes.data;"string"==typeof g&&(g=JSON.parse(g)),g.appData&&(this.getData(s).appData=g.appData)}s.attr(t.customAttributes)}if(t.internal||n){if(s.attr("role",this.ARIA_ROLES[t.itemType?t.itemType:"default"]),t.innerHTML){var _=t.innerHTML.content,f=t.innerHTML.replaceArray;if(_&&f){for(var m=0;m<f.length;m++)_=_.replace("{"+m+"}",e.encodeHTML(f[m]));s.html(_)}else this.options.isCustomHTMLEncoded||this.options.htmlSafe?s.append(p.innerHTML):s.html(e.encodeHTML(p.innerHTML));t.hasSubmenu&&this._createArrowIcon(s)}this._handleCheckedandDisabled(s,t)}else this._buildMenuItem(s,l);var v=t.itemValue;v&&s.data("itemValue",v);var b=t.splitButtonData;b&&s.data("relatedButton",b),this.getData(s).action=t.action,(t.fixed||t.isFooter)&&this._addFixedItem(s,l,p),a||this._fixMenuUI(l);var y=t.className?t.className:t.itemCssClass?t.itemCssClass:"";return t.isFooter?null:s.addClass(y)},_menuItemUsingTemplate:function(e,t,o){if(t.listClass="itemgroup"===t.itemType?"zmenu__title":"zmenu__item",t.icon=t.SVGIconId?t.SVGIconId:t.iconClassName?t.iconClassName:t.icon,t.icon&&-1!==t.icon.indexOf("#")&&(t.svgId=t.icon.split(" ")[0],t.svgClass=t.icon.slice(t.svgId.length).trim()),t.isGrid=this._isGridMenu(e),t.isSeparator="separator"===t.itemType?!0:!1,t.isCustom="custom"===t.itemType||t.custom?!0:!1,"splitmenu"===t.itemType&&(t.listClass+=" zmenu--split"),"string"==typeof t.menuId)t.hasSubmenu=!0,t.submenuId=t.menuId.substr(1);else if(t.menuItems&&t.menuItems.length){t.submenuId=t.id+"submenu",t.submenu=i("<ul>").attr("id",t.submenuId),t.hasSubmenu=!0,t.contentType=t.contentType?t.contentType:"text",this.getData(t.submenu).contentType=t.contentType;var n=this;i(t.menuItems).each(function(e,i){i.menu=t.submenu,i.internal=!0,n.addMenuItem(i,o,void 0)}),t.submenu.addClass("zmenu "+this._MENU_CONTENT_TYPES[t.contentType?t.contentType:"text"]).zmenu({usingJSON:!0}),i("body").append(t.submenu)}var r=e.data("zmenu")?e.data("zmenu").options.contentType:this.getData(e).contentType;t["icon"===r?"icon-only":r]=r;var s=i(a(t));if(t.isGroup?s.append(t.submenu):t.menuItems&&t.menuItems.length&&(s.attr("data-menu-id",t.submenuId),t.submenu.data("parent",s)),t.label&&s.attr("data-label",t.label),t.disabled&&s.attr("data-disabled",t.disabled),t.hidden&&s.attr("data-hidden",t.hidden),this.getData(s).parentMenu=e,t.icon&&0===t.icon.indexOf("text:")&&"text"!==this.options.contentType&&s.find("i:first").removeClass(t.icon).text(t.icon.replace("text:","")),s.is(".zmenu__separator")||s.is(".zmenu__title")||this._addEventsForMenuItems(s),t.action&&"string"==typeof t.action&&-1!==t.action.indexOf("URL:")){var l=s.html();t.target=t.target?t.target:"_blank",s.empty().addClass("zmenu--withlink").append(i("<a class='zmenu__link' href='"+t.action.replace("URL:","")+"' target='"+t.target+"'></a>")),s.find(".zmenu__link").append(l),"_blank"===t.target&&s.find(".zmenu__link").attr("rel","noopener noreferrer")}return t.hasSubmenu&&s.data("submenu",t.submenu?t.submenu:i(t.submenuId)),s},_menuItemUsingElementCreation:function(e,t,o){var a=document.createElement("li");if(t.itemType&&a.setAttribute("data-item-type",t.itemType),t.name&&a.setAttribute("name",t.name),"object"==typeof t.menuItems){var n=t.className?t.className:t.menuClass?t.menuClass:"",r=i("<ul>").attr({id:t.id+"submenu","class":n}),s=this;a.appendChild(r[0]),r.data("usingJSON",!0),this.getData(r).appendTo=t.appendTo?t.appendTo:this.options.appendTo,this.getData(r).contentType=t.contentType?t.contentType:this.getData(e).contentType,i(t.menuItems).each(function(e,t){t.menu=r,s.addMenuItem(t,o,void 0)})}return a},destroy:function(e){var e=e?e:this.element;if(this._clearMenuTimeout(),this._uninitSliders(e),this.hide(),e.data("usingJSON")||this.options.usingJSON){for(var t=e.find(".zmenu--submenu"),o=0;o<t.length;o++)i(t[o]).data("submenu").zmenu("destroy"),i(t[o]).data("submenu").remove();e.empty()}var a=this.componentName;e.off("mouseup."+a+" keydown.run."+a).removeClass("zmenu zmenu--thumbnail "+this._MENU_CONTENT_TYPES[this.options.contentType]+" "+this.options.menuClass+" "+this.options.className).removeData("zmenu").data("initialized",!1),e.find(".h-scroll_y").removeClass("h-scroll_y"),e.find(".zmenu__pointer").length&&(e.find(".zmenu__pointer").remove(),this._pointerElement=void 0);for(var n=e.find("li"),o=0;o<n.length;o++){var r=n[o],s=this.getData(n[o]),l=i(r).find(".zmenu__text").text()||s.label,d=i(r).is(".is-fixed");i(r).removeData("metadata").empty().removeClass("zmenu__item zmenu__title zmenu__custom zmenu__separator is-disabled is-fixed is-selected").empty().removeAttr("data-label").off("mouseenter mouseleave"),i(r).text(l),d&&i(r).appendTo(e.find("ul:first"))}e.find(".zmenu__header,.zmenu__footer").remove(),e.removeData("fixedArea width height"),this._menuTextArray=[]},updateLastMenuChain:function(e,t){if(this._lastOverlayedMenu=e,!t&&e[0]!==this.element[0]){var i=this._traverseAndFindBaseMenu();i.zmenu("updateLastMenuChain",e,!0)}},_traverseAndFindBaseMenu:function(e){var t=e;if(e=e?e:this.element,e.data("parent"))for(var i=e.data("parent");i;){var t=i.closest(".zmenu");t.is(":visible")?(e=t,i=e.data("parent")):i=!1}return e.closest(".zmenu")},selectHoveredMenuItem:function(){var e=this._lastOverlayedMenuItem;return e&&i(e).trigger("mouseup"),e?e:!1},hoverMenuItem:function(e){return e=i(e),e.length?void this._handleMouseOverOnMenuItems(i(e),{},!0,!1,!0):(this._lastOverlayedMenuItem&&this._lastOverlayedMenuItem.removeClass("on-hover"),void(this._lastOverlayedMenuItem=void 0))},_getAllMenuItems:function(e,t,i,o,a){return e&&e.length||(e=this.element),e.find(".zmenu__item:not([itemType=group], .zc-splitmenu-list-rht"+(a?", .zmenu__separator":"")+(t?", .zmenu--thumbnail":"")+(i?", li ul[mtype=submenu] li":"")+")"+(o?":visible":""))},_handleCheckboxChecked:function(e,t,i){if(this._isGridMenu(e,!0))e[t?"addClass":"removeClass"]("is-selected");else if((i.icon||i.iconClassName||i.SVGIconId)&&"text"!==this.options.contentType)e[t?"addClass":"removeClass"]("is-selected");else{var o=e.find("i:first");if(o.length)if(this.options.checkedCheckboxItemIconClassName&&o.removeClass(this.options.checkedCheckboxItemIconClassName),t){var a={props:{"class":"zmenu__tick",viewBox:"-2 -2 20 20",width:"100%",height:"100%"},nodes:[{polygon:{points:"14.6,2.4 4.9,12.1 1.2,8.5 0.4,9.3 4.9,13.8 15.4,3.2"}}]};this._handleIcon(o,a,"checkedcheckbox",this.options.checkedCheckboxItemIconClassName,this.options.checkedCheckboxItemSVGIconId)}else o.find("svg").remove()}e.prop("checked",t).attr({checked:t,"aria-checked":t})},_handleRadioChecked:function(e,t,o){var a=i(e).attr("name"),n=e.closest("ul"),r=this,s=void 0,l=n.find("li[role=menuitemradio][name="+a+"]");t&&(l=l.filter(function(){return i(this).prop("checked")}),l.each(function(e,t){t=i(t),s=r.getData(t),r._fixRadioIcon(t,!1,s)})),r._fixRadioIcon(e,t,o)},_fixRadioIcon:function(e,t,i){var o=this._isGridMenu(e,!0);if(o)e[t?"addClass":"removeClass"]("is-selected");else if(i.icon||i.iconClassName||i.SVGIconId)e[t?"addClass":"removeClass"]("is-selected");else{var a=e.find("i:first");if(a.length)if(this.options.checkedRadioItemIconClassName&&a.removeClass(this.options.checkedRadioItemIconClassName),t){var n={props:{"class":"zmenu__radio",viewBox:"-7 -7 64 64",width:"100%",height:"100%"},nodes:[{circle:{cx:"24.5",cy:"24.5",r:"15.5"}}]};this._handleIcon(a,n,"checkedradio",this.options.checkedRadioItemIconClassName,this.options.checkedRadioItemSVGIconId)}else a.find("svg").remove()}e.prop("checked",t).attr({checked:t,"aria-checked":t})},_initRuntimeEvents:function(){var t=this,o=this.componentName;this.element.off("keydown.run."+o).on("keydown.run."+o,function(o){t.handleKeyCode(o.keyCode,o,void 0),(i(o.target).closest(".zmenu__header").length||o.ctrlKey||o.metaKey||o.shiftKey||o.altKey)&&o.keyCode!==e.keyCode.UP&&o.keyCode!==e.keyCode.DOWN&&o.keyCode!==e.keyCode.LEFT&&o.keyCode!==e.keyCode.RIGHT||(o.preventDefault(),o.stopPropagation())})},handleKeyCode:function(t,o,a){var n=this._isGridMenu();switch(o=o?o:{},t){case e.keyCode.UP:if(o.altKey||o.ctrlKey||o.metaKey){var r=this._lastOverlayedMenu.find("li:visible:not('.zmenu__title,.is-disabled'):first");this.hoverMenuItem(r,!0)}else{var s=this._getNextMenuItem(!0);s.length&&(this._scrollToView(s,s.closest(".zmenu").is("ul")?s.closest(".zmenu"):s.closest(".zmenu").find("ul:first")),s.trigger("mouseover"))}break;case e.keyCode.DOWN:if(o.altKey||o.ctrlKey||o.metaKey){var r=this._lastOverlayedMenu.find("li:visible:not('.zmenu__title,.is-disabled'):last");this.hoverMenuItem(r,!0)}else{var s=this._getNextMenuItem();s.length&&(this._scrollToView(s,s.closest(".zmenu").is("ul")?s.closest(".zmenu"):s.closest(".zmenu").find("ul:first")),s.trigger("mouseover"))}break;case e.keyCode.RIGHT:if(void 0!==this._lastOverlayedMenuItem){var l=this.getSubmenu(this._lastOverlayedMenuItem),d=this._lastOverlayedMenuItem.closest(".zmenu");if((n||!l.length&&d.hasClass("zmenu--thumbnail"))&&!a){var c=void 0,r=this._getNextMenuItem(c,c,c,t);this._scrollToView(r,r.closest(".zmenu").is("ul")?r.closest(".zmenu"):r.closest(".zmenu").find("ul:first")),r.trigger("mouseover");break}if(this._lastOverlayedMenuItem.is(".is-disabled"))return;if(l&&l.length){var d=this.getSubmenu(this._lastOverlayedMenuItem);if(!d)return;this.show({forElement:this._lastOverlayedMenuItem,event:o},d),this._lastOverlayedMenuItem=void 0,this._getNextMenuItem(!1,!0).trigger("mouseover")}}else n&&this._lastOverlayedMenu.find("li:not('.zmenu__title,.is-disabled'):not(':hidden'):first").trigger("mouseover");break;case e.keyCode.LEFT:if(void 0!==this._lastOverlayedMenuItem){d=this._lastOverlayedMenuItem.closest(".zmenu");var h=this._lastOverlayedMenu.data("parent"),u=h&&this._isMenuOfMenuItemShown(h),m=d.find(":visible.zmenu__item").not(".zmenu__separator,.is-disabled,.zmenu__title").filter(":first"),p=m[0]==this._lastOverlayedMenuItem[0],g=this._isGridMenu(d);if(!(!g||p||u&&p)){var r=this._getNextMenuItem(!0,void 0,void 0,t);this._scrollToView(r,r.closest(".zmenu").is("ul")?r.closest(".zmenu"):r.closest(".zmenu").find("ul:first")),r.trigger("mouseover");break}this._isMenuMainMenu(this._lastOverlayedMenu)||this._hideLastShownMenu()}else n&&this._lastOverlayedMenu.find("li:not('.zmenu__title,.is-disabled'):not(':hidden'):last").trigger("mouseover");break;case e.keyCode.ESCAPE:this.options.renderInPlace||(this._isMenuMainMenu(this._lastOverlayedMenu)?this.hide():this._hideLastShownMenu());break;case e.keyCode.ENTER:case e.keyCode.SPACE:this._lastOverlayedMenuItem&&this._lastOverlayedMenuItem.data("submenu")&&!this._lastOverlayedMenuItem.hasClass("zmenu--split")?this.handleKeyCode(e.keyCode.RIGHT,o,!0):this._lastOverlayedMenuItem?this._lastOverlayedMenuItem.is(".zmenu--withlink")?i(this._lastOverlayedMenuItem).find(".zmenu__link")[0].click():(o.target=i(this._lastOverlayedMenuItem),this._handleMenuItemClick(o,this._lastOverlayedMenuItem.closest(".zmenu"))):this.hide();break;case e.keyCode.PAGE_UP:var r=this._lastOverlayedMenu.find("li:not('.zmenu__title,.is-disabled'):first");this.hoverMenuItem(r,!0);break;case e.keyCode.PAGE_DOWN:var r=this._lastOverlayedMenu.find("li:not('.zmenu__title,.is-disabled'):last");this.hoverMenuItem(r,!0);break;default:var _=String.fromCharCode(t);this._menuTextArray.length&&this.options.handleAccessKeyNavigation&&this._callMenuitemSearch(_,(new Date).getTime())}var f=this.element.find(".on-hover"),v=f.length?f.data("submenu")&&f.data("submenu").length:!1;o&&"keydown"===o.type&&!v&&this._triggerEvent("KEYDOWN",o,this.element)},_isDisabled:function(e){var t=e.attr("disabled")?e.attr("disabled"):!1;return t},_isMenuMainMenu:function(e){return i(e).get(0)===this.element.get(0)},_getNextFloatingMenuItem:function(e,t,o,a,n){var r=void 0,s=a?"top":"left",l=t.length;return i.each(t,function(o,a){a=t[n?l-o-1:o];var d=i(a).position();return d[s]===e[s]?(r=i(a),!1):"top"===s?(r=i(a),!1):void 0}),r},_hideLastShownMenu:function(){var e=this._lastOverlayedMenu.data("parent");this._lastOverlayedMenuItem=e,this.hide(this._lastOverlayedMenu);var t=e.closest(".zmenu");this.updateLastMenuChain(t),this.getData(this.element)._lastOverlayedMenuItem=e},_resetMenuTextArray:function(e){this._menuTextArray=[],this._prevSearchKey="",this._prevKeydownTime="",this._prevSearchIndex="",this._prevSearchTimer=void 0;var t=".zmenu__item:visible:not(.zmenu__title,.is-disabled,.zmenu__separator)";this.options.renderInPlace&&(t=".zmenu__item:not(.zmenu__title,.is-disabled,.zmenu__separator)");for(var o=e.find(t),a=0;a<o.length;a++)this._menuTextArray[this._menuTextArray.length]={text:i(o[a]).find(".zmenu__text").text()||"",menuitem:i(o[a])}},_callMenuitemSearch:function(e,t){var i=!1;""!==this._prevKeydownTime&&t-this._prevKeydownTime>700?(i=this._prevSearchKey==e?!0:!1,this._prevSearchKey=e):this._prevSearchKey=this._prevSearchKey+e,this._prevKeydownTime=t,this._menuitemSearch(i)},_menuitemSearch:function(e){var t=new RegExp("^"+this._prevSearchKey.replace(/[|()\[{.+*?$\\]/g,"\\$0"),"i"),o=e&&this._prevSearchIndex<this._menuTextArray.length?this._prevSearchIndex+1:0;o=o>0&&o<this._menuTextArray.length?o:0;for(var a=o;a<this._menuTextArray.length;a++)if(this._menuTextArray[a].text.match(t)){this._prevSearchIndex=a;for(var n=!1,r=a+1;r<this._menuTextArray.length;r++)this._menuTextArray[r].text.match(t)&&(n=!0);return n||(this._prevSearchIndex=-1),void this._handleMouseOverOnMenuItems(i(this._menuTextArray[a].menuitem),{},!0,!0)}},_getNextMenuItem:function(t,o,a,n){var r=this._lastOverlayedMenu&&0!==this._lastOverlayedMenu.length?this._lastOverlayedMenu:this.element,s=this._isGridMenu(r),l=void 0,d=r.is("ul")?r:r.find("ul:first");if(a=void 0!==a?a:this._lastOverlayedMenuItem,a&&a.length){if(l=a[t?"prevAll":"nextAll"](".zmenu__item:visible").not(".zmenu__separator,.is-disabled,.zmenu__title"),s){var c=a.position(),h=n===e.keyCode.LEFT||n===e.keyCode.RIGHT;l=this._getNextFloatingMenuItem(c,l,t,h),l||r.find(".zmenu__footer").length&&h||(l=a[t?"nextAll":"prevAll"](".zmenu__item:not(.zmenu__separator,.is-disabled,.zmenu__title):visible"),c[h?"left":"top"]=0,l=this._getNextFloatingMenuItem(c,l,t,h,!0))}else l=i(l[0]);l&&l.length||(r.find(".zmenu__footer").length?a.closest(".zmenu__footer").length?a[0]===r.find(".zmenu__footer").find(".zmenu__item:visible").first()[0]?(a.removeClass("on-hover"),l=this._getNextMenuItem(t,o,!1)):l=this._getNextMenuItem(t,o,!1):l=r.find(".zmenu__footer").find(".zmenu__item:visible")[t?"last":"first"]():l=this._getNextMenuItem(t,o,!1))}else l=r.find(".zmenu__footer").length&&!this._lastOverlayedMenuItem?r.find(".zmenu__item:visible:not(.zmenu__title,.is-disabled,.zmenu__separator):"+(t?"last":"first")):d.find(".zmenu__item:visible:not(.zmenu__title,.is-disabled,.zmenu__separator):"+(t?"last":"first"));return this._setLastOverlayedMenuItem(l,o),this._lastOverlayedMenuItem},_setFocus:function(){var e=this,t=function(){e.element.focus(),e.element.find(".zmenu__textbox").length&&e.element.find(".zmenu__textbox").focus()};this._triggerEvent("ONBEFOREFOCUS",{},this.element)&&setTimeout(t,100)},refresh:function(e){e=e?e:this.element,this._fixMenuItemsWidth(e)},_fixMenuItemsWidth:function(e,t){return e?(t=t?t:this.getMenuType(e),this._isTypeFloating(t)?this._fixFloatingMenuWidth(e):void 0):void 0},getMenuType:function(e){if(e&&e.data("isExternalSubmenu"))return e.zmenu("getMenuType");e=e?e:this.element;var t=this._getMenuTypeFromData(e);return t||(t=this.options.type),t},_getMenuTypeFromData:function(e){var t=this.getData(e);return t.componentOptions?t.componentOptions.type:t.type},_isTypeFloating:function(e,t){return e&&"grid"===e||t&&t.hasClass("zmenu--thumbnail")?!0:!1},_fixMenuUI:function(e,t){e.is(":visible")&&this._fixMenuHeight(e,t)},_fixMenuHeight:function(t,o){var a="auto",n=t.is("ul")?void 0:t.find("ul:first");t.height(a),n&&n.height(a),t.removeClass("h-scroll_y");var r="auto"===this.options.direction||"after-pointer"===this.options.direction||"at-cursor"===this.options.direction,s=t.outerHeight(),l=1*t.css("top").split("px")[0]-i(window).scrollTop(),d=e.windowObject?e.windowObject.height:i(window).height(),c=t.data("direction"),h=(c&&0===c.indexOf("bottom")||c&&0===c.indexOf("top"))&&o&&!o.isRightClick?o.availableHeight:d,u=h-s,l=l?l:0;if(o&&o.isRightClick&&(l=parseInt(l)+2),(l+s>=h&&0>u||!r)&&(a=o&&o.availableHeight&&!o.isRightClick?o.availableHeight:d-l),t.data("height")?a=o&&o.availableHeight&&parseInt(t.data("height"))>=o.availableHeight?o.availableHeight:parseInt(t.data("height")):u>0&&r&&(a=s),this.scrollWidth,this.getData(t),s>a)if(t.outerHeight(a),n){var m=t.find(".zmenu__header").length?parseInt(t.find(".zmenu__header").outerHeight(!0))+parseInt(t.find(".zmenu__header").css("margin-top"))+parseInt(t.find(".zmenu__header").css("margin-bottom"))+parseInt(t.css("padding-top")):parseInt(t.css("padding-top")),p=t.find(".zmenu__footer").length?parseInt(t.find(".zmenu__footer").outerHeight(!0))+parseInt(t.find(".zmenu__footer").css("margin-top"))+parseInt(t.find(".zmenu__footer").css("margin-bottom")):parseInt(t.css("padding-bottom")),g=t.find(".zmenu__pointer").length?parseInt(t.find(".zmenu__pointer").outerHeight(!0)):0,_=m+(t.find(".zmenu__footer").length>1?t.find(".zmenu__footer").length*p:p)+g;n.innerHeight(a-_),"slider"===this.options.scroll?(this._initSliders(t),n.addClass("h-overflowhidden")):n.addClass("h-scroll_y"),"slider"===this.options.scroll&&this._initSliders(t),0!==_&&t.outerHeight(a)}else"slider"===this.options.scroll?(this._uninitSliders(t),this._initSliders(t),t.addClass("h-overflowhidden")):(this._uninitSliders(t),t.addClass("h-scroll_y"));else t.removeClass("h-scroll_y")},_findScrollWidth:function(){var e=document.createElement("div"),t="width:100px;height:100px;overflow:scroll;";document.querySelector("body").appendChild(e),e.style.cssText=t;var o=i(e).width()-e.scrollWidth;return document.querySelector("body").removeChild(e),o},_initSliders:function(e){this._createSlider(e),this._createSlider(e,!0)},_uninitSliders:function(e){e=e.is("div")?e.find("ul:first"):e;var t=this.getData(e);t&&t.sliders&&(t.sliders.top&&t.sliders.top.remove(),t.sliders.down&&t.sliders.down.remove(),t.sliders=null),e.off("mousewheel")},_createSlider:function(e,t){e=e.is("div")?e.find("ul:first"):e;var o=t?"top":"down",a=this.getData(e),n=this;a.sliders||(a.sliders={});var r=a.sliders[o];r&&r.remove(),r=i("<div>").addClass("zmenu--scroller zmenu--scroller"+o),a.sliders[o]=r;var n=this;r.hover(function(){n._startScrolling(e,t)},function(){n._stopScrolling(e)}).hide(),r.click(function(){var i=e.scrollTop();return n._stopScrolling(e),e.scrollTop(i+(t?-1:1)),n._startScrolling(e,t),!1});var s=this.componentName;e.off("mousewheel."+s).on("mousewheel."+s,function(t){var i=e.scrollTop();e.scrollTop(t.originalEvent.wheelDelta>0?i-6:i+6),n._displayScrollElements(e),t.stopPropagation(),t.preventDefault()});var l=e.width();r.css({width:l}),t||r.show();var d=i('<i class="zmenu__icon"></i>'),c=void 0;if(c="top"===o?{props:{viewBox:"-3 -3 22 22",width:"100%",height:"100%"},nodes:[{path:{d:"M0,12l8-8l8,8H0z"}}]}:{props:{viewBox:"-3 -3 22 22",width:"100%",height:"100%"},nodes:[{path:{d:"M16,4l-8,8L0,4H16z"}}]},this._handleIcon(d,c,t?"topscroller":"bottomscroller",t?this.options.scrollUpArrowIconClassName:this.options.scrollDownArrowIconClassName,t?this.options.scrollUpArrowSVGIconId:this.options.scrollDownArrowSVGIconId),i(d).appendTo(r),e.hasClass("zmenu__list")){r.appendTo(e.parent());var h=e.height()-r.outerHeight(!0)+parseInt(e.parent().css("padding-top"));e.parent().find(".zmenu__footer").length?h+=parseInt(e.parent().find(".zmenu__footer").css("margin-top")):h=this._pointerElement?h+Math.ceil(this._pointerElement.outerHeight(!0)/2)+parseInt(e.parent().css("border-bottom-width")):h-parseInt(e.parent().css("border-bottom-width"))-parseInt(e.parent().css("border-top-width")),r.css({left:"0px",top:t?"0px":h})}else{r.insertAfter(e);var u=e.position(),m=t?1:e.outerHeight()-r.outerHeight(!0)-1;r.css({top:u.top+m,left:u.left+1})}return r},_displayScrollElements:function(e){var t=(e.hasClass("zmenu")?!1:!0,this.getData(e).sliders),i=e.scrollTop();t.top[0===i?"hide":"show"](),t.down[e[0].scrollHeight-i<=e.outerHeight()?"hide":"show"]()},_startScrolling:function(e,t){var i=t?0:e[0].scrollHeight-e.innerHeight(),o=this,a=e.scrollTop()-i,n=Math.abs(1e3*a/50);e.animate({scrollTop:i},{duration:n,easing:"linear",complete:function(){o._displayScrollElements(e)}})},_stopScrolling:function(e){e.stop(),this._displayScrollElements(e)},_hideAllSubMenus:function(e,t){var e=this._traverseAndFindBaseMenu(e);e[0]!=this.element[0]?e.zmenu("hide",void 0,t):this._checkAndHideAllOpenedSubMenus(e,!0,t)},_destroyRuntimeEvents:function(){i(this.element).off(".run."+this.componentName)},_triggerEvent:function(e,t,o,a,n){t=t?t:{},a=a?a:i(t.target).closest(".zmenu__item");var r=!o||o.get(0)==this.element.get(0),s={originalEvent:t,target:o.data("forElement"),forElement:o.data("forElement"),offset:o.offset(),menu:o,isBaseMenu:r,menuitem:a,data:a.length?this._getMenuItemAsObject(a):void 0,itemValue:a.length&&a.data("itemValue")};if(n&&(s=i.extend({},s,n)),o.data("parent")&&-1!==e.indexOf("SUBMENU")){o.zmenu("triggerEvent",e.replace("SUBMENU",""),t,s);var l=o.data("parent").closest(".zmenu");return l.zmenu("triggerEvent",e,t,s)}return this._dispatchEvent(e,t,s,o)},triggerEvent:function(e,t,i){return this._dispatchEvent(e,t,i)},_slope:function(e,t){return(t.y-e.y)/(t.x-e.x)},_saveMenuPoints:function(e,t){var i=this.getData(this.element),o=this._lastOverlayedMenu,a=this.element.offset(),n=o.offset();if(i.constantLoc={x:a.left,y:a.top+t.position().top},a.left>=n.left){var r={x:n.left+o.outerWidth(),y:n.top},s={x:n.left+o.outerWidth(),y:n.top+o.outerHeight()};this.increasingCorner=r,this.decreasingCorner=s}else{var l={x:n.left,y:n.top},d={x:n.left,y:n.top+o.outerHeight()};this.decreasingCorner=l,this.increasingCorner=d}this.prevDecreasingSlope=this._slope(i.constantLoc,this.decreasingCorner),this.prevIncreasingSlope=this._slope(i.constantLoc,this.increasingCorner)},setAttribute:function(e,t){if("height"===e&&this.options.height!==t)this.options.height=parseInt(t),this.element.data("height",parseInt(t)),this._fixMenuHeight(this.element,{});else if("width"===e&&this.options.width!==t)this.options.width=parseInt(t),this.element.data("width",parseInt(t)).width(this.options.width);else if("contentType"===e&&this.options.contentType!==t){"grid"!==this.options.type&&this.element.removeClass(this._MENU_CONTENT_TYPES[this.options.contentType]).addClass(this._MENU_CONTENT_TYPES[t]),this.options.contentType=t;var o=this._getMenuAsObject(this.element);this.element.is("ul")?this.element.empty():this.element.find("ul").empty(),this.addMenuItems(o)}else if("type"===e&&this.options.type!==t)this.element.zmenu("destroy"),this.options.type=t,this.element.zmenu(this.options);else if("search"===e&&this.options.search!==t){if(t)this._createSearchContainer(this.element);else{var a=this.element.find(".zmenu__textbox").parent().attr("class");this.element.find("."+a).remove()}this._fixMenuHeight(this.element,{})}else if("pointer"!==e&&"displayType"!==e||this.options.pointer===t)if("renderInPlace"===e&&this.options.renderInPlace!==t)t||this.element.css({position:"absolute",width:"auto",height:"auto"});else if("menuClass"!==e&&"className"!==e||this.options.menuClass===t&&this.options.className===t){if("handleAccessKeyNavigation"===e&&this.options.handleAccessKeyNavigation!==t)t?this._initRuntimeEvents():this._destroyRuntimeEvents();else if("appendTo"===e)void 0!==t&&i(t).length?this.element.appendTo(i(t)):i("body").append(this.element);else if("checkedCheckboxItemSVGIconId"===e||"checkedCheckboxItemIconClassName"===e||"checkedRadioItemSVGIconId"===e||"checkedRadioItemIconClassName"===e){this.options[e]=t;for(var n,r=this.element.find("li"),s=r.length,l=0;s>l;l++)n=i(r[l]),this._checkMenuItem(n,n.prop("checked"),this.getData(n))}}else this.element.removeClass(this.options.menuClass).addClass(t),this.element.removeClass(this.options.className).addClass(t);else t&&"box"!==t?this._createPointerElement():(this._pointerElement.remove(),this._pointerElement=void 0);this.options[e]=t},checkMenuItems:function(e){e=e?e:this.element.find("[role=menuitemcheckbox],[role=menuitemradio]"),this.setMenuItemsAttribute(e,"checked",!0)},uncheckMenuItems:function(e){e=e?e:this.element.find("[role=menuitemcheckbox],[role=menuitemradio]"),this.setMenuItemsAttribute(e,"checked",!1)},hideMenuItems:function(e){e=e?e:this.element.find("li").filter(function(){return"none"!==i(this).css("display")}),this.setMenuItemsAttribute(e,"hidden",!0)},showMenuItems:function(e){e=e?e:this.element.find("li:not(li[data-hidden=true])"),this.setMenuItemsAttribute(e,"hidden",!1)},setMenuItemsAttribute:function(e,t,o){var a=this;i.each(e,function(e,n){if(n=i(n,a.element),n.length){var r=a.getData(n);if("itemgroup"===r.itemType){var s=i("[name="+n.attr("name")+"]:not(.zmenu__title)",a.element);s.length&&a.setMenuItemsAttribute(s,t,o)}if("icon"!==t&&"iconClassName"!==t&&"SVGIconId"!==t||r[t]===o)"label"===t&&r.label!==o?(r.ellipsis&&(o+="..."),n.find(".zmenu__text").text(o)):"shortcutkey"!==t&&"shortcutKey"!==t||r.shortcutkey===o&&r.shortcutKey===o?"hint"===t||"description"===t&&(r.hint!==o||r.description!==o)?r.hint||r.description?n.find(".zmenu__hint").text(o):n.append(i("<span class='zmenu__hint'/>").text(o)):"disabled"===t||"checked"===t||"hidden"===t?(r[t]=o,a._handleCheckedandDisabled(n,r,t)):"menuId"===t&&r.menuId!==o?(r[t]=o,o?(n.removeData("submenu"),a._buildSubmenu(n,r),a._createArrowIcon(n)):(n.find(".zmenu__icon.h-alignright").remove(),n.removeData("submenu"),n.off("mouseup.submenuitem.zmenu"))):"innerHTML"===t&&"custom"===r.itemType?n.empty().html(o):"itemType"===t&&r.itemType!==o&&("separator"===o?n.removeClass("zmenu__item").addClass("zmenu__separator").empty():"default"===o?n.removeClass("zmenu__title zmenu__custom zmenu__separator").addClass("zmenu__item"):"custom"===o?n.addClass("zmenu__item zmenu__custom"):"itemgroup"===o?n.removeClass("zmenu__item zmenu__custom zmenu__separator").addClass("zmenu__title"):"splitmenu"===o&&(n.removeClass("zmenu__title zmenu__custom zmenu__separator").addClass("zmenu--split"),a._createArrowIcon(n),n.find(".zmenu__shortcut").remove()),n.attr("role",a.ARIA_ROLES[o?o:"default"]),n.attr("data-item-type",o),n[0].setAttribute("role",this.ARIA_ROLES[o?o:"default"])):r.shortcutKey||r.shortcutkey?n.find(".zmenu__shortcut").text(o):(o=window.ZShortCut?ZShortCut.getInfo(void 0,o):o,a.getData(n).shortcutkey=a.getData(n).shortcutKey=o,n.append(i("<span class='zmenu__shortcut'/>").text(o)));else{(r.icon||r.iconClass||r.SVGIconId||n.find(".zmenu__iconcontainer:first").length)&&n.find(".zmenu__iconcontainer:first").remove();var l=i("<i class='zmenu__icon'/>");0===o.indexOf("text:")?(n.prepend(i("<div class='zmenu__iconcontainer'>").append(l)),n.find(".zmenu__icon:first").text(o.replace("text:",""))):(r[t]=o,n.prepend(i("<div class='zmenu__iconcontainer'>").append(a._handleIcon(l,void 0,void 0,r.iconClassName,r.SVGIconId,r.icon))))}r[t]=o,n.data("metadata",r)}})}};r.updateMenuItems=r.setMenuItemsAttribute,e.registerComponent("zmenu",r),e.createMenu=function(t,o,a){if("object"==typeof t&&(o=t.items,a=t,t=t.id),i("#"+t).data("zmenu"))return i("#"+t);var n=void 0;document.getElementById(t)?(n=i(document.getElementById(t)),"DIV"===n[0].tagName&&n[0].appendChild(document.createElement("ul"))):n=i("<div><ul></ul></div>").attr("id",t);var s=a?a.appendTo:void 0;n[0].className+=" zmenu "+r._MENU_CONTENT_TYPES[a.contentType?a.contentType:"text"]+" "+(a.menuClass?a.menuClass:"")+" "+(a.className?a.className:""),a.type&&-1!==a.type.indexOf("grid")&&(n[0].className+=" zmenu--thumbnail"),a.usingJSON=!0;var l=document.querySelector("body");return void 0!==s&&s.length&&(l=i(s)[0]),l.appendChild(n[0]),e.getOptions(n).type=a.type,n.zmenu(a),o.length?n.zmenu("addMenuItems",o,a?a.addItemCallback:void 0):"",n};var s={}}(ZComponents);var ZAlertBanner={};!function(e){var t=e.DOMUtil;e.notifierCount=0;var i={options:{type:"info",icon:void 0,message:"Default alert banner",isMessageHTMLEncoded:!1,position:"top",align:"center",positionAlterable:!0,hideDelay:void 0,closeButton:!1,display:"fixed",target:"body",displayAfter:void 0,displayBefore:void 0,displayInside:void 0,hideOnClick:!1,left:void 0,right:void 0,bottom:void 0,top:void 0,margin:void 0,pauseOnMouseOver:!1,height:"auto",width:"auto",className:void 0,animation:!1,closePreviousBanner:!0,icons:{close:void 0,error:void 0,info:void 0,warning:void 0,success:void 0},labels:{close:"Close"},widgetEventPrefix:"zalertbanner"},_TEMPLATE:{close:"<svg class='zalertbanner__svg' viewBox='0 0 16 16'><g><rect x='1.5' y='7.4' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -3.3137 8)' class='st0' width='13' height='1.1'></rect><rect x='1.5' y='7.4' transform='matrix(0.7071 0.7071 -0.7071 0.7071 8 -3.3137)' class='st0' width='13' height='1.1'></rect></g></svg>",info:"<svg class='zalertbanner__svg' viewBox='0 0 48 48'><g><g><path d='M23.9,17.4c1.5,0,2.5-1.1,2.4-2.3c0-1.3-0.9-2.4-2.3-2.4s-2.4,1.1-2.4,2.4C21.6,16.3,22.6,17.4,23.9,17.4z'></path><path d='M26.2,35.5V21.8c0-1.2-1.4-1.3-1.8-1.3h-0.7c0,0-1.7,0-1.7,1.1v14.3c0,0.3,0.2,0.9,1.3,0.9h1.6C25.3,36.7,26.2,36.5,26.2,35.5z'></path></g><path d='M24,0C10.7,0,0,10.7,0,24s10.7,24,24,24s24-10.7,24-24S37.3,0,24,0z M24,44C13,44,4,35,4,24S13,4,24,4s20,9,20,20S35,44,24,44z'></path></g></svg>",error:"<svg class='zalertbanner__svg' viewBox='0 0 48 48'><path d='M41.2,7.2C31.9-2.2,16.7-2.5,7.3,6.9c-9.5,9.3-9.7,24.5-0.4,33.9c9.3,9.5,24.5,9.7,33.9,0.4C50.3,31.9,50.4,16.8,41.2,7.2z M37.9,38.2C30,46,17.4,45.9,9.7,38S2.1,17.5,10,9.8S30.5,2.1,38.2,10C45.9,17.9,45.8,30.5,37.9,38.2z'></path><path d='M31.7,17.5l-1.1-1.1c-0.8-0.8-1.7-0.1-2,0.1L24,21l-4.6-4.7c-0.3-0.3-1.1-0.8-1.9,0l-1.1,1.1c-0.8,0.8-0.1,1.7,0.1,2L21,24l-4.7,4.6c-0.9,0.9-0.3,1.6-0.1,1.8l1.3,1.3c0.2,0.2,0.9,0.8,1.8-0.1L24,27l4.6,4.7c0.9,0.9,1.6,0.3,1.8,0.1l1.3-1.3c0.2-0.2,0.8-0.9-0.1-1.8L27,24l4.7-4.6C32,19.1,32.5,18.4,31.7,17.5z'></path></svg>",warning:"<svg class='zalertbanner__svg' viewBox='0 0 48 48'><g><path d='M47.3,36.6L27.7,2.5c-0.9-1.4-2.4-2.2-3.9-2.1c-1.6,0-2.9,0.9-3.7,2.2L0.7,36.5c-0.9,1.3-1,3-0.2,4.4c0.8,1.5,2.3,2.4,4,2.4h39c1.6,0,3.1-0.8,3.9-2.2C48.2,39.7,48.2,38,47.3,36.6z M43.9,39.2c-0.1,0.1-0.2,0.2-0.4,0.2h-39c-0.3,0-0.4-0.2-0.5-0.3c-0.1-0.2,0-0.3,0-0.4L23.5,4.6c0,0,0.1-0.2,0.3-0.2c0,0,0,0,0,0c0.1,0,0.3,0,0.4,0.2l19.6,34C44,38.8,44,39,43.9,39.2z'></path></g><circle cx='24' cy='33.4' r='2'></circle><path d='M24.1,28.4L24.1,28.4c-0.8,0-1.3-0.4-1.4-1l-1-10c-0.1-1.1,1-2,2.4-2l0,0c1.4,0,2.5,0.9,2.4,2l-1,10C25.4,27.9,24.9,28.4,24.1,28.4z'></path></svg>",success:'<svg class="zalertbanner__svg" viewBox="0 0 48 48"><path d="M41.2 7.2C31.9-2.3 16.7-2.5 7.3 6.8c-9.5 9.3-9.7 24.5-0.4 33.9 9.3 9.5 24.5 9.7 33.9 0.4C50.3 31.9 50.4 16.7 41.2 7.2zM37.9 38.2c-7.9 7.7-20.5 7.6-28.2-0.3S2.1 17.4 10 9.7 30.5 2.1 38.2 10C45.9 17.8 45.8 30.5 37.9 38.2z"></path><path d="M35 20.3L23.1 32.2c-1.1 1.1-2.9 1.1-4 0l-1-1 -4.5-4.6c-0.2-0.2-1-1.1-0.1-2l1.1-1.1c0.8-0.8 1.6-0.3 1.9 0l4.6 4.7 11-10.8c0.2-0.2 1.1-1 2-0.1l1.1 1.1C35.8 19.2 35.3 19.9 35 20.3z"></path></svg>'},_EVENTS:{ONSHOW:"show",ONHIDE:"hide",ONBEFORESHOW:"beforeshow",ONBEFOREHIDE:"beforehide"},_ANIMATION:{slide:{show:"slideDown",hide:"slideUp"},fade:{show:"fadeIn",hide:"fadeOut"},end:"webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend"},_CLASS:{SUCCESS:"zalertbanner--success",INFO:"zalertbanner--info",WARNING:"zalertbanner--warning",ERROR:"zalertbanner--error"},_create:function(e,t){this._initialize(e,t),this._createNotifier(),this._positionNotifier(),this.notifier.hide()&&this._open(),this._bindEvents()},_initialize:function(e,t){if(this.notifier=e,t.hideOnClick=t.closeButton?!1:t.hideOnClick,t.hideDelay=this._hideDelay=parseInt(void 0!==t.hideDelay?t.hideDelay:t.closeButton?0:5e3),this.eventNameSpace="."+t.widgetEventPrefix,"number"==typeof t.margin||"string"==typeof t.margin){var i=isNaN(parseInt(t.margin))?0:parseInt(t.margin);t.margin={left:i,top:i,right:i,bottom:i}}else"object"==typeof t.margin?(void 0===t.margin.left&&(t.margin.left="inline"===t.display?0:10),void 0===t.margin.right&&(t.margin.right="inline"===t.display?0:10),void 0===t.margin.top&&(t.margin.top="inline"===t.display?0:10),void 0===t.margin.bottom&&(t.margin.bottom="inline"===t.display?0:10)):(t.margin={},t.margin.left=t.margin.right=t.margin.bottom=t.margin.top="inline"===t.display?0:10)},_createNotifier:function(){var i=this.options,o=this.notifier;clearTimeout(this.autoHideTimer),/^(success|info|warning|error|custom)$/.test(i.type)||(i.type="success");var a="zalertbanner "+("custom"===i.type?"":this._CLASS[i.type.toUpperCase()])+" "+("string"==typeof i.className?i.className:"");if(this.notifier.addClass(a),i.icon){o=t('<div class="zalertbanner__table">').appendTo(this.notifier);var n=t('<i class="zalertbanner__icon"></i>').prependTo(o);i[i.type+"SVGIconId"]||i[i.type+"IconClassName"]?e.createIcon(n,void 0,i[i.type+"SVGIconId"],i[i.type+"IconClassName"]):"string"==typeof i.icon?e.createIcon(n,i.icon):n.html(this._TEMPLATE[i.type])}if(i.closeButton){var r=this,s=t('<i class="zalertbanner__icon"></i>');i.closeSVGIconId||i.closeIconClassName?e.createIcon(s,void 0,i.closeSVGIconId,i.closeIconClassName):s[0].innerHTML=this._TEMPLATE.close;var l=t('<button type=button class="zalertbanner__close"></button').append(s).on("click"+this.eventNameSpace,function(){r._close()});t('<div class="zalertbanner__action"></div>').append(l).appendTo(o).attr("title",this._localize("close"))}if(o.append('<span class="zalertbanner__text">'+(i.isMessageHTMLEncoded?String(i.message):e.encodeHTML(String(i.message)))+"</span>"),"inline"===i.display?this.options.displayInside?(this.target=t(this.options.displayInside),this.notifier.appendTo(this.target)):this.options.displayAfter?(this.target=t(this.options.displayAfter),this.notifier.insertAfter(this.target)):this.options.displayBefore&&(this.target=t(this.options.displayBefore),this.notifier.insertBefore(this.target)):(this.target=t(i.target),this.notifier.appendTo(this.target).css({position:this.target.is("body")?"fixed":"absolute"})),this.notifier.css("text-align",i.textAlign),"inline"===i.display){var d=this.notifier.outerWidth()+1;this.notifier.css("display","block");var c=this.notifier.outerWidth();d>c&&(d=c,i.align="center"),this.notifier[0].style.width=d+"px"}},_bindEvents:function(){this.options.hideOnClick&&this.notifier.on("click"+this.eventNameSpace,this._close.bind(this)),(this.options.pauseOnMouseOver||this.options.pauseOnHover)&&this._hideDelay&&this.notifier.on("mouseenter"+this.eventNameSpace,this._pauseTimer.bind(this)).on("mouseleave"+this.eventNameSpace,this._setHideTimer.bind(this))},_setHideTimer:function(){this._hideDelay&&(clearTimeout(this.autoHideTimer),this._startTimer=(new Date).getTime(),this.autoHideTimer=setTimeout(this._close.bind(this),this._hideDelay))},_pauseTimer:function(){this._startTimer&&(clearTimeout(this.autoHideTimer),this._hideDelay-=(new Date).getTime()-this._startTimer,this._startTimer=void 0)},_showComplete:function(){this._trigger("ONSHOW"),this._setHideTimer()},_open:function(){this._trigger("ONBEFORESHOW")&&this._animate(this.notifier,this.options.animation,"show","show",this._showComplete.bind(this))},_closeComplete:function(){var e=this;this._trigger("ONHIDE");var t=this.target.data("previous-bannerId");t===this.notifier.attr("id")&&this.target.removeData("previous-bannerId"),setTimeout(function(){e.notifier&&e.notifier.remove()},100)},_close:function(e){this._trigger("ONBEFOREHIDE")&&(clearTimeout(this.autoHideTimer),this._animate(this.notifier,e?void 0:this.options.animation,"hide","hide",this._closeComplete.bind(this)))},_animate:function(e,t,i,o,a){if(t&&"object"==typeof t){var n,r;t.name?this._ANIMATION[t.name]&&(n=this._ANIMATION[t.name][i]):t[i]&&("string"==typeof t[i]?n=t[i]:t[i].name?n=t[i].name:t[i].className&&(r=t[i].className));var s=t.duration?t.duration:t[i]&&t[i].duration?t[i].duration:void 0;"object"==typeof n?e.animate(n,s,a):/^(fadeIn|fadeOut|slideDown|slideUp)$/.test(n)?e[n](s,a):"string"==typeof r?("show"===o&&e.css("display",""),e.removeClass(e.data("css-effect")).addClass(r).data("css-effect",r).off(this._ANIMATION.end).on(this._ANIMATION.end,function(){"hide"===o&&e.hide(),e.removeClass(r).removeData("css-effect"),a()})):(e.css("display","hide"===o?"none":"block"),a())}else e.css("display","hide"===o?"none":"block"),a()},_trigger:function(e,t){return this._dispatchEvent(e,t)},_positionNotifier:function(){var e=this.options,t=this._getPosition();["left","right","top","bottom"].forEach(function(i){e[i]&&(t[i]=e[i])}),this.notifier.css(t)},_getDimension:function(e){var t;return this.notifier.css({left:0,top:0}),t=this.notifier[e?"outerHeight":"outerWidth"](),this.notifier.css({left:"auto",top:"auto"}),t},_getPosition:function(){var e,i,o={},a={top:this.options.margin.top,bottom:this.options.margin.bottom,left:this.options.margin.left,right:this.options.margin.right};return/^(left|right|center)$/.test(this.options.align)||(this.options.align=t.zalertbanner.prototype.options.align),i=this.options.align,"fixed"===this.options.display?(/^(top|bottom|middle)$/.test(this.options.position)||(this.options.position=t.zalertbanner.prototype.options.position),e=this.options.position,/^(top|bottom)$/.test(e)?o[e]=parseInt(a[e]):o.top="calc(50% - "+this._getDimension(!0)/2+"px)",this.notifier.attr("data-position",e+"-"+i)):(a.top&&(o["margin-top"]=a.top),a.bottom&&(o["margin-bottom"]=a.bottom)),"left"===i?a.left&&(o.left=parseInt(a.left)):"right"===i?"fixed"!==this.options.display?o.left="calc(100% - "+(this._getDimension()+parseInt(a.right))+"px)":o.right=parseInt(a.right):"fixed"===this.options.display?o.left="calc(50% - "+this._getDimension()/2+"px)":(o["margin-left"]="auto",o["margin-right"]="auto"),o}};e.registerComponent("zalertbanner",i),ZAlertBanner.show=function(i){var o;"fixed"===i.display?(o=t(i.target),o.length||(i.target=o=t("body"))):(i.displayInside?o=t(i.displayInside):i.displayAfter?o=t(i.displayAfter):i.displayBefore&&(o=t(i.displayBefore)),o&&o.length||(o=t("body"),i.display="fixed"));var a=o.data("previous-bannerId");if(a){var n=t("#"+a);n.finish?n.finish():n.stop(!0,!0),n.is(":visible")&&n.length&&(ZAlertBanner.hide(n,!0),"inline"===i.display&&i.animation&&i.animation.show&&(i.animation.show=!1))}var r="zalertbanner_"+e.notifierCount++;return o.data("previous-bannerId",r),t('<div id="'+r+'" role="status" ></div>').zalertbanner("string"===i?{message:i}:i),r},ZAlertBanner.hide=function(e,i){if(e){var o=t(e);o.length&&o.each(function(e,o){var a=t(o).data("zalertbanner");a&&a._close.call(a,i)})}},e.AlertBanner=ZAlertBanner}(ZComponents),function(e){var t=e.DOMUtil;ZAlertDialog={position:"golden-mean",ANIMATION_EVENTS:"webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend transitionend",overlayClassName:"",EFFECTS:{slide:{open:"slideDown",close:"slideUp"},fade:{open:"fadeIn",close:"fadeOut"}},_ALIGNMENTS:{left:"zdialogfooter--invert",right:"",center:"h-center"},DEFAULTS:{type:"custom",buttonsAlignment:"right",isHTMLEncoded:!1,isTitleHTMLEncoded:!1,isMessageHTMLEncoded:!1,className:"",icon:void 0,draggable:!0,labels:{cancel:"Cancel",no:"No",ok:"OK",yes:"Yes",close:"Close",help:"Help",suppressionMessage:"Do not show this message again."},closeIcon:void 0,helpIcon:void 0,OKButtonLabel:void 0,cancelButtonLabel:void 0,yesButtonLabel:void 0,noButtonLabel:void 0,closeButtonLabel:void 0,helpButtonLabel:void 0,suppressionDecisionBoxLabel:void 0},widgetName:"zalertdialog",open:function(e){var t=this;this.close({},{},function(){t._openDialog(e)})},_openDialog:function(i){if(this.options=t.extend(!0,{},this.DEFAULTS,i),this.options.customAttributes&&window.sessionStorage.suppressAlertId&&-1!==window.sessionStorage.suppressAlertId.indexOf(this.options.customAttributes.id)||window.sessionStorage.suppressAlert&&"null"!==window.sessionStorage.suppressAlert)return void(i.suppressed&&i.suppressed());this._constructDialog(),this._bindEvents(),t("body").append(this.wrapper),this._positionDialog(),this._createOverlay(),this._openWithAnimation();var o=this;e.$window.off("resize.zalertdialog").on("resize.zalertdialog",function(e){o.wrapper&&o.wrapper.is(":visible")&&(o.options.position&&!o.options.position.length||"center"===o.options.position)&&"resize"===e.originalEvent.type&&o._positionDialog()})},_constructDialog:function(){this.wrapper=t("<div/>").attr({"class":"zdialog zdialog--alert "+this.options.className,tabIndex:-1,role:"alertdialog","aria-modal":!0}),this.options.customAttributes&&this.wrapper.attr(this.options.customAttributes),(this.options.title||this.options.closeButton)&&(this._createTitleBar(),t.fn.zdraggable&&this.options.draggable&&this._makeDraggable()),(this.options.primaryMessage&&""!==this.options.primaryMessage.trim()||this.options.secondaryMessage&&""!==this.options.secondaryMessage.trim())&&this._createContent(),this._createFooter()},_makeDraggable:function(){this.wrapper.zdraggable({ignore:".zdialog__actiongroup",handle:".zdialog__header",container:"window"})},_createTitleBar:function(){var i=t("<div/>").attr("class","zdialog__header");if(this.options.title&&i.append(t("<span/>").attr("class","zdialog__title").html(this.options.isHTMLEncoded||this.options.isTitleHTMLEncoded?this.options.title:e.encodeHTML(this.options.title))),this.options.closeButton){var o=t("<div class='zdialog__actiongroup'></div>"),a=t("<button type='button'></button>").attr({"class":"zbutton zbutton--action",title:this.options.closeButtonLabel||this._getString("close")}),n=this;a.on("click."+this.widgetName,function(e){n.close(e,{button:a,buttonType:"CLOSE",closeButton:!0})});var r=t("<i class='zbutton__icon'></i"),s={props:{"class":"zbutton__svg",viewBox:"0 0 16 16",width:"100%",height:"100%"},nodes:[{rect:{x:"1.5",y:"7.4",transform:"matrix(0.7071 -0.7071 0.7071 0.7071 -3.3137 8)","class":"st0",width:"13",height:"1.1"}},{rect:{x:"1.5",y:"7.4",transform:"matrix(0.7071 0.7071 -0.7071 0.7071 8 -3.3137)","class":"st0",width:"13",height:"1.1"}}]};e._handleIcon(r,s,"close",this.options.closeIconClassName,this.options.closeSVGIconId),a.append(r),i.append(o.append(a))}this.wrapper.append(i)},_createContent:function(){var i=t("<div class='zdialog__content'/>"),o=t("<div class='zdialog__description'></div>"),a=t("<i class='zdialog__icon'></i>"),n=this._getIcon(a);if(n&&void 0!==n&&""!==n){var r=t("<div class='zdialog__alerticon'></div>");i.append(r.append(a))}if(this.options.primaryMessage&&o.append(t("<div class='zdialog__primarytext'>").html(this.options.isHTMLEncoded||this.options.isMessageHTMLEncoded?this.options.primaryMessage:e.encodeHTML(this.options.primaryMessage))),this.options.secondaryMessage&&o.append(t("<div class='zdialog__secondarytext'>").html(this.options.isHTMLEncoded||this.options.isMessageHTMLEncoded?this.options.secondaryMessage:e.encodeHTML(this.options.secondaryMessage))),i.append(o),this.options.suppressionDecisionBox){var s=t("<div class='zdialog__suppression'></div>"),l=this,d=t("<div class='zcheckbox'><input id='zalert__suppression--box' type='checkbox' class='zcheckbox__helper'/><label for='zalert__suppression--box' class='zcheckbox__label'>"+(this.options.suppressionDecisionBoxLabel||this._getString("suppressionMessage"))+"</label></div>");i.append(s.append(d)),d.find("#zalert__suppression--box").on("change",function(){var e=t("#zalert__suppression--box").prop("checked"),i=window.sessionStorage.getItem("suppressAlertId"),o=l.wrapper.attr("id");e?(e="true",o&&(e=null!=i?i+","+o:","+o)):(e=null,o&&(e=null!==i?i.replace(","+o,""):void 0)),window.sessionStorage.setItem("suppressAlertId",e)})}this.wrapper.append(i)},_clickHandler:function(e){var i=this,o=t(e.target).closest(".zbutton"),a=o.data("metadata"),n={button:o,properties:a,buttonOptions:a};a.action&&"string"!=typeof a.action?a.action(e,n):i.close(e,n),e.stopPropagation(),e.preventDefault()},_createFooter:function(){for(var i=t("<div/>").attr({"class":"zdialog__footer "+this._ALIGNMENTS[this.options.buttonsAlignment],tabIndex:-1}),o=this._getButtonPanelElements(),a=this,n=0;n<o.length;n++){var r=t("<button>");o[n].customAttributes&&r.attr(o[n].customAttributes),o[n].id&&r.attr("id",o[n].id),o[n].name&&r.attr("name",o[n].name),o[n].type&&(r[0].type=o[n].type),r.data("metadata",o[n]).addClass("primary"===o[n].appearance?"zbutton zbutton--primary":"zbutton").append(t("<span/>").attr("class","zbutton__text").text(o[n].text)).attr("data-text",o[n].text.toLowerCase()),"CANCEL"===o[n].action&&r.addClass("h--clickonescape"),r.on("click."+this.widgetName,a._clickHandler.bind(this)),i.append(r),e._handleFocus(r)}if(this.options.helpButton){var s=t("<button class='zbutton zbutton--help' type='button' title='"+(this.options.helpButtonLabel||this._getString("help"))+"'></button>"),a=this,l=t("<i class='zdialog__icon'></i>"),d={props:{"class":"zdialog__svg grayscale",viewBox:"0 0 48 48",width:"100%",height:"100%"},nodes:[{g:{nodes:[{path:{d:"M24,0C10.7,0,0,10.7,0,24s10.7,24,24,24s24-10.7,24-24C48,10.8,37.3,0,24,0z M24,44.1c-11,0-20-9-20-20s9-20,20-20s20,9,20,20C44,35.2,35,44.1,24,44.1z"}},{g:{nodes:[{path:{d:"M22.8,31.9c-1.7,0-2.6,0.9-2.6,2.7c0,0.9,0.2,1.5,0.7,2c0.4,0.5,1.1,0.7,1.9,0.7c0.8,0,1.5-0.2,1.9-0.7c0.5-0.5,0.7-1.1,0.7-2c0-0.8-0.2-1.5-0.7-2C24.3,32.2,23.6,31.9,22.8,31.9z"}},{path:{d:"M29.3,12.4c-1.3-1.1-3.2-1.7-5.5-1.7s-4.4,0.5-6.5,1.4c-1.1,0.5-0.6,1.7-0.6,1.7l0.5,1c0,0,0.5,0.9,1.7,0.5l0,0c0.5-0.2,1-0.4,1.5-0.6c0.9-0.3,2-0.5,3.1-0.5c1.2,0,2.2,0.3,2.8,0.8c0.7,0.5,1,1.3,1,2.3c0,0.8-0.2,1.6-0.6,2.2c-0.4,0.6-1.3,1.5-2.7,2.6c-1.2,0.9-2,1.8-2.5,2.7c-0.5,0.9-0.7,1.9-0.7,3.2c0,0.9,1.1,1.1,1.1,1.1h0.7c0,0,1.4,0,1.6-1.2l0,0c0-0.8,0.2-1.4,0.5-1.8c0.4-0.6,1.1-1.3,2.2-2.1c1.3-1,2.2-1.8,2.7-2.4s0.9-1.3,1.2-2s0.4-1.5,0.4-2.3C31.4,15.1,30.7,13.5,29.3,12.4z"}}]}}]}}]};e._handleIcon(l,d,"help",this.options.helpIconClassName,this.options.helpSVGIconId),s.append(l),this.options.helpButton.customAttributes&&s.attr(this.options.helpButton.customAttributes),s.on("click",function(){a.options.helpButton.action&&a.options.helpButton.action()}),i.prepend(s)}this.wrapper.append(i)},_createCommandBar:function(e){var i=this.options.commandBar,o=t("<div class='zalertdialog__commandbar zalertdialog__footer' ></div>");if(i.leftColumn){var a=t("<div class='zalertdialog__commandbaractionsleft'></div>"),n=i.leftColumn.commands;i.leftColumn.className&&a.addClass(i.leftColumn.className);for(var r=0;r<n.length;r++)a.append(e.find(".zbutton[name="+n[r]+"]"));o.append(a)}if(i.centerColumn){var s=t("<div class='zalertdialog__commandbaractionscenter'></div>"),l=i.centerColumn.commands;i.centerColumn.className&&s.addClass(i.centerColumn.className);for(var r=0;r<l.length;r++)s.append(e.find(".zbutton[name="+l[r]+"]"));o.append(s)}if(i.rightColumn){var d=t("<div class='zalertdialog__commandbaractionsright'></div>"),c=i.rightColumn.commands;i.rightColumn.className&&d.addClass(i.rightColumn.className);for(var r=0;r<c.length;r++)d.append(e.find(".zbutton[name="+c[r]+"]"));o.append(d)}return this.wrapper.find(".zdialog__footer").remove(),this.wrapper.append(o),o},_getString:function(t){return e.getI18NText("zalertdialog",t,this.options.labels,[])},_getButtonPanelElements:function(){var i={CANCEL:{actionType:"CANCEL",id:"zc-zdialog-cancel",text:this.options.cancelButtonLabel||this._getString("cancel"),action:"CANCEL",name:"cancel",isCancel:!0},OK:{actionType:"OK",id:"zc-zdialog-ok",text:this.options.OKButtonLabel||this._getString("ok"),appearance:"primary",name:"ok"},NO:{actionType:"NO",id:"zc-zdialog-no",text:this.options.noButtonLabel||this._getString("no"),action:"CANCEL",isCancel:!0,name:"no"},YES:{actionType:"YES",id:"zc-zdialog-yes",text:this.options.yesButtonLabel||this._getString("yes"),appearance:"primary",name:"yes"}},o={mac:{CANCEL:i.CANCEL,OK:i.OK,NO:i.NO,YES:i.YES},windows:{OK:i.OK,CANCEL:i.CANCEL,YES:i.YES,NO:i.NO}},a=this.options,n=this.options.buttonsOrder;switch(n||(n=e.Browser.isWindows()?"windows":"mac"),i=o[n],a.type){case"custom":case"confirm":if(!this.options.buttons)return[i.CANCEL,i.OK];default:if("string"==typeof a.buttons){var r=[],s=0,l=a.buttons.split("-");return t.each(i,function(e){-1!==l.indexOf(e.toLowerCase())&&(r[s]=i[e],s++)}),r}return"object"==typeof a.buttons?a.buttons:[i.OK]}},_getIcon:function(t){if(this.options.icon||this.options.iconClassName||this.options.SVGIconId)return e._handleIcon(t,void 0,void 0,this.options.iconClassName,this.options.SVGIconId,this.options.icon);var i={props:{viewBox:"0 0 48 48",width:"100%",height:"100%"}},o=this.options.type;if("success"===o)i.props["class"]="zdialog__svg successcolor",i.nodes=[{g:{nodes:[{path:{d:"M41.2,7.2C31.9-2.3,16.7-2.5,7.3,6.8c-9.5,9.3-9.7,24.5-0.4,33.9c9.3,9.5,24.5,9.7,33.9,0.4C50.3,31.9,50.4,16.7,41.2,7.2z M37.9,38.2c-7.9,7.7-20.5,7.6-28.2-0.3S2.1,17.4,10,9.7S30.5,2.1,38.2,10C45.9,17.8,45.8,30.5,37.9,38.2z"}},{path:{d:"M36,19.3L23.1,32.2c-1.1,1.1-2.9,1.1-4,0l-1-1l-4.5-4.6c-0.2-0.2-1-1.1-0.1-2l1.1-1.1c0.8-0.8,1.6-0.3,1.9,0l4.6,4.7l12-11.8c0.2-0.2,1.1-1,2-0.1l1.1,1.1C36.8,18.2,36.3,18.9,36,19.3z"}}]}}];else if("info"===o)i.props["class"]="zdialog__svg infocolor",i.nodes=[{g:{nodes:[{g:{nodes:[{path:{d:"M23.9,17.4c1.5,0,2.5-1.1,2.4-2.3c0-1.3-0.9-2.4-2.3-2.4s-2.4,1.1-2.4,2.4C21.6,16.3,22.6,17.4,23.9,17.4z"}},{path:{d:"M26.2,35.5V21.8c0-1.2-1.4-1.3-1.8-1.3h-0.7c0,0-1.7,0-1.7,1.1v14.3c0,0.3,0.2,0.9,1.3,0.9h1.6C25.3,36.7,26.2,36.5,26.2,35.5z"}}]}},{path:{d:"M24,0C10.7,0,0,10.7,0,24s10.7,24,24,24s24-10.7,24-24S37.3,0,24,0z M24,44C13,44,4,35,4,24S13,4,24,4s20,9,20,20S35,44,24,44z"}}]}}];else if("error"===o)i.props["class"]="zdialog__svg errorcolor",i.nodes=[{path:{d:"M41.2,7.2C31.9-2.2,16.7-2.5,7.3,6.9c-9.5,9.3-9.7,24.5-0.4,33.9c9.3,9.5,24.5,9.7,33.9,0.4C50.3,31.9,50.4,16.8,41.2,7.2z M37.9,38.2C30,46,17.4,45.9,9.7,38S2.1,17.5,10,9.8S30.5,2.1,38.2,10C45.9,17.9,45.8,30.5,37.9,38.2z"}},{path:{d:"M31.7,17.5l-1.1-1.1c-0.8-0.8-1.7-0.1-2,0.1L24,21l-4.6-4.7c-0.3-0.3-1.1-0.8-1.9,0l-1.1,1.1c-0.8,0.8-0.1,1.7,0.1,2L21,24l-4.7,4.6c-0.9,0.9-0.3,1.6-0.1,1.8l1.3,1.3c0.2,0.2,0.9,0.8,1.8-0.1L24,27l4.6,4.7c0.9,0.9,1.6,0.3,1.8,0.1l1.3-1.3c0.2-0.2,0.8-0.9-0.1-1.8L27,24l4.7-4.6C32,19.1,32.5,18.4,31.7,17.5z"}}];else if("warning"===o)i.props["class"]="zdialog__svg warningcolor",i.nodes=[{g:{nodes:[{path:{d:"M47.3,36.6L27.7,2.5c-0.9-1.4-2.4-2.2-3.9-2.1c-1.6,0-2.9,0.9-3.7,2.2L0.7,36.5c-0.9,1.3-1,3-0.2,4.4c0.8,1.5,2.3,2.4,4,2.4h39c1.6,0,3.1-0.8,3.9-2.2C48.2,39.7,48.2,38,47.3,36.6z M43.9,39.2c-0.1,0.1-0.2,0.2-0.4,0.2h-39c-0.3,0-0.4-0.2-0.5-0.3c-0.1-0.2,0-0.3,0-0.4L23.5,4.6c0,0,0.1-0.2,0.3-0.2c0,0,0,0,0,0c0.1,0,0.3,0,0.4,0.2l19.6,34C44,38.8,44,39,43.9,39.2z"}}]}},{path:{d:"M24.1,28.4L24.1,28.4c-0.8,0-1.3-0.4-1.4-1l-1-10c-0.1-1.1,1-2,2.4-2l0,0c1.4,0,2.5,0.9,2.4,2l-1,10C25.4,27.9,24.9,28.4,24.1,28.4z"}},{circle:{cx:"24",cy:"33.4",r:"2"}}];else{if("confirm"!==o)return!1;i.props["class"]="zdialog__svg helpcolor",i.nodes=[{g:{nodes:[{path:{d:"M24,0C10.7,0,0,10.7,0,24s10.7,24,24,24s24-10.7,24-24C48,10.8,37.3,0,24,0z M24,44.1c-11,0-20-9-20-20s9-20,20-20s20,9,20,20C44,35.2,35,44.1,24,44.1z"}},{g:{nodes:[{path:{d:"M22.8,31.9c-1.7,0-2.6,0.9-2.6,2.7c0,0.9,0.2,1.5,0.7,2c0.4,0.5,1.1,0.7,1.9,0.7c0.8,0,1.5-0.2,1.9-0.7c0.5-0.5,0.7-1.1,0.7-2c0-0.8-0.2-1.5-0.7-2C24.3,32.2,23.6,31.9,22.8,31.9z"}},{path:{d:"M29.3,12.4c-1.3-1.1-3.2-1.7-5.5-1.7s-4.4,0.5-6.5,1.4c-1.1,0.5-0.6,1.7-0.6,1.7l0.5,1c0,0,0.5,0.9,1.7,0.5l0,0c0.5-0.2,1-0.4,1.5-0.6c0.9-0.3,2-0.5,3.1-0.5c1.2,0,2.2,0.3,2.8,0.8c0.7,0.5,1,1.3,1,2.3c0,0.8-0.2,1.6-0.6,2.2c-0.4,0.6-1.3,1.5-2.7,2.6c-1.2,0.9-2,1.8-2.5,2.7c-0.5,0.9-0.7,1.9-0.7,3.2c0,0.9,1.1,1.1,1.1,1.1h0.7c0,0,1.4,0,1.6-1.2l0,0c0-0.8,0.2-1.4,0.5-1.8c0.4-0.6,1.1-1.3,2.2-2.1c1.3-1,2.2-1.8,2.7-2.4s0.9-1.3,1.2-2s0.4-1.5,0.4-2.3C31.4,15.1,30.7,13.5,29.3,12.4z"}}]}}]}}]}return e._handleIcon(t,i,o,this.options[o+"IconClassName"],this.options[o+"SVGIconId"]),!0},_openWithAnimation:function(){if(this.options.animation&&this.options.animation.open){var e=this,t=this.options.animation.open,i=t.className,o=t.name,a=t.duration?t.duration:0;i?this.wrapper.show().addClass(i).on(this.ANIMATION_EVENTS,function(){e.wrapper.removeClass(i),e._handleDialogOpen()}):"object"==typeof o?this.wrapper.show().animate(o,a,e._handleDialogOpen):this.wrapper[o](a,e._handleDialogOpen.bind(e))}else this.wrapper.show(),this._handleDialogOpen()},_handleDialogOpen:function(){if(this.options.open&&this.options.open({dialog:this.wrapper,options:this.options}),void 0!==this.options.closeTimeout&&""!==this.options.closeTimeout){var e=this;window.setTimeout(function(){e.close({},{})},parseInt(this.options.closeTimeout))}this.wrapper.attr("aria-expanded",!0),window.ZFocusHandler&&ZFocusHandler.init(this.wrapper,this.options.excludeFocus),this._focusActionButton()},_positionDialog:function(){var i=this.wrapper;this.options.width&&i.outerWidth(this.options.width),this.options.height&&i.outerHeight(this.options.height);var o=i.outerWidth(!0)+parseInt(i.css("border-left-width"))+parseInt(i.css("border-right-width")),a=i.outerHeight(!0)+parseInt(i.css("border-bottom-width"))+parseInt(i.css("border-top-width")),n=this._calculateGoldenMeanPosition(i);"object"==typeof this.options.position&&(this.options.position.left||this.options.position.top)?(n=t.extend({},n,this.options.position),n.left=parseInt(n.left)+window.pageXOffset,n.top=parseInt(n.top)+window.pageYOffset):"string"==typeof this.options.position&&"center"===this.options.position&&(n.top=e.windowObject.height/2-a/2+window.pageYOffset,n.left=e.windowObject.width/2-o/2+window.pageXOffset),i.css(n)},_focusActionButton:function(){var e=this.options.defaultActionButton;e=e&&0!==e.indexOf("#")?"button[data-text='"+e.toLowerCase()+"']":".zbutton--primary";var t=this.wrapper.find(e);t.length||(t=this.wrapper.find("button:last")),t.focus()},_calculateGoldenMeanPosition:function(e){var t=1.618,i=document.documentElement.clientHeight,o=document.documentElement.clientWidth,a=i/2,n=a-a/t,r=n-parseFloat(e.height()/2),s=o/2-parseFloat(e.width()/2);return 0>r&&(r=0),0>s&&(s=0),r+=window.pageYOffset,s+=window.pageXOffset,{top:r,left:s}},_createOverlay:function(){this._overlay=t("<div class='zdialog--overlay "+this.options.overlayClassName+"' ></div>").attr("tabindex",1),document.body.insertBefore(this._overlay[0],this.wrapper[0]),this._hideBodyScroll(!0),e.zIndex+=2,this._overlay.css("z-index",e.zIndex-1),this.wrapper.css("z-index",e.zIndex),this._overlay.on("keydown."+this.widgetName,function(e){e.stopPropagation(),e.preventDefault()}).on("mousedown."+this.widgetName,function(e){e.stopPropagation()})},_hideBodyScroll:function(e){t("body")[e?"addClass":"removeClass"]("h-overflowhidden")},close:function(e,t,i){t=t||{actionType:"CLOSE",isCancel:!0},this.wrapper&&this.wrapper.is(":visible")?this.options.beforeclose?this.options.beforeclose(t)!==!1&&this._handleClose(e,t,i):this._handleClose(e,t,i):i&&i.apply(this)},_handleClose:function(e,t,i){if(this.options.animation){var o=this,a=this.options.animation.close,n=a.className,r=a.name,s=a.duration?a.duration:0;n?this.wrapper.addClass(n).on(this.ANIMATION_EVENTS,function(){o.wrapper.removeClass(n),o.wrapper.hide(),o._close(e,t,i)}):"object"==typeof r?this.wrapper.animate(r,s,function(){o._close(e,t,i)}):this.wrapper[r](s,function(){o._close(e,t,i)})}else this.wrapper.hide(),this._close(e,t,i)},_close:function(i,o,a){this.wrapper.remove(),this._overlay&&this._overlay.remove(),t("body").find(".zdialog--overlay").length||this._hideBodyScroll(!1),e.zIndex=e.zIndex-2,i=i?i:{},o.options=this.options,o.button=t(i.target),o.event=i,this.options.close&&this.options.close(i,o),this._overlay=this.wrapper=void 0,a&&a.apply(this)},_bindEvents:function(){var i=this;this.wrapper.on("keydown."+this.widgetName,function(o){if(o.keyCode===e.keyCode.ESCAPE){var a=i.wrapper.find(".h--clickonescape:first");a.length?window.setTimeout(function(){a.trigger("click")},150):i.options.closeButton?i.wrapper.find(".zdialog__actiongroup .zbutton").trigger("click"):i.close(o,{ESCAPE_PRESSED:!0})}else if(o.keyCode===e.keyCode.ENTER){var n=i.wrapper.find(i.options.defaultActionButton||".zbutton--primary"),r=".zbutton:not(.zbutton--menu), input:not(.ztokenfield):not(.zsuggestfield-element), div.zdialog__header";t(o.target).closest(r).length&&n.length&&!t(o.target).closest(".zdialog__footer").length&&n.trigger("click")}o.keyCode===e.keyCode.TAB&&o.preventDefault()}).on("click."+this.widgetName,function(e){e.stopPropagation()}),this.wrapper.find(".zdialog__header").length&&this.wrapper.find(".zdialog__header").on("mouseup."+this.widgetName,function(){i._focusActionButton()})}},e.AlertDialog=ZAlertDialog}(ZComponents),function(e){var t=e.DOMUtil,i={options:{orientation:"horizontal",locale:void 0,thumbIconStyle:"circle",thumbIconClassName:void 0,thumbSVGIconId:void 0,min:0,max:100,step:1,valuesType:"range",value:0,minValueAllowed:void 0,maxValueAllowed:void 0,values:[],showTooltip:"never",tooltip:{position:"top",displayType:"callout",text:"#value#",isHTMLEncoded:!1},showTicks:!1,ticks:{splitBy:"count",count:4,step:void 0,randomValues:void 0,position:"bottom",showLabels:!0,showLabelsFor:void 0,labelPattern:"#value#",customLabels:void 0,isLabelHTMLEncoded:!1},valueDisplayFormat:{type:"number",currencyCode:void 0,prefix:void 0,suffix:void 0,decimalPlaces:void 0,thousandSeparator:!1},snapToTicks:!0,rangeGroups:{groups:[],isLabelHTMLEncoded:!1,labelPosition:"top"},animation:{slide:{className:void 0,duration:200}},stepBehavior:"w3",selectionStartValue:void 0,blurOnRelease:!1,className:void 0,disabled:!1,tabIndex:0,widgetEventPrefix:"zslider"},_MEASUREMENTS:["minValueAllowed","maxValueAllowed"],_CLASS:{SLIDER:"zslider",VERTICAL:"zslider--vertical",HANDLE:"zslider__thumb",TRACK:"zslider__track",FILL:"zslider__selection",PIPES:"zslider__scale",PIPE:"zslider__tick",LABELS:"zslider__labels",LABEL:"zslider__label",DISABLED:"is-disabled"},_EVENTS:{ONINIT:"init",ONFOCUS:"focus",ONBLUR:"blur",ONCHANGE:"change",ONSLIDESTART:"slidestart",ONSLIDE:"slide",ONSLIDEEND:"slideend"},_TEMPLATE:{bottom:'<svg class="zslider__pointerthumbsvg" viewBox="0 0 21 32" width="22" height="32"> <path class="pointerthumb__border" d="M16.5,15.2l-6.5,7l-6.5-7V5c0-0.9,0.7-1.6,1.6-1.6H15c0.8,0,1.5,0.7,1.5,1.6V15.2z"></path> <path class="pointerthumb__innerborder" d="M15.5,14.4l-5.5,6l-5.5-6V5.7c0-0.7,0.6-1.3,1.3-1.3h8.3c0.8,0,1.4,0.6,1.4,1.3V14.4z"></path> <path class="pointerthumb" d="M14.5,13.9L10,18.8l-4.5-4.9V6.5c0-0.6,0.5-1.1,1.1-1.1h6.8c0.6,0,1.1,0.5,1.1,1.1V13.9z"></path> </svg>',top:'<svg class="zslider__pointerthumbsvg" viewBox="0 0 21 32" width="22" height="32"><path class="pointerthumb__border" d="M3.5,12.8l6.5-7l6.5,7V23c0,0.9-0.7,1.6-1.6,1.6H5c-0.8,0-1.5-0.7-1.5-1.6V12.8z"></path> <path class="pointerthumb__innerborder" d="M4.5,13.6l5.5-6l5.5,6v8.7c0,0.7-0.6,1.3-1.3,1.3H5.9c-0.8,0-1.4-0.6-1.4-1.3V13.6z"></path> <path class="pointerthumb" d="M5.5,14.1L10,9.2l4.5,4.9v7.4c0,0.6-0.5,1.1-1.1,1.1H6.6c-0.6,0-1.1-0.5-1.1-1.1V14.1z"></path> </svg>',left:'<svg class="zslider__pointerthumbsvg" viewBox="0 0 32 21"  width="32" height="22"><path class="pointerthumb__border" d="M12.8,16.5l-7-6.5l7-6.5l10.2,0c0.9,0,1.6,0.7,1.6,1.6l0,9.9c0,0.8-0.7,1.5-1.6,1.5L12.8,16.5z"></path> <path class="pointerthumb__innerborder" d="M13.6,15.5l-6-5.5l6-5.5l8.7,0c0.7,0,1.3,0.6,1.3,1.3l0,8.3c0,0.8-0.6,1.4-1.3,1.4L13.6,15.5z"></path> <path class="pointerthumb" d="M14.1,14.5L9.2,10l4.9-4.5l7.4,0c0.6,0,1.1,0.5,1.1,1.1l0,6.8c0,0.6-0.5,1.1-1.1,1.1L14.1,14.5z"></path> </svg>',right:'<svg class="zslider__pointerthumbsvg" viewBox="0 0 32 21" width="32" height="22"><path class="pointerthumb__border" d="M15.2,3.5l7,6.5l-7,6.5L5,16.5c-0.9,0-1.6-0.7-1.6-1.6V5c0-0.8,0.7-1.5,1.6-1.5L15.2,3.5z"></path> <path class="pointerthumb__innerborder" d="M14.4,4.5l6,5.5l-6,5.5H5.7c-0.7,0-1.3-0.6-1.3-1.3l0-8.3c0-0.8,0.6-1.4,1.3-1.4H14.4z"></path> <path class="pointerthumb" d="M13.9,5.5l4.9,4.5l-4.9,4.5H6.5c-0.6,0-1.1-0.5-1.1-1.1l0-6.8c0-0.6,0.5-1.1,1.1-1.1H13.9z"></path> </svg>'},_create:function(t,i){this._frominit=!0,this.element.hide(),this._eventNamespace="."+i.widgetEventPrefix;var o=this;["min","max","step","value","title","tabIndex"].forEach(function(e){null!==o.element[0].getAttribute(e)&&(i[e]=o.element[0][e])}),this.element[0].disabled&&(i.disabled=!0),/^(range|fixed)$/.test(i.valuesType)||(i.valuesType="range"),/^(never|always|onslide)$/.test(i.showTooltip)||(i.showTooltip="never"),"vertical"===i.orientation&&(this.vertical=!0),i.locale=i.locale||e.locale,this._cacheMeasurements(),this._setFixedValues(),this._validateProperty(),this._constructLayout(),this._showHiddenParent(),this._constructThumb(),this._constructScale(),this._constructRangeLabels(),this._constructLimitLayout(),this._positionHandle(),this._resetParent(),this._bindEvents(),this._setInitial(),i.disabled&&this._setAttribute("disabled",!0),this._trigger("ONINIT"),this._frominit=!1},_getFromLocale:function(t,i){var o=this["_"+t];if(void 0===o)if(i)"currency_code"===t?o=this.options.valueDisplayFormat.currencyCode?this.options.valueDisplayFormat.currencyCode:e.localeInfo?e.localeInfo[this.options.locale].currency.code:void 0:(!this._currencyData&&e.currencyInformation&&(this._currencyData=e.currencyInformation[this._getFromLocale("currency_code",!0)]),this._currencyData&&(o=this._currencyData[t.replace("currency_","")]));else if(e.localeInformation){var a=this;Object.keys(e.localeInformation[t]).some(function(i){var n=e.localeInformation[t][i];return-1!==n.indexOf(a.options.locale)?o=i:!1})}return this["_"+t]=o?o:!1},_cacheMeasurements:function(){this.actualProps={};var e=this;this._MEASUREMENTS.forEach(function(t){e.actualProps[t]=e.options[t]})},_constructLayout:function(){var e=this.options,i=this.element[0].className+" "+this._CLASS.SLIDER+(this.vertical?" zslider--vertical":" ")+("string"==typeof e.className?" "+e.className:" ");this.container=t(document.createElement("div")).attr({"class":i,style:this.element[0].getAttribute("style"),title:e.title}).insertAfter(this.element),this.container[0].style.display="",this.container[0].innerHTML='<div class="zslider__shadowtrack"></div><div class="'+this._CLASS.TRACK+'"> <div class="'+this._CLASS.FILL+'"></div></div>',this._innerSlider=t(this.container[0].querySelector("."+this._CLASS.TRACK)),this._range=t(this.container[0].querySelector("."+this._CLASS.FILL)),this._shadowTrack=t(this.container[0].querySelector(".zslider__shadowtrack"))},_constructThumb:function(){this.container.append(this._createThumb()),this._handles=Array.prototype.slice.call(this.container[0].querySelectorAll("."+this._CLASS.HANDLE),0),this._updateDimensions()},_createThumb:function(){var i=this.options,o=t('<div role="slider" class="'+this._CLASS.HANDLE+'" aria-orientation="'+i.orientation+'" aria-valuemin="'+i.min+'" aria-valuemax="'+i.max+'"></div>');if(i.disabled?o.addClass(this._CLASS.DISABLED).attr("aria-disabled",!0):o[0].tabIndex=i.tabIndex,i.thumbIconClassName||i.thumbSVGIconId)return e.createIcon(o,void 0,i.thumbSVGIconId,i.thumbIconClassName);if("pointer"===i.thumbIconStyle){o.addClass("zslider__pointerthumb");var a=i.showTicks?i.ticks.position:"",n="";/^(left|top)$/.test(a)?(n=this.vertical?"left":"top",o.addClass("h-inverted")):n=this.vertical?"right":"bottom",o.html(this._TEMPLATE[n])}else o.addClass("zslider__circlethumb");return o},_updateDimensions:function(){this.vertical?(this.innerDim="height",this.outerDim="outerHeight",this.marginDir="bottom",this.oppOuterDim="outerWidth",this.oppMargin="left"):(this.innerDim="width",this.outerDim="outerWidth",this.marginDir="left",this.oppOuterDim="outerHeight",this.oppMargin="top");var e=t(this._handles[0]);this.sliderDim={height:this._innerSlider.height(),width:this._innerSlider.width(),outerHeight:this._innerSlider.outerHeight(),outerWidth:this._innerSlider.outerWidth()},this.handleDim={outerHeight:e.outerHeight(),outerWidth:e.outerWidth()}},_showHiddenParent:function(){if(document.body.contains(this.container[0])&&this.container.is(":hidden")){var e=1;this.hiddenParents=[],this.prevStyles=[];for(var t=this.container;e&&t&&!t.is("body");)"none"===t.css("display")&&(this.hiddenParents.push(t),this.prevStyles.push(t.attr("style")||""),t.css({display:"block",position:"absolute",visibility:"hidden"}),e=t.is(":hidden")),t=t.parent()}},_resetParent:function(){if(this.hiddenParents){var e=this;this.hiddenParents.forEach(function(t,i){t.attr("style",e.prevStyles[i])}),this.hiddenParents=this.prevStyles=void 0}},_positionHandle:function(){var e=this._innerSlider.position(),i=parseInt(e[this.oppMargin]),o=this.sliderDim[this.oppOuterDim]/2,a=this.handleDim[this.oppOuterDim]/2,n=this._shadowTrack[this.oppOuterDim]()/2;t(this._handles).css(this.oppMargin,i-(a-o)+"px").css("margin-"+this.marginDir,-this.handleDim[this.outerDim]/2+"px"),this._shadowTrack.css(this.oppMargin,i-(n-o)+"px"),!this._frominit&&this._updateTip()},_setInitial:function(){this._setInitialValue(),this._updateLayout()},_setInitialValue:function(){this.setValue(this.options.value)},_constructLimitLayout:function(){var e=this.options;"fixed"!==e.valuesType&&(e.minValueAllowed!==e.min&&this._createLimitBox(e.min,e.minValueAllowed,"zslider__selected"),e.maxValueAllowed!==e.max&&this._createLimitBox(e.maxValueAllowed,e.max,"zslider__notallowedrange"))},_constructRangeLabels:function(){var e,i=this.options;if("fixed"!==i.valuesType&&Array.isArray(e=this._parseArray(i.rangeGroups.groups))&&e.length){var o=this;this._range.hide(),this.container.addClass("zslider--range"),this._rangeLayout=t('<div class="zslider__rangelabels"></div>'),this._rangeBgs=[],this._rangeTicks=[];var a=0,n=[],r=[],s=function(e){if(void 0!==e){if(/%$/.test(e)&&(e=i.min+(i.max-i.min)*parseFloat(e)/100),isNaN(e)||e<i.min||e>i.max)return;if(+e!==i.max)return o._getPercent(+e)}};i.rangeGroups.groups.forEach(function(e){var t=0;e.from!==i.min&&(t=s(e.from)),isNaN(t)||(a=t);var l=100;if(e.to!==i.max&&(l=s(e.to)),!isNaN(l)){var d=o.marginDir+":"+a+"%;"+o.innerDim+":"+(l-a)+"%;";if(r.push('<div class="zslider__rangegroup '+(e.className?e.className:"")+'" style="'+d+(e.background?"background:"+e.background:"")+';" ></div>'),o.vertical){var c="max-"+o.innerDim+":"+o.sliderDim[o.outerDim]*(l-a)/100+"px";n.push('<div class="zslider__rangelabel" style="'+d+'"><span class="zslider__textcontainer" > <span class="zslider__text" style="'+c+'">'+e.label+"</span></span></div>")}else n.push('<div class="zslider__rangelabel" style="'+d+'">'+e.label+"</div>");a=l}});var l=".zslider__rangelabel";this.vertical&&(r=r.reverse().join(""),n=n.reverse().join(""),l=".zslider__text"),this._innerSlider.prepend(r),this._rangeLayout.append(n),this._positionRangeLabels(),Array.prototype.slice.call(this._rangeLayout[0].querySelectorAll(l),0).forEach(function(e){(e.offsetWidth<e.scrollWidth-2||e.offsetHeight<e.scrollHeight-2)&&e.setAttribute("title",e.textContent)})}},_positionRangeLabels:function(){var e=this.options.rangeGroups;if(this._rangeLayout){var t=e.labelPosition;/^(bottom|right)$/.test(t)?(this.container.append(this._rangeLayout),this._rangeLayout.addClass("h-inverted")):(this.container.prepend(this._shadowTrack,this._rangeLayout),this._rangeLayout.removeClass("h-inverted"))}},_createLimitBox:function(e,i,o){var a={},n=t('<div class="'+(o||"")+'"></div>');this._innerSlider.append(n);var r=parseFloat(e)===this.options.min?0:this._getPercent(e),s=parseFloat(i)===this.options.max?100:this._getPercent(i);a[this.marginDir]=r+"%",a[this.innerDim]=s-r+"%",n.css(a);var l=this.options;Array.prototype.slice.call(this.container[0].querySelectorAll(".zslider__tick,.zslider__label"),0).forEach(function(o){var a=+o.getAttribute("data-val");e>a||a>i||a===e&&e!==l.min||a===i&&i!==l.max||t(o).addClass("is-disabled")})},_bindEvents:function(){this.container.on("mousedown"+this._eventNamespace,".zslider__shadowtrack,.zslider__track,.zslider__thumb,.zslider__tick,.zslider__label",this._onMouseDown.bind(this)).on("keydown"+this._eventNamespace,"."+this._CLASS.HANDLE,this._onSlide.bind(this)).on("keyup"+this._eventNamespace,"."+this._CLASS.HANDLE,this._onSlideEnd.bind(this)).on("mouseup"+this._eventNamespace,this._onSlideEnd.bind(this)).on("mouseenter"+this._eventNamespace,"."+this._CLASS.HANDLE,this._onThumbEnter.bind(this)).on("mouseleave"+this._eventNamespace,"."+this._CLASS.HANDLE,this._onThumbLeave.bind(this)).on("focusin"+this._eventNamespace,this._onFocus.bind(this)).on("focusout"+this._eventNamespace,this._onFocusout.bind(this))},_onFocus:function(){this.container.addClass("has-focus"+(this._mouseActive?"":" on-tabfocus")),this._trigger("ONFOCUS")},_onFocusout:function(){var e=this;clearTimeout(this.blurtimer),this.blurtimer=setTimeout(function(){t(e._handles).is(":focus")||t(document.activeElement).closest(".zslider").length||(e.container.removeClass("is-active on-tabfocus has-focus"),t(e._activeHandle).removeClass("is-active"),e._mouseActive=e._animate=!1,e._trigger("ONBLUR"))},1)},_onThumbEnter:function(e){if(!this.container.hasClass(this._CLASS.DISABLED)){var i=t(e.target).closest("."+this._CLASS.HANDLE);i.addClass("on-mouseover"),this._showTip(e)}},_onThumbLeave:function(e){if(!this.container.hasClass(this._CLASS.DISABLED)){var i=t(e.target).closest("."+this._CLASS.HANDLE);i.removeClass("on-mouseover"),!this._dragStarted&&!this._dragSelectionStarted&&this._hideTip()}},_showTip:function(e){var t=this.options;"fixed"!==t.valuesType&&"never"!==t.showTooltip&&this._tooltip&&(this._tooltip[0].style.display="","at-cursor"===t.tooltip.position&&e&&("vertical"===t.orientation?this._tooltip[0].style.top=Math.max(Math.min(e.pageY-this.container.offset().top,this.sliderDim.outerHeight),0)+"px":this._tooltip[0].style.left=Math.max(Math.min(e.pageX-this.container.offset().left,this.sliderDim.outerWidth),0)+"px"))},_hideTip:function(){"always"!==this.options.showTooltip&&this._tooltip&&(this._tooltip[0].style.display="none")},_keyPress:function(t){var i,o=t.keyCode;if(o===e.keyCode.HOME)i=this.options.minValueAllowed;else if(o===e.keyCode.END)i=this.options.maxValueAllowed;else if(o===e.keyCode.RIGHT||o===e.keyCode.UP||o===e.keyCode.PAGE_UP)i=this._increase(this.options.value);else{if(o!==e.keyCode.LEFT&&o!==e.keyCode.DOWN&&o!==e.keyCode.PAGE_DOWN)return;i=this._decrease(this.options.value)}return t.preventDefault(),i},_getActiveHandle:function(){return this._handles[0]},_onMouseDown:function(e){this.container.hasClass(this._CLASS.DISABLED)||(this._mouseActive=!0,this.container.removeClass("on-tabfocus").addClass("is-active"),t(this._activeHandle).removeClass("is-active"),this._activeHandle=this._getActiveHandle(e),t(this._activeHandle).addClass("is-active"),!this.options.blurOnRelease&&this._activeHandle.focus(),t(e.target).closest(".zslider__thumb").length||this._onSlide(e),this._bindDocumentEvent(e))},_bindDocumentEvent:function(t){e.$document.off(this._eventNamespace).on("mousemove"+this._eventNamespace,this._onSlide.bind(this)).on("mouseup"+this._eventNamespace,this._onSlideEnd.bind(this)),t.preventDefault()},_onSlide:function(e){if(!this.container.hasClass(this._CLASS.DISABLED)){var t=this._getValueFromEvent(e);this._showTip(e),void 0!==t&&(this._animate="mousemove"!==e.type,this._dragStarted||(this._storeInitialValue(),this._dragStarted=!0,this._trigger("ONSLIDESTART",e)),this._setValue(t,e),this._trigger("ONSLIDE",e),e.preventDefault())}},_onSlideEnd:function(i){this.container.hasClass(this._CLASS.DISABLED)||(e.$document.off(this._eventNamespace),this._dragStarted&&(this._trigger("ONSLIDEEND",i),this._isChangeInValue()&&this._updateLayout(i)),!t(this._activeHandle).hasClass("on-mouseover")&&this._hideTip(),this.container.removeClass("is-active"),this._animate=this._mouseActive=this._dragStarted=!1)},_storeInitialValue:function(){this._startValue=this.getValue()},_isChangeInValue:function(){return this._startValue!==this.getValue()},_getValueFromEvent:function(e){var i=t(e.target);if("mousedown"===e.type&&i.hasClass("zslider__label")){if(i.hasClass("is-disabled"))return;return this._getInnerVal(i[0].getAttribute("data-val"))}if("keydown"===e.type)return this._keyPress(e);var o,a,n,r=this.sliderDim[this.innerDim],s=this.handleDim[this.outerDim],l=r-s,d=1,c=this._innerSlider.offset();if("function"==typeof this.options.getCustomValue&&(n=this.options.getCustomValue,s=0),this.vertical?(o=e.pageY-(c.top+s/2),d=-1,a=1-o/l):(o=e.pageX-(c.left+s/2),a=o/l),0>a?a=0:a>1&&(a=1),n)return n(100*a,this.options.min,this.options.max,this._handles.indexOf(this._activeHandle));var h=this.options.min+a*(this.options.max-this.options.min);return h=this._trimDecimal(this.options.min,this.options.step,h),this.options.snapToTicks&&this._dragStarted&&(h=this._trimForSnap(h,o+s/2)),h},_trimValue:function(e){var t=this.options,i=(parseFloat(e)-t.min)%t.step;if(0!==i){var o=parseFloat(e)-i;2*Math.abs(i)>t.step&&(o+=i>0?t.step:-t.step),e=o}return this._trimDecimal(t.min,t.step,e)},_trimForSnap:function(e,t){if(this._ticksLayout&&this._gridValues&&this._gridValues.length){e=parseFloat(e);for(var i=this._gridValues[0],o=Math.abs(this._gridValues[0]-e),a=1;a<this._gridValues.length;a++){var n=Math.abs(this._gridValues[a]-e);o>n&&(i=this._gridValues[a],o=n)}if(i%this.options.step===0&&i!==e){var r,s=this._ticksLayout.find('[data-val="'+i+'"]');r=this.vertical?s.position().top:s.position().left,Math.abs(r-t)<7&&(e=this._getActualVal(i))}}return e},_trimDecimal:function(e,t,i){var o=String(e).split(".")[1],a=String(t).split(".")[1],n=Math.max(o&&o.length||0,a&&a.length||0);return+(+i).toFixed(n)},_validateProperty:function(){var e=this.options;if("fixed"!==e.valuesType)e.step=parseFloat(e.step),e.min=parseFloat(e.min),e.max=parseFloat(e.max),e.value=parseFloat(e.value),e.minValueAllowed=parseFloat(e.minValueAllowed),e.maxValueAllowed=parseFloat(e.maxValueAllowed),(isNaN(e.step)||e.step<=0)&&(e.step=1),isNaN(e.min)&&(e.min=0),isNaN(e.max)&&(e.max=100),e.max<=e.min&&(e.max=e.min+e.step),e.max-e.min<e.step&&(e.step=e.max-e.min),(isNaN(e.minValueAllowed)||e.minValueAllowed<e.min||e.max-e.minValueAllowed<e.step)&&(e.minValueAllowed=e.min),(isNaN(e.maxValueAllowed)||e.maxValueAllowed>e.max||e.maxValueAllowed<e.minValueAllowed||e.maxValueAllowed-e.minValueAllowed<e.step)&&(e.maxValueAllowed=e.max),isNaN(e.value)||e.value<e.minValueAllowed?e.value=e.minValueAllowed:e.value>e.maxValueAllowed&&(e.value=e.maxValueAllowed);else{e.step=1,e.min=e.minValueAllowed=0,e.max=e.maxValueAllowed=e.values.length-1;var t=this._getInnerVal(e.value);0>t&&(e.value=this._getInnerVal(0))}},_setValue:function(e,t){var i=this.options.value;this.options.value=this._getActualVal(this._getCorrectedValue(e,this.options.minValueAllowed,this.options.maxValueAllowed)),i!==this.options.value&&this._updateLayout(t)},_getCorrectedValue:function(e,t,i){e=+e;var o=this.options;if("fixed"===o.valuesType?(t=o.min,i=o.max):(t<o.min&&(t=o.min),i>o.max&&(i=o.max)),"default"===o.stepBehavior&&(t>=e||e>=i||isNaN(e)))t>e||isNaN(e)?e=t:e>i&&(e=i);else{if(e=this._trimValue(e),t>e||isNaN(e)){var a=(t-o.min)%o.step||o.step;e=t+o.step-a}else e>i&&(e=i-(i-o.min)%o.step);e=this._trimDecimal(o.min,o.step,e)}return e},_setFixedValues:function(){if("fixed"===this.options.valuesType){this._values=[],this._labels=[];var e=this;this.options.values.forEach(function(t){"string"==typeof t||"number"==typeof t?(e._values.push(String(t)),e._labels.push(t)):void 0!==t.value&&(e._values.push(String(t.value)),e._labels.push(t.label||t.value))})}},_getInnerVal:function(e){return"fixed"===this.options.valuesType?this._values.indexOf(String(e)):e},_getActualVal:function(e){return"fixed"===this.options.valuesType?this._values[e]:e},_updateLayout:function(e){var i={},o=this.options,a=function(){this._animate=!1,this._frominit||e&&/(keydown|mousedown|mousemove)/.test(e.type)||this._trigger("ONCHANGE",e)},n=this._getPercent(o.value);i[this.marginDir]=n+"%";var r={},s=0,l=n,d=parseFloat(o.selectionStartValue);!isNaN(d)&&d>o.min&&d<=o.max&&(s=d===o.max?100:this._getPercent(o.selectionStartValue),o.selectionStartValue>=o.value&&(l=[s,s=l][0])),r[this.marginDir]=s+"%",r[this.innerDim]=l-s+"%";var c={"data-val":this._getInnerVal(o.value),"aria-valuenow":this._getInnerVal(o.value),"aria-valuetext":o.value};this._handleAnimation(t(this._handles[0]).attr(c),i),this._handleAnimation(this._range,r,a.bind(this)),this._updateTip(i)},_handleAnimation:function(e,t,i){var o=this.options.animation.slide.duration,a=this.options.animation.slide.className;e.stop();var n="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";this._animate&&(o||a)?a?e.addClass(a).off(n).on(n,function(){e.removeClass(a),i&&i()}):e.animate(t,o,i):(e.css(t),i&&i())},_updateTip:function(e){if(this._tooltip||this._createTooltip(),this._tooltip&&"fixed"!==this.options.valuesType){this._tooltip.find(".ztooltip__content").text(this._getTipText());var t=this._getTipPosition(e);this._handleAnimation(this._tooltip,t)}},_getLabel:function(t,i,o){return i=this._getFormattedLabel(i),"string"==typeof t&&""!==t.trim()&&(i=t.replace(new RegExp("#value#","gi"),i)),o?e.encodeHTML(i):i},_getFormattedLabel:function(e){if("fixed"!==this.options.valuesType&&void 0!==e){var t=this,i=this.options.valueDisplayFormat,o=parseInt(i.decimalPlaces),a=this._getFromLocale("thousandSeparator"),n=this._getFromLocale("decimalSeparator");e=e.toString(),o>=0&&20>=o&&!isNaN(o)&&(e=(+e).toFixed(o));var r=e.split(".");i.thousandSeparator&&(r[0]=r[0].replace(/(\d{1,3}(?=(?:\d\d\d)+(?!\d)))/g,"$1"+(a||","))),e=r.join(n||".");var s=e;"string"==typeof i.prefix?s=i.prefix+s:"currency"===i.type&&(s="#symbol#"+s),"string"==typeof i.suffix&&(s+=i.suffix),s!==e&&(e=s.replace(/#value#/gi,e),"currency"===i.type&&["code","symbol","name"].forEach(function(i){var o=new RegExp("#"+i+"#","gi");if(o.test(s)){var a=t._getFromLocale("currency_"+i,!0);a&&(e=e.replace(o,a))}}))}return e},_resetLocaleData:function(){this._thousandSeparator=this._decimalSeparator=this._currencyData=this._currency_code=this._currency_name=this._currency_symbol=void 0},_getTipText:function(){var e=this.options;return this._getLabel(e.tooltip.text,e.value,!e.tooltip.isHTMLEncoded)},_getTipPosition:function(e){var t={},i=this.options.tooltip.position,o=/^(top|left)$/.test(i)?-1:1,a="outerHeight",n="outerWidth",r="top";/^(left|right)$/.test(i)&&(a="outerWidth",n="outerHeight",r="left");var s=this.sliderDim[a],l=this._tooltip[a](),d=this.pointer?this.pointer[a]():0,c=this.handleDim[a],h=(s>c?0:(c-s)/2)+d+0;return h+=i===r?l:s,t[r]=this._innerSlider.position()[r]+h*o+"px","at-cursor"!==i&&(t["margin-"+this.marginDir]=-(this._tooltip[n]()/2)+"px",t[this.marginDir]=e?e[this.marginDir]:this._handles[0].style[this.marginDir]),t},_createTooltip:function(){var e=this.options;if("fixed"!==e.valuesType&&"never"!==e.showTooltip){var i=e.tooltip.position;this.pointer=!1;var o={left:"h-right",right:"h-left",top:"h-bottom",bottom:"h-top","at-cursor":"h-top"};"at-cursor"===i&&"onslide"===e.showTooltip?e.tooltip.displayType="box":this.vertical?/^(left|right)$/.test(i)||(i="bottom"===i?"right":"left"):/^(top|bottom)$/.test(i)||(i="right"===i?"bottom":"top"),e.tooltip.position=i,this._tooltip=t("<div class='ztooltip ztooltip--"+("at-cursor"===i?"bottom":i)+"'><div class='ztooltip__content'></div>"+("callout"===e.tooltip.displayType?'<div class="ztooltip__pointer '+o[i]+'"></div>':"")+"</div>").appendTo(this.container),"callout"===e.tooltip.displayType&&(this.pointer=t(this._tooltip[0].querySelector(".ztooltip__pointer")),this.vertical&&this.pointer.css({top:"auto"}),this.pointer[0].style[this.marginDir]="calc(50% - "+this.pointer[this.outerDim]()/2+"px)"),"always"!==e.showTooltip&&this._hideTip()}},_getPercent:function(e){if(e=this._getInnerVal(e),this.options.getCustomPosition)return this.options.getCustomPosition(e,this.options.min,this.options.max);var t=(parseFloat(e)-this.options.min)/(this.options.max-this.options.min),i=this.sliderDim[this.innerDim],o=this.handleDim[this.outerDim];return t=100*(t*(1-o/i)+.5*o/i)},_constructScale:function(){(this.options.showTicks||"fixed"===this.options.valuesType)&&(this._ticksLayout=t("<div>",{"class":this._CLASS.PIPES}).appendTo(this.container),this._constructGrids(),this._constructLabel(),this._positionScale())},_positionScale:function(){if(this.options.showTicks){var e=this.options.ticks.position,i=t(this._handles).add(this._ticksLayout).add(this._labelsLayout);/^(left|top)$/.test(e)?(i.addClass("h-inverted"),this._innerSlider.before(this._labelsLayout,this._ticksLayout)):(i.removeClass("h-inverted"),this._innerSlider.after(this._ticksLayout,this._labelsLayout))}},_constructGrids:function(){var e,i=this,o=this.options,a=this._gridValues=[],n=o.ticks.splitBy;if("fixed"===o.valuesType&&(o.ticks.step=1,n="step"),"step"===n&&o.ticks.step>0){o.ticks.step=parseFloat(o.ticks.step);for(var r=o.min;r<=o.max;r+=o.ticks.step)a.push(i._getActualVal(i._trimDecimal(o.min,o.ticks.step,r)))}else if("random"===n&&Array.isArray(e=this._parseArray(o.ticks.randomValues)))e.forEach(function(e){e=parseFloat(e),!isNaN(e)&&e>=o.min&&e<=o.max&&-1===a.indexOf(e)&&a.push(e)}),this._gridValues=a=a.sort(function(e,t){return+e-+t});else{o.ticks.count=parseInt(o.ticks.count);for(var s=o.ticks.count>1?o.ticks.count:4,l=(o.max-o.min)/(s-1),d=0;s>d;d++){var c;c=0===d?o.min:d===s-1?o.max:this._trimDecimal(o.min,l,d*l+o.min),a.push(c)}}var h="";a.forEach(function(e){var t=i._getPercent(e)+"%";h=h+"<div class='"+i._CLASS.PIPE+"' data-val='"+e+"' style='"+i.marginDir+":"+t+"'></div>"}),this._ticksLayout[0].innerHTML=h,this._ticks=Array.prototype.slice.call(this._ticksLayout[0].children,0);var u=t(this._ticks[0])[this.outerDim]();t(this._ticks).css("margin-"+this.marginDir,-u/2+"px")},_constructLabel:function(){var i=this.options;if(i.showTicks&&i.ticks.showLabels||"fixed"===i.valuesType){this._labelsLayout=t("<div>",{"class":this._CLASS.LABELS}).appendTo(this.container);var o=this._ticks;if(o&&o.length){var a=this,n=this.sliderDim[this.innerDim],r="fixed"===i.valuesType?this._labels:this._parseArray(i.ticks.customLabels),s=[],l=[],d=[],c=this._parseArray(i.ticks.showLabelsFor),h=t("<div>",{"class":this._CLASS.LABEL}).appendTo(this._labelsLayout),u=function(e){h.text(e),d.push(h[a.outerDim]()+1),s.push(e)};if(Array.isArray(r)&&r.length)for(var m=0,p=0;p<o.length&&m!==r.length;p++){var g=o[p].getAttribute("data-val");if(!Array.isArray(c)||!c.length||c.indexOf(g)>-1){var _=r[m++];u(i.ticks.isLabelHTMLEncoded?_:e.encodeHTML(_)),l.push(o[p])}}else l=o,o.forEach(function(e){var t=e.getAttribute("data-val");(!Array.isArray(c)||!c.length||c.indexOf(t)>-1)&&u(a._getLabel(i.ticks.labelPattern,t,!i.ticks.isLabelHTMLEncoded))});if(h.remove(),l.length){if(this.vertical)l.forEach(function(e,i){var o=t('<div class="'+a._CLASS.LABEL+'" data-val="'+e.getAttribute("data-val")+'" style="bottom:"'+e.style.bottom+'";">'+s[i]+"</div>").appendTo(a._labelsLayout);o[0].style.bottom="calc("+e.style.bottom+" - "+o[0].offsetHeight/2+"px)"});else{for(var f=60,v="",b=l.length,y=parseInt(t(l[0]).css(this.marginDir))+f,p=0;b>p;p++){var z=t(l[p]),S=t(l[p+1]),w=Math.abs((S.length?parseInt(S.css(this.marginDir)):n+f)-parseInt(z.css(this.marginDir)));S.length&&d[p+1]<w&&(w=Math.abs(w+(w-d[p+1])));var x=Math.min(y,w,d[p]);if(x){y=w+(w-x);var C=a._getPercent(z.attr("data-val"))+"%";C="calc("+C+" - "+x/2+"px)",v=v+"<div  class='"+this._CLASS.LABEL+"' data-val='"+z[0].getAttribute("data-val")+"' style = '"+this.innerDim+":"+x+"px; "+this.marginDir+":"+C+"'>"+s[p]+"</div>"}}this._labelsLayout.append(v)}Array.prototype.slice.call(this._labelsLayout[0].children,0).forEach(function(e){e.offsetWidth<e.scrollWidth&&e.setAttribute("title",e.textContent)})}}}},_increase:function(e,t){return t=t||this.options.step,e=this._getInnerVal(e),e+=t-(e-this.options.min)%t},_decrease:function(e,t){return t=t||this.options.step,e=this._getInnerVal(e),e-=t-(e-this.options.min)%t},_trigger:function(e,t,i){return i=i||{},i.slider=this.getElement(),i.options=this.options,i.value=this.getValue(),this._dispatchEvent(e,t,i,void 0,!!t)},_restoreMeasurements:function(){var e=this;this._MEASUREMENTS.forEach(function(t){e.options[t]=e.actualProps[t]})},_resetValues:function(){this._values=this._labels=void 0,this._setFixedValues(),this._validateProperty(),t(this._handles).attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max}),this._setInitial(),this._resetScale(),this._resetRangeLabels(),this._resetLimitLayout(),this._resetTooltip(),this._positionHandle()},_resetLimitLayout:function(){t(this.container[0].querySelectorAll(".zslider__notallowedrange,.zslider__selected")).remove(),t(this.container[0].querySelectorAll(".zslider__label, .zslider__tick")).removeClass("is-disabled"),this._constructLimitLayout()},_resetScale:function(){this._ticksLayout&&this._ticksLayout.remove(),this._labelsLayout&&this._labelsLayout.remove(),this._ticks=this._ticksLayout=this._labelsLayout=this._gridValues=void 0,this._constructScale(),this._resetLimitLayout(),this._positionHandle()},_resetThumb:function(){t(this._handles).remove(),this._constructThumb()},_resetRangeLabels:function(){this._rangeLayout&&(t(this._innerSlider[0].querySelectorAll(".zslider__rangegroup")).remove(),this.container.removeClass("zslider--range"),this._rangeLayout.remove(),this._rangeLayout=this._rangeBgs=this._rangeTicks=void 0),this._range.show(),this._constructRangeLabels()},_resetTooltip:function(){this._tooltip&&this._tooltip.remove(),this._tooltip=void 0,this._updateTip()},_parseArray:function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}return e},_setAttribute:function(i,o){this._showHiddenParent();var a=this.options;switch(i){case"disabled":a[i]=!!o,this.container.add(this._handles),o?(this.element[0].setAttribute("disabled","disabled"),this.container.add(t(this._handles).removeAttr("tabIndex").attr("aria-disabled",!0)).addClass(this._CLASS.DISABLED),this._tooltip&&this._tooltip.remove()):(this.element[0].removeAttribute("disabled"),this.container.add(t(this._handles).attr("tabIndex",a.tabIndex).removeAttr("aria-disabled")).removeClass(this._CLASS.DISABLED),"always"===a.showTooltip&&this._resetTooltip());break;case"orientation":/^(horizontal|vertical)$/.test(o)&&(a[i]=o,this.vertical="vertical"===o,this.container[this.vertical?"addClass":"removeClass"](this._CLASS.VERTICAL),this._range.removeAttr("style"),this._shadowTrack.css({left:"auto",top:"auto"}),this._resetThumb(),this._resetValues());break;case"className":"string"==typeof o&&(this.container.removeClass(a[i]).addClass(o),a[i]=o);break;case"min":case"max":case"minValueAllowed":case"maxValueAllowed":case"step":this._restoreMeasurements(),a[i]=o,this._cacheMeasurements(),this._resetValues();break;case"locale":a.locale=o||e.locale,this._resetLocaleData(),this._setAttribute("showTicks",a.showTicks);break;case"selectionStartValue":a[i]=o,this._updateLayout();break;case"value":this.setValue(o);break;case"valuesType":/^(range|fixed)$/.test(o)&&(a[i]=o,"range"===o?a.ticksStep=this.actualProps.ticksStep:this.actualProps.ticksStep=a.ticksStep,this._resetValues());break;case"values":Array.isArray(o)&&(a[i]=o,this._resetValues());break;case"showTooltip":a[i]=o,this._resetTooltip();break;case"tooltip":var n;Object.keys(o).forEach(function(e){/^(position|displayType|text|isHTMLEncoded)$/.test(e)&&(a.tooltip[e]=o[e],n=!0)}),n&&this._setAttribute("showTooltip",a.showTooltip);break;case"ticks":var n;Object.keys(o).forEach(function(e){/^(splitBy|step|count|randomValues|position|showLabels|showLabelsFor|customLabels|labelPattern|isLabelHTMLEncoded)$/.test(e)&&(a.ticks[e]=o[e],n=!0)}),n&&this._setAttribute("showTicks",a.showTicks);break;case"valueDisplayFormat":var n;Object.keys(o).forEach(function(e){/^(type|decimalPlaces|thousandSeparator|pattern)$/.test(e)&&(a.valueDisplayFormat[e]=o[e],n=!0)}),n&&(this._resetLocaleData(),this._setAttribute("showTicks",a.showTicks));break;case"rangeGroups":var n;Object.keys(o).forEach(function(e){/^(groups|isLabelHTMLEncoded|labelPosition)$/.test(e)&&(a.rangeGroups[e]=o[e],n=!0)}),n&&(this._resetRangeLabels(),this._positionHandle());break;case"width":a[i]=o,this.container.width(o),this._resetThumb(),this._resetValues();break;case"showTicks":case"thumbIconStyle":case"thumbSVGIconId":case"thumbIconClassName":a[i]=o,this._resetThumb(),this._resetValues();break;default:a[i]=o}this._resetParent()},increase:function(e){this._setValue(this._increase(this.options.value),e)},decrease:function(e){this._setValue(this._decrease(this.options.value),e)},setValue:function(e,t){void 0!==e&&(e=this._getInnerVal(e),this._setValue(e,t))},getValue:function(){return this.options.value},destroy:function(){this.container.remove(),this.element.show().removeData(this.options.widgetEventPrefix)},setAttribute:function(e,t){t="string"==typeof t?t.trim():t,t!==this.options[e]&&this._setAttribute(e,t)}};e.registerComponent("zslider",i),e.createSlider=function(e){if("object"==typeof e){var i=t("#"+e.id);if(i.length){if(i.data("zslider"))return i}else i=t("<input>").appendTo(t(e.appendTo).length?e.appendTo:"body").attr({id:e.id,style:e.style,title:e.title,tabIndex:e.tabIndex});return i.zslider(e),i}}}(ZComponents),function(e){function t(){s._text=document.createElement("span"),s._label=document.createElement("label"),s._arrow=document.createElement("i"),s._text.className="zbutton__text",s._arrow.className="zbutton__icon h-floatright"}function i(e){var t=e.tagName?e.tagName:"button",i=document.createElement(t);return i.setAttribute("id",e.id),e.customAttributes&&o(i).attr(e.customAttributes),e.appendTo&&o(e.appendTo)[0].appendChild(i),o(i)[e.componentName](e)}var o=e.DOMUtil,a={options:{appearance:"normal",text:void 0,icon:void 0,iconClassName:void 0,SVGIconId:void 0,size:"medium",disabled:!1,checked:!1,actionInProgress:!1,progressIndicator:{type:"circular",position:"left",direction:"left-to-right",loadingText:"",value:5,iconClassName:void 0,SVGIconId:void 0},constructButton:!0,className:""},attributeList:["data-appearance","data-icon","data-text","data-size","data-disabled","disabled","data-action-in-progress","data-progress-indicator"],_EVENTS:{CLICK:"click",CHANGE:"change",STATECHANGE:"statechange"},_CIRCLEX:{medium:"8px",large:"10.5px",small:"7.5px",mini:"7px"},_CIRCLEY:{medium:"8px",large:"10.5px",small:"7.5px",mini:"7px"},_CIRCLER:{medium:"7",large:"9.5px",small:"6.5px",mini:"6px"},_create:function(){void 0===s._text&&t(),this.options.icon=this.options.icons&&this.options.icons.primary||this.options.icon,this.options.disabled=this.options.disabled||this.element[0].disabled,this.options.checked=this.options.checked||this.element[0].checked,this.element[0].setAttribute("role","button"),this.container="INPUT"===this.element[0].tagName?this._getLabelElement(this.element):this.element,this.options.constructButton&&this._construct(),this.element[0].type||(this.element[0].type="button"),this._checkAndDisable(),this._bindEvents(),this._handleFocus()},_construct:function(){if(this.options.text=this.options.text?this.options.text:this.options.label?this.options.label:this.element.text().trim(),this.options.text&&""!==this.options.text){var e=s._text.cloneNode();e.textContent=this.options.text,this.container[0].innerHTML="",this.container[0].appendChild(e)}(this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&this._setIcons(),this.container[0].className+=" zbutton "+("normal"!==this.options.appearance?"zbutton--"+this.options.appearance:"")+" zbutton--"+this.options.size+" "+this.options.className,this.container[0].setAttribute("aria-label",this.options.text?this.options.text:this.element.attr("title"))},_setIcons:function(){if(!this.options.actionInProgress||!this.container.find(".zeffects--rotate").length){this.container.find(".zbutton__mainicon").remove();var e=o("<i class='zbutton__icon zbutton__mainicon '></i>"),t=this._handleIcon(e,void 0,void 0,this.options.iconClassName,this.options.SVGIconId,this.options.icon);this.container.prepend(t),(this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&""===this.options.text&&(this.container[0].className+=" zbutton--icononly")}},_bindEvents:function(){var t=this,i=this.componentName;if(this.container.on("click."+i,function(e){t._handleButtonClick(e),t._mouseup=!0}),this._input){var t=this;this.container.off("keydown."+i).on("keydown."+i,function(i){if(i.keyCode===e.keyCode.ENTER||i.keyCode===e.keyCode.SPACE)t.container.trigger("click"),i.preventDefault();else if(i.keyCode===e.keyCode.LEFT||i.keyCode===e.keyCode.DOWN){var a=t._input.attr("name"),n=t._input.prevAll("input[type=radio][name="+a+"]")[0];n||(n=t._input.nextAll("input[type=radio][name="+a+"]:last")),o("label[for='"+o(n).attr("id")+"']").trigger("click").trigger("focus")}else if(i.keyCode===e.keyCode.RIGHT||i.keyCode===e.keyCode.UP){var a=t._input.attr("name");n=t._input.nextAll("input[type=radio][name="+a+"]")[0],n||(n=t._input.prevAll("input[type=radio][name="+a+"]:last")),o("label[for='"+o(n).attr("id")+"']").trigger("click").trigger("focus")}})}window.ZShortCut&&ZShortCut.register(this.element)},_handleButtonClick:function(e){this.container.hasClass("is-disabled")||(this.options.actionInProgress&&this.showProgressIndicator(),this.container.is("label")&&this._check(!0,e),this._dispatchEvent("CLICK",e,{button:this.element}))},_checkAndDisable:function(){this.options.disabled?(this.container.addClass("is-disabled").attr({"aria-disabled":!0}),this.container.attr("disabled")||this.container[0].setAttribute("disabled",!0)):(this.container.removeClass("is-disabled").removeAttr("aria-disabled"),this.container.attr("disabled")&&this.container.removeAttr("disabled")),this._dispatchEvent("STATECHANGE",{},{button:this.element,disabled:this.options.disabled}),this.options.checked?(this.container.addClass("is-selected").prop("checked",!0).attr("aria-checked",!0),this._input.prop("checked",!0)):(this.container.removeClass("is-selected").removeAttr("checked aria-checked").prop("checked",!1),this._input&&this._input.prop("checked",!1))},_check:function(e,t){if(!this.container.hasClass("is-disabled")){var i=this._input.attr("name"),a=o("input[type=radio][name="+i+"]");e&&"radio"==this._input[0].type&&a.each(function(e,t){o(t).prop("checked",!1).next("label").prop("checked",!1),o(t).next(".zbutton").removeClass("is-selected"),o(t).data("zbutton").options.checked=!1}),"radio"===this._input[0].type?this.options.checked=e:this.container.prop("checked")||!e?this.options.checked=!1:e&&(this.options.checked=e),this._checkAndDisable(),t&&this._dispatchEvent("CHANGE",t,{button:this.element})}},_getLabelElement:function(e){var t=e.next("label");return t.length||(t=o("<label>").text(this.options.text).insertAfter(e),this._labelCreated=!0),t.attr({"for":e.attr("id"),tabindex:void 0!==this.element.attr("tabindex")?this.element.attr("tabindex"):0,"class":e.attr("class"),title:e.attr(e.attr("title")?"title":"data-title"),role:e[0].type}),this._input=e.addClass("h-dnone"),t},_createLoaderElement:function(t){var i=o("<i class='zbutton__icon "+("right"!==t||this.container.is(".zbutton--icononly")?"":"h-floatright")+"'></i>"),a=this.options.progressIndicator,n=a.SVGIconId,r=a.iconClassName;if(n||r)this._handleIcon(i,void 0,void 0,r,n);else{var s=e.createSVGElement("svg",{"class":"zbutton__svg zbutton__loader zeffects--rotate"},[{circle:{"class":"circle__track",cx:this._CIRCLEX[this.options.size],cy:this._CIRCLEY[this.options.size],r:this._CIRCLER[this.options.size]}},{circle:{"class":"circle__load",cx:this._CIRCLEX[this.options.size],cy:this._CIRCLEY[this.options.size],r:this._CIRCLER[this.options.size]}}]);i[0].appendChild(s)}return i},setProgressValue:function(e){this._progressElement&&(e>100&&(e=100),this._progressElement.css("width",parseInt(e)+"%"),this.options.progressIndicator.value=e)},getProgressValue:function(){return this._progressElement?100*parseFloat(this._progressElement.outerWidth(!0)/(this.element.outerWidth(!0)-2*parseInt(this.element.css("border")))):0},showProgressIndicator:function(e){var e=e||{},t=this.options.progressIndicator,i=e.type||t.type,a=e.position||t.position,n=e.direction||t.direction,r=e.loadingText||t.loadingText,s=e.value||t.value;this.container.find(".zbutton__loader").length||("circular"===i?((this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&("left"===a||this.container.is(".zbutton--icononly"))&&this.container.find("i:first").remove(),this.container.prepend(this._createLoaderElement(a))):"linear-bar"===i?(this._progressElement=o("<span class='"+("top"===a?"zbutton__topline":"zbutton__bottomline")+"'/>"),this.setProgressValue(s)):"linear-fill"===i&&(this._progressElement=o("<span class='"+("right-to-left"===n?"zbutton__bgprogress--fromright":"zbutton__bgprogress")+"'/>"),this.setProgressValue(s)),""!==r&&this.container.find(".zbutton__text").text(r),this.container.append(this._progressElement).addClass("is-disabled zbutton--loading h-transition"),this.options.actionInProgress=!0)},hideProgressIndicator:function(){this._progressElement&&(this._progressElement.remove(),this._progressElement=void 0),this.options.icon||this.options.iconClassName||this.options.SVGIconId?(this.container.find(".zbutton__icon").remove(),this.container.find(".zbutton__icon").length||this._setIcons()):this.container.find(".zbutton__icon").remove(),this.container.removeClass("zbutton--loading h-transition"),this.options.disabled||this.container.removeAttr("disabled").removeClass("is-disabled"),this.options.text?this.container.find(".zbutton__text").text(this.options.text):(this.container.find(".zbutton__text").remove(),(this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&this.container.addClass("zbutton--icononly"))},destroy:function(){return this._super(),this.container.off("."+this.componentName).empty().removeClass("zbutton zbutton--icononly is-disabled is-selected"),this.container.off("."+this.componentName),this._input&&(this._input.removeClass("h-dnone").removeData("zbutton"),this._input=void 0,this._labelCreated&&this.container.remove()),this.element.text(this.options.text).removeData("zbutton")},setAttribute:function(e,t){if("appearance"===e&&t!==this.options.appearance)this.container.removeClass("zbutton--"+this.options.appearance).addClass("zbutton--"+t);else if("text"!==e&&"label"!==e&&"data-text"!==e||t===this.options.text)if("size"!==e&&"data-size"!==e||t===this.options.size)if("disabled"===e&&this.options.disabled!==t)"string"==typeof t&&(t="true"===t||"disabled"===t),this.options.disabled=t,this._checkAndDisable();else if("icon"!==e&&"data-icon"!==e&&"iconClassName"!==e&&"SVGIconId"!==e||t===this.options[e]){if("checked"===e&&t!==this.options.checked)this._input&&this._check(t,void 0);else if("actionInProgress"===e&&t!==this.options.actionInProgress)this.options[e]=t,t?this.showProgressIndicator():this.hideProgressIndicator();else if("progressIndicator"===e&&this.options.actionInProgress){var i=this.options;i.progressIndicator=o.extend({},i.progressIndicator,t),this.destroy(),this.element.zbutton(i),this.showProgressIndicator()}}else(this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&this.container.find("i:first").remove(),this.options[e]=t,t&&this._setIcons();else this.options.size&&this.container.removeClass("zbutton--"+this.options.size),this.container.addClass("zbutton--"+t),this.options.actionInProgress&&(t=""===t.trim()||"default"===t?"medium":t,this.container.find(".zbutton__loader circle").attr({cx:this._CIRCLEX[t],cy:this._CIRCLEY[t],r:this._CIRCLER[t]}));else if(this.options.text&&""!==this.options.text)this.options.actionInProgress||(t&&""!==t?this.container.find(".zbutton__text").text(t):(this.container.find(".zbutton__text").remove(),this.container.find("i").length&&(this.options.icon||this.options.iconClassName||this.options.SVGIconId)&&this.container.addClass("zbutton--icononly")));else{var a=o("<span class='zbutton__text'>"+t+"</span>");this.options.actionInProgress||(this.container.find("i").length&&(this.options.icon||this.options.iconClassName||this.options.SVGIconId)?a.insertAfter(this.container.find(".zbutton__icon:first")):a[this.container.find("i").length?"prependTo":"appendTo"](this.container),this.container.removeClass("zbutton--icononly"))}this.options[e]=t}},n={options:{menuId:void 0,delay:0,showArrowIcon:!0,arrowIconClassName:void 0,arrowSVGIconId:void 0,activeClass:"is-selected"},_construct:function(){this._super(),this.element[0].className+=" zbutton--menu",this.element[0].setAttribute("aria-haspopup",!0);var e=s._arrow.cloneNode();if(this.options.showArrowIcon){var t=this.options.splitbutton?"zbutton__svg zbutton__splitarrow":"zbutton__svg zbutton__menuarrow",i={props:{"class":t,viewBox:"0 0 16 16",width:"100%",height:"100%"},nodes:[{polygon:{points:"3.5,6.5 4.5,5.5 8,9 11.5,5.5 12.5,6.5 8,11"}}]};this._handleIcon(o(e),i,"arrow",this.options.arrowIconClassName,this.options.arrowSVGIconId),this.element[0].appendChild(e)}},destroy:function(){this._super(),this.element.off("."+this.componentName).removeClass("zbutton--menu").removeData("zmenubutton").removeAttr("aria-haspopup")},_bindEvents:function(){var t=this,i=this.componentName,a=e.keyCode;this.element.on("mousedown."+i,function(){t.element.hasClass("is-disabled")||t.options.menuId&&o.fn.zmenu&&(t.options.delay?window.setTimeout(function(){t._showHideMenu()},t.options.delay):t._showHideMenu()),t._mouseup=!1}).on("click."+i,function(e){t._dispatchEvent("CLICK",e,{button:t.element}),t._mouseup=!0}).on("keydown."+i,function(e){var i=!1,n=o("#"+t.options.menuId);e.keyCode===a.DOWN||e.keyCode===a.UP||e.keyCode===a.LEFT||e.keyCode===a.RIGHT?(i=!0,n.is(":visible")?n.zmenu("handleKeyCode",e.keyCode,e):(e.keyCode===a.UP||e.keyCode===a.DOWN)&&t._showHideMenu()):(e.keyCode===a.ENTER||e.keyCode===a.SPACE)&&t.options.menuId&&o.fn.zmenu?document.activeElement===t.element[0]&&(i=!0,n.find(".on-hover").length?n.zmenu("handleKeyCode",e.keyCode,e):t._showHideMenu()):(e.keyCode===a.ESCAPE||e.keyCode===a.TAB)&&n.is(":visible")&&(n.find(".on-hover").hasClass("zmenu--submenu")?n.zmenu("handleKeyCode",e.keyCode,e):(n.zmenu("hide"),e.keyCode===a.ESCAPE&&e.stopPropagation())),i&&(e.preventDefault(),e.stopPropagation())}),window.ZShortCut&&ZShortCut.register(this.element)},_showHideMenu:function(){var t=this,i=o("#"+this.options.menuId);!i.is(":visible")||t.options.splitbutton&&i.data("forElement")&&i.data("forElement")[0]!==t.element.closest(".zbutton--split").get(0)||!t.options.splitbutton&&i.data("forElement")&&i.data("forElement")[0]!==t.element.get(0)?(i.zmenu("hide"),i.on("zmenuhide",function(e,i){!t.options.splitbutton&&e.originalEvent&&("mouseup"===e.originalEvent.type?(i&&i.menuitem&&i.menuitem.is(".is-fixed")||t.element.focus(),t.element.removeClass("has-focus")):i&&i.menuitem&&i.menuitem.is(".is-fixed")&&t.element.removeClass("has-focus")),t.element.removeClass(t.options.activeClass)}).on("zmenubeforefocus",function(){return!1}),i.zmenu(),i.zmenu("show",{forElement:t.options.splitbutton?t.element.closest(".zbutton--split"):t.element}),t.element.addClass(t.options.activeClass),e.$window.on("resize."+this.componentName,function(){i.zmenu("hide")})):(t.element.removeClass(t.options.activeClass),i.zmenu("hide"))}},r={_initialShow:!0,attributeList:["data-appearance","data-icon","data-text","data-size","data-disabled","disabled","data-menu-id"],options:{size:"medium",disabled:!1,updateButtonOnMenuItemClick:!0},_create:function(e,t){var i=e.attr("id"),a=void 0,n=e.next(),r=document.createElement("div");this.splitPair=r,r.setAttribute("class","zbutton--split "+t.className),r.setAttribute("role","splitbutton"),"primary"!==t.appearance&&(r.className+=" zbutton--splitnormal"),i&&(r.setAttribute("id",i+"Container"),a=i+"DropDown"),e[0].parentNode.insertBefore(r,e[0]),!t.menuId&&n.length&&"BUTTON"===n[0].tagName?n=n[0]:(n=document.createElement("button"),n.setAttribute("id",a)),this.menuButton=o(n),n.setAttribute("class","zbutton--icononly");var s={appearance:t.appearance,size:t.size,disabled:void 0!==t.disabled?t.disabled:!1,delay:t.delay,splitbutton:!0,showArrowIcon:t.showArrowIcon,arrowIconClassName:t.arrowIconClassName,arrowSVGIconId:t.arrowSVGIconId};r.appendChild(e[0]),r.appendChild(n),t.menuId&&n.setAttribute("data-menu-id",t.menuId),e.disabled&&n.setAttribute("disabled",!0),t.splitbuttonAttributes&&o(n).attr(t.splitbuttonAttributes),t.appData&&(s.appData=t.appData),e.removeAttr("data-menu-id"),t.className="",e.attr("title")&&r.setAttribute("title",e.attr("title")),e.removeAttr("title"),e.zbutton(t),this.element=e,o(n).zmenubutton(s),this.options=t,this._bindEvents(),this.container=o(this.splitPair)},_bindEvents:function(){var e=this,t=o("#"+this.options.menuId);this.element.off("click.zbutton"),o(this.splitPair).off("click.zbutton").on("click."+this.componentName,function(i){var a=o(i.target).closest(".zbutton"),n={dropdownButton:e.menuButton};a.hasClass("zbutton--menu")?n.isMenuButton=!0:o.fn.zmenu&&t.zmenu("hide"),e._dispatchEvent("CLICK",i,n)}),window.ZShortCut&&(ZShortCut.register(this.element),ZShortCut.register(this.menuButton)),t.on("zmenubeforeshow",function(){e.options.updateButtonOnMenuItemClick&&e._initialShow?e._hideMenuItem(e.options.menuId,!0):o.noop}).on("zmenushow",function(i,o){if(t.data("forElement")[0]==e.splitPair){var a=o.menu.attr("class");a.match("top")?(e.element.css("border-bottom-left-radius",window.getComputedStyle(e.splitPair,null).borderBottomLeftRadius),e.menuButton.css("border-bottom-right-radius",window.getComputedStyle(e.splitPair,null).borderBottomRightRadius)):a.match("bottom")&&(e.element.css("border-top-left-radius",window.getComputedStyle(e.splitPair,null).borderTopLeftRadius),e.menuButton.css("border-top-right-radius",window.getComputedStyle(e.splitPair,null).borderTopRightRadius)),e._initialShow=!1}}).on("zmenuhide",function(){e.element.css({"border-bottom-left-radius":"","border-top-left-radius":"","border-bottom-right-radius":"","border-top-right-radius":""}),e.menuButton.css({"border-bottom-right-radius":"","border-top-right-radius":"","border-top-left-radius":"","border-bottom-left-radius":""})}),this.options.updateButtonOnMenuItemClick&&t.on("zmenuitemclick",function(i,o){var a=o.menu.data("zmenu").options,n=a.contentType,r=(e.options.icon||e.options.iconClassName||e.options.SVGIconId)&&e.element.data("zbutton").options.text?"icon-text":e.options.icon||e.options.iconClassName||e.options.SVGIconId?"icon":"text";n===r&&(e._hideMenuItem(e.options.menuId,!1),t.zmenu("hideMenuItems",[o.menuitem]),(e.options.icon||e.options.iconClassName||e.options.SVGIconId)&&e.setAttribute("icon",o.data.icon),e.element.data("zbutton").options.text&&e.setAttribute("text",o.data.label),e._dispatchEvent("CHANGE",i,o))})},_hideMenuItem:function(e,t){for(var i=o("#"+e),a=this.element.data("zbutton").options.text,n=this.options.icon||this.options.iconClassName||this.options.SVGIconId,r=i.find("li"),s=0;s<r.length;s++){var l=this.getData(r[s]),d=l.icon&&n?0===l.icon.indexOf(n):!0,c=l.label&&a?l.label===a:!0;d&&c&&i.zmenu(t?"hideMenuItems":"showMenuItems",[r[s]])}},getElement:function(){return o(this.splitPair)},setAttribute:function(e,t){return("disabled"===e||"menuId"===e||"data-menu-id"===e||"size"===e||"data-size"===e||"appearance"===e||"data-appearance"===e&&this.options[e]!==t)&&(o(this.menuButton).zmenubutton("setAttribute",e,t),"appearance"===e&&o(this.splitPair)["primary"===t?"removeClass":"addClass"]("zbutton--splitnormal")),this.options[e]=t,this.element.zbutton("object"==typeof e?"setAttributes":"setAttribute",e,t)},destroy:function(){this._super(),o(this.menuButton).remove(),this.element.unwrap().zbutton("destroy").removeData("zsplitbutton")}},s={};e.createButton=function(e){return e.componentName="zbutton",i(e)},e.createSplitbutton=e.createSplitButton=function(e){return e.componentName="zsplitbutton",i(e)},e.createMenubutton=e.createMenuButton=function(e){return e.componentName="zmenubutton",i(e)},e.createUploadbutton=e.createUploadButton=function(e){return e.componentName="zuploadbutton",e.tagName="input",e.customAttributes=e.customAttributes?e.customAttributes:{},e.customAttributes.type="file",i(e)},e.registerComponent("zbutton",a),e.registerComponent("zmenubutton",o.zbutton,n),e.registerComponent("zsplitbutton",o.zbutton,r)}(ZComponents);var ZAnnotator=function(e){var t={"select.label":"Select","done.label":"Done","cancel.label":"Cancel","ellipse.label":"Ellipse","rectangle.label":"Rectangle","pencil.label":"Marker","marker.label":"Highlighter Pen","highlightingTools.label":"Highlighting Tools","taggingTools.label":"Tagging Tools","concealInfo.label":"Concealing Tools","arrow.label":"Arrow","line.label":"Line","arrowline.label":"Arrow & Line","text.label":"Text","warning.label":"Warning","numbering.label":"Numbering","correct.label":"Correct","wrong.label":"Wrong","unclear.label":"Unclear","hideInfo.label":"Hide Info","blur.label":"Blur","smudge.label":"Smudge","crop.label":"Crop","zoomOut.label":"Zoom Out","zoomIn.label":"Zoom In","actualSize.label":"Actual Size","fitToScreen.label":"Fit to Screen","fitToWidth.label":"Fit To Width","yellow.label":"Yellow","red.label":"Red","green.label":"Green","orange.label":"Orange","fontSize.label":"Font Size","fontColor.label":"Text Color","textOutline.label":"Text Outline","fillColor.label":"Fill Color","borderColor.label":"Border Color","borderWidth.label":"Border Style & Thickness","lineColor.label":"Line Color","lineWidth.label":"Line Style & Thickness","solid.label":"Solid","dashed.label":"Dashed","paste.label":"Paste","copy.label":"Copy","ok.label":"OK","yes.label":"Yes","no.label":"No","bringToFront.label":"Bring To Front","sendToBack.label":"Send To Back","bringForward.label":"Bring Forward","moveBackward.label":"Move Backward","undo.label":"Undo","redo.label":"Redo","imageSaveAlert.label":"An unexpected error has occurred. Please retry.","unexpectedError.label":"Unexpected Error","closeWarningMessgae.label":"Are you sure you want to discard the changes?","closeWarningMessgae2.label":"You will lose the changes you\u2019ve made.","noFill.label":"No Fill","noColor.label":"No Color","opacity.label":"Opacity","10Percent.label":"10%","25Percent.label":"25%","50Percent.label":"50%","75Percent.label":"75%","100Percent.label":"100%","125Percent.label":"125%","150Percent.label":"150%","200Percent.label":"200%","pink.label":"Reddish Pink","blue.label":"Blue","violet.label":"Violet","white.label":"White","brown.label":"Brown","black.label":"Black","discardChanges.label":"Discard Changes","initalisingBlur.label":"Initialising Blur..."},i={widgetEventPrefix:"zimagedit",_EVENTS:{},options:{showImageName:!0},_create:function(o){o.imageID=o.target,o.keys=e.extend({},t,o.keys),this.options=o,i.options.isContinuousDraw=!0,this._toolSelected=!1,this._drag=!1,i.textareaCreatedElements=[],this.previousFillColor="none",this.previousBorderColor="#ff004e",this.previousNumberingColor="#226cfb",this.previousOpacity=100,this.previousBorderThickness=3,this.currentValueForNumbering=1,this.isDraw=!1,this.ctrlKeyPressed=!1,this.multiSelectFlag=!1,this.shiftKeyPressed=!1,this.smudgeStack=[],this.smudgeStackFlag=!1,this.smudgeStackPosition=0,this.undoStack=[],this.tempStack=[],this.redoStack=[],this.lastHover=void 0,this.numberingColor={tick:"#01be13"},this.imageType="image/png",void 0!==o.imageType&&""!==o.imageType&&(this.imageType=o.imageType),this.cropAreaCanvasPosition=[],this.isImageCropped=!1,this.textareaSelected=!1,i.textareaBorderWidth=1.5,this.fitToWidthZoomValue=100,this.previousZoomValue=100,this.numberingTagSelected="numbering",this.boundaryClicked=[],this._checkFlagMouseAction=!1,this.targetAction="",this.resize_flag=!0,i._noOfIdSelected=[],this.borderWidth=3,this.stackPushFlag=!1,this._crop_arr=[],this.textareaList=[],this.cropCreated=!1,this.drawnElements=[],this.cropSelected=!1,this.lastAction="",this._bodyObj=e("body"),this._triggerEvent(this._EVENTS.ONOPEN),this._overalObj={action:"create/move/resize/delete/change/addtext",object:"Circle/Blackout/Rectangle/Text",id:"<object-id>",property:{color:"000"}},this._imageOrginalHeight=this._imageHeight,void 0===this.options.showLoader&&this._bodyObj.append('<div class="zimageeditor__loadercont" id="zimageeditor__loadercont" style="visibility="visible""><svg class="zimageeditor__loader zimageeditorloader__rotate"><circle class="zimageeditor__circle--track" cx="24" cy="24" r="20" stroke-dasharray="0" stroke-dashoffset="0" stroke-width="4"></circle><circle class="zimageeditor__circle--load" cx="24" cy="24" r="20" stroke-dasharray="94.29" stroke-dashoffset="55" stroke-width="4"></circle></svg></div>'),this._constructLayout();var a=new Image,n=o.imageURL;void 0===n&&(n=e("#"+o.imageElementId).attr("src")),a.src=n,a.onload=function(){i.inputImageId=o.imageElementId,i._imageWidth=parseFloat(e(this).prop("naturalWidth")),i._imageHeight=parseFloat(e(this).prop("naturalHeight")),e("#zimageeditor__sourceImage").remove(),e(".zimageeditor__actions").show(),e("body").append(a),e(a).attr("id","zimageeditor__sourceImage").css("display","none"),i.inputImageId="zimageeditor__sourceImage",i._currImg=e("#zimageeditor__sourceImage")[0],i._constructLayout(),i._createCanvas(),e("#zimageeditor__btns--select").addClass("zimageeditor__btns--active"),i.handleOpenAnimation(),i.createToolsAndProperties(),i._editActions(),i.initMouseFunction(),i.initFunction(o.imageID),i._touchInit(),e(".zimageeditor__footer").css("background","#222327"),i._selectedTool="none","function"==typeof i.options.onLoad&&i.options.onLoad(),e(".zimageeditor__overlay").css("background","#3d3f44"),"extension"===i.options.annotatorType&&(e("#zimageeditor .zimageeditor__cancel").text(i._getString("discardChanges.label")),e("#zimageeditor .zimageeditor__cancel").attr("disabled",!0)),e("#zimageeditor .zimageeditor__cancel").on("click",function(){-1===e(this).attr("class").indexOf("zimageeditor__crop--cancel")&&i.close()})},this.finalCropPosition=[0,0,0,0,0],this.propertiesOfObjects=[[]],this.propertiesOfObjects[0]=["ellipse",!0,!0,!0,!1,!1,!1,!1],this.propertiesOfObjects[1]=["rectangle",!0,!0,!0,!1,!1,!1,!1],this.propertiesOfObjects[2]=["pencil",!1,!0,!0,!1,!1,!1,!1],this.propertiesOfObjects[3]=["marker",!1,!1,!1,!1,!1,!1,!1],this.propertiesOfObjects[4]=["numbering",!1,!1,!1,!1,!1,!1,!0],this.propertiesOfObjects[5]=["arrow",!1,!0,!0,!1,!1,!1,!1],this.propertiesOfObjects[6]=["text",!1,!1,!1,!0,!0,!0,!1],this.PropertiesAvailableForMultiSelect=[!0,!0,!0,!0,!0,!0,!0],this.zoomScaleValue=1,this.dragOnly=!1,this.isNumberingBeackSelected=!1,this.toolBarMoved=!1,this.propertiesBarMoved=!1,this.row_val=0,this.col_val=0,this.temp_id=0,this.polyline_points="",this.clickPosition=[],i.textFontSize=20,i.defaultMarkerOpacity=.4,i.textFontColor="#8b23d5",i.textFontShadow=!0,i.cropCaptureCount=0,i.isFitToScreen=!0,i.numberingQuestionColor="#fe9300",i.arrowStrokeColor="#ff004e",i.blurPosition=[],i.blurPositionLength=0,i.cropPosition=[],i.propertiesLeft="47%",i.propertiesTop="10px",i.cropPosition[0]="none",i.smudgeBrushSize=20,i.numberingTagElements=[],i.svgPath="http://www.w3.org/2000/svg"},_constructLayout:function(){e("#zimageeditor").length||(this.shapesMenu=void 0,this.createMainDiv(),this.checkForIE(),this.createFooter(),this.createToolSection(),this.createHeader(),this._imageContainer=e("#zimageeditor")),i.editorSVG=document.getElementById("zimageeditor__svgeditor")},handleOpenAnimation:function(){e(".zimageeditor__done, .zimageeditor__cancel").addClass("zimageeditor__transistionHeaderShow").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){e(this).removeClass("zimageeditor__transistionHeaderShow")}).css("visibility","visible"),e(".zimageeditor__footer").addClass("zimageeditor__transistionZoomShow").css("display","inherit"),e(".zimageeditor__tools").addClass("zimageeditor__transistionToolShow").css("display","inherit"),e("#zimageeditor .zimageeditor__transistionToolShow").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){e(this).removeClass("zimageeditor__transistionToolShow"),e("#zimageeditor .zimageeditor__tools").css("display","block")}),e("#zimageedit-ele-canvas").css("visibility","visible")},_createCanvas:function(){e("#zimageeditor__loadercont").remove(),e("#zimageeditor__container").remove();var t=e("<div/>",{id:"zimageeditor__wrapper","class":"zimageeditor__wrapper"});e(this._imageContainer).append(t);var o=e("<div/>",{id:"zimageeditor__container","class":"zimageeditor__container"});t.append(o),i.editContainer=o;var a,n,r,s,l,d,c=e(window).width(),h=e(window).height(),u=e("<div/>",{id:"zimageeditor__image","class":"zimageeditor__image",width:this._imageWidth,height:this._imageHeight});a=r=110,n=85,"fullpage"===this.options.captureType?(l=c-220,d=this._imageHeight,e("#zimageeditor__container").css("overflow","auto"),e("#zimageeditor__container").css("overflow-x","hidden")):(l=c-220,d=h-150,d>this._imageHeight&&(d=this._imageHeight),l>this._imageWidth&&(l=this._imageWidth));var m,p,g=Math.min(l/this._imageWidth,d/this._imageHeight);m=this._imageWidth*g,p=this._imageHeight*g,r=a=(c-m)/2,s=n=(h-p)/2,o.append(u),e(u).css({width:m,height:p,left:a-110,top:0}),this._canvasContainer=u,i.actualHeight=p,i.actualWidth=m,this._aspectRatio=this._imageHeight/i.actualHeight;var _=e("<div/>",{id:"zimageeditor__svgcontainer","class":"zimageeditor__svgcontainer"});o.append(_),e("#zimageeditor__image, #zimageeditor__svgcontainer").css({width:m,height:p,left:a-110>0?a-110:0,top:n-85>0?n-85:0}),i.svgContainer=_,this._svgRendering("zimageeditor__svgeditor","zimageeditor__svgeditor",_[0]),i.editorSVG=document.getElementById("zimageeditor__svgeditor"),i.SVGElement=e("#zimageeditor__svgeditor"),i.SVGElement.attr({width:m,height:p}),this.borders(),this.borderElement=e("#zimageeditor  .zimageedit__active--shape"),this.createPlusMenu(i.SVGElement),i.createBorderForNumbering(),i.removeBorderForNumbering(),i.removePlusAttributes(),i.removeBorderFocus(),this._imageLeft=a,this._imageTop=n,this._imageCanvas=e("<canvas>").attr({id:"zimageedit-ele-canvas","class":"zimageedit-ele-canvas",width:i._imageWidth,height:i._imageHeight}).css({width:this._imageWidth,height:this._imageHeight,visibility:"hidden"}).appendTo(u),e("<canvas>").attr({id:"zimageedit__canvas--blur",width:i._imageWidth,height:i._imageHeight}).css({width:i._imageWidth,height:i._imageHeight}).appendTo(u),i._imageCanvas=e("#zimageedit-ele-canvas"),i.mainCanvas=document.getElementById("zimageedit-ele-canvas"),i.actualWidth=m,i.actualHeight=p,i.draw_image_on_Canvas(),i._imageCropCanvas=e("<canvas>").attr({id:"zimageditCropCanvas","class":"zimageditCropCanvas",width:i._imageWidth,height:i._imageHeight}).css({display:"none",width:i._imageWidth,height:i._imageHeight}).appendTo(u),i.orginalCanvasFitToWidth=parseFloat(i._imageCanvas.css("width")),i.orginalCanvasFitToHeight=parseFloat(i._imageCanvas.css("height")),i.currentZoomValue=100/(i._imageWidth/i.orginalCanvasFitToWidth),i.changeZoomTextValue(i.currentZoomValue),"fullpage"===this.options.captureType&&(i.handleZoomCases(i.currentZoomValue),e("#zimageeditor__container").scrollTop(0),e("#zimageeditor__container").css("overflow-x","hidden"))},draw_image_on_Canvas:function(){i._imageCanvas.attr({width:i._imageWidth,height:i._imageHeight});var e=i.mainCanvas;i._ctx=e.getContext("2d"),i._ctx.drawImage(this._currImg,0,0,i._imageWidth,i._imageHeight),e=document.getElementById("zimageedit__canvas--blur"),i._ctx2=e.getContext("2d"),i.orgin_ctx2=e.getContext("2d"),i._ctx2.drawImage(this._currImg,0,0,this.actualWidth,this.actualHeight),i._imageCanvas.css({width:i.actualWidth,height:i.actualHeight}),i.orginalRatio=i._imageWidth/i.actualWidth},_svgRendering:function(t,o,a){this._svgns=i.svgPath,this._svg=document.createElementNS(this._svgns,"svg"),this._svg.setAttribute("class",t),this._svg.setAttribute("id",o);var n="0 0 "+i.actualWidth+" "+i.actualHeight;this._svg.setAttribute("viewBox",n),a.appendChild(this._svg),i.line_marker("zimageedit__triangle"),e("#zimageedit__triangle").css("visibility","hidden")},_svgElements:function(e,t,o){var a;a=o?o:document.createElementNS(i.svgPath,e);for(var n in t)a.setAttribute(n,t[n]);return a},createMainDiv:function(){var t=e("<div>",{"class":"zimageeditor",id:"zimageeditor"});e("body").append(t);var o=e("<div/>",{"class":"zimageeditor__overlay"}).css("background","transparent");e(o).appendTo(t),i.main_div=t,i._mainContainer=t},checkForIE:function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE"),o=e.indexOf("Edge"),a=e.indexOf("Trident");i.isIEBrowser=t>0||o>0||a>0?!0:!1,i.isSafari=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&!navigator.userAgent.match("CriOS"),i.isWindowsOS=!1,-1!==window.navigator.platform.toUpperCase().indexOf("WIN")&&(i.isWindowsOS=!0),i.isMacOS=-1!==navigator.platform.toUpperCase().indexOf("MAC")},createHeader:function(){var t,o=e("<div/>",{"class":"zimageeditor__header zimageeditor__header--bg"});e(i.main_div).append(o),i.options.showImageName&&(t=e("<div/>",{"class":"zimageeditor__imgname"}),e(o).append(t),e(t).text(i.options.imageName)),t=e("<div/>",{"class":"zimageeditor__actions"}).css("visibility","hidden"),e(o).append(t);var a={className:"zimageeditor__done",id:"zimageeditor__done",text:i._getString("done.label"),appendTo:".zimageeditor__actions",updateButtonOnMenuItemClick:!1};a=e.extend({},a,i.options.finishButton),a.ctype=a.type?a.type:"zbutton",a.menu&&a.menu.menuItems&&(ZComponents.createMenu("zimageedit__done--splitMenu",a.menu.menuItems,{appendTo:"#zimageeditor"}),a.menuId="zimageedit__done--splitMenu",e("#zimageedit__done--splitMenu").on("zmenuitemclick",function(e,t){"function"==typeof i.options.onFinish&&i.options.onFinish(t),i.saveFunction()}));var n=ZComponents.create(a),r=e("<button/>",{"class":"zimageeditor__cancel",text:i._getString("cancel.label")});e(t).append(r),n.click(function(){i.cropSelected||("function"==typeof i.options.onFinish&&i.options.onFinish(i.options.finishButton),i.saveFunction())})},createFooter:function(){if(i.isIEBrowser)return!0;var t=e("<div/>",{"class":"zimageeditor__footer zimageeditor__header--bg"}).css("display","none");e(i.main_div).append(t);var o=e("<button/>",{"class":"zimageeditor__btns","data-objectaction":"zoomout",id:"zimageeditor__btns--zoomOut",title:i._getString("zoomOut.label"),"data-title-position":"top"});e(t).append(o);var a=e("<i/>",{"class":"zimageedit__icon--minus"});e(o).append(a);var n=e("<div/>",{"class":"zbutton--split"});o=e("<button/>",{"class":"zimageeditor__btns zimageeditor__zoom","data-objectmenu":"zoom",id:"zimageeditor__zoom"}),e(n).append(o),e(t).append(n),a=e("<span>",{text:"100%","class":"zimageeditor__zoom--text"});var r=e("<span>",{"class":"zimageeditor__btns zimageeditor__btns_spilit","data-objectmenu":"zoom"});e(o).append(a),e(n).append(r),o=e("<button/>",{"class":"zimageeditor__btns","data-objectaction":"zoomin",id:"zimageeditor__btns--zoomIn",title:i._getString("zoomIn.label"),"data-title-position":"top"}),e(t).append(o),a=e("<i/>",{"class":"zimageedit__icon--plus"}),e(o).append(a)},createToolSection:function(){var t=e("<div/>",{"class":"zimageeditor__tools"}).css("display","none");e(i.main_div).append(t);var o=function(t,i){var o=e("<div/>",{"class":i});return e(t).append(o),o},a=o(t,"zimageeditor__tools--header");a.attr("id","zimageeditor__tools--header");var n=e("<span/>",{});e(a).append(n),n=e("<span/>",{}),e(a).append(n),n=e("<span/>",{}),e(a).append(n);var r=function(t,i,o,a,n,r){var s=e('<div class="zbutton--split"></div>'),l=e("<button>",{"class":"zimageeditor__btns ",title:n,"data-title-position":r}),d=e("<span>",{"class":"zimageeditor__btns zimageeditor__btns_spilit",title:n,"data-title-position":r});"shapes"===o||"numbering"===o||"blur"===o||"marker"===o||"linearrow"===o?(e(s).append(l),e(l).attr("id","zimageeditor__btns--"+o),e(s).append(d),e(t).append(s)):(e(t).append(l),e(l).attr("id","zimageeditor__btns--"+a)),void 0!==o?(e(l).attr({"data-objectmenu":o,"data-objectaction":o}),e(d).attr("data-objectmenu",o)):e(l).attr("data-objectaction",a);var c;void 0!==o?("blur"===o&&(o="hideInfo"),c=e("<i/>",{"class":"zimageedit__icon zimageedit__icon--"+o})):c=e("<i/>",{"class":"zimageedit__icon "+i}),e(l).append(c)};r(t,"zimageedit__icon--arrow","select","select",i._getString("select.label"),"right"),e("#zimageeditor__btns--select").addClass("zimageeditor__btns--active"),r(t,"zimageedit__icon--square","shapes",void 0,i._getString("highlightingTools.label"),"right"),r(t,"zimageedit__icon--marker","marker","marker",i._getString("marker.label"),"right"),r(t,"zimageedit__icon--arrow","linearrow",void 0,i._getString("arrowline.label"),"right"),r(t,"zimageedit__icon--text",void 0,"textarea",i._getString("text.label"),"right"),r(t,"zimageedit__icon--numbering","numbering",void 0,i._getString("taggingTools.label"),"right"),r(t,"zimageedit__icon--blur","blur",void 0,i._getString("concealInfo.label"),"right"),r(t,"zimageedit__icon--crop",void 0,"crop",i._getString("crop.label"),"right"),a=o(t,"zimageeditor__arrow"),e(a).attr({id:"zimageeditor__arrow"}).css({top:"362px",display:"none"});var s=e("<i/>",{"class":"zimageedit__icon zimageedit__icon--arrow"});e(a).append(s),i.createDashedIconSVG()},createToolsAndProperties:function(){function t(t,i,o){o=e.extend({},{columnCount:4,type:"grid",contentType:"icon",menuClass:"zimageeditor__menu",addItemCallback:function(e){e.attr({name:"zimageeditor__shapes"})}},o),ZComponents.createMenu(t,i,o)}function o(){if(i.opacitySliderMoved=!0,0===y){var t=i._noOfIdSelected.length;for(t--;t>=0;t--)i.pushIntoTempStack(i._idSelected,2*t);y=1}var o=e("#zimageeditor__slider").zslider("getAttribute","value");i.previousOpacity=o,i.changeOpacity(i.tagSelected,o/100),i.opacitySliderMoved=!1}if(!i.shapesMenu){var a={undo:"Ctrl+Z",redo:"Ctrl+Y",copy:"Ctrl+C",paste:"Ctrl+V"};i.isMacOS&&(a={undo:"\u2318 Z",redo:"\u2318 \u21e7 Z",copy:"\u2318 C",paste:"\u2318 V"});var n=[{icon:"zimageedit__icon zimageedit__icon--square",itemType:"radio","data-action":"rectangle",customAttributes:{title:i._getString("rectangle.label"),"data-title-position":"bottom"}},{icon:"zimageedit__icon zimageedit__icon--circle",itemType:"radio","data-action":"ellipse",customAttributes:{title:i._getString("ellipse.label"),"data-title-position":"bottom"}},{icon:"zimageedit__icon zimageedit__icon--pencil",itemType:"radio","data-action":"polyline",customAttributes:{title:i._getString("pencil.label"),"data-title-position":"bottom"}}];t("zimageeditor__shapes--menu",n,{columnCount:n.length,appendTo:"#zimageeditor"}),i.shapesMenu=e("#zimageeditor__shapes--menu");var r=[{icon:"zimageedit__icon zimageedit__icon--arrow",itemType:"radio","data-action":"line",customAttributes:{title:i._getString("arrow.label"),"data-title-position":"bottom"}},{icon:"zimageedit__icon zimageedit__icon--line",itemType:"radio","data-action":"stline",customAttributes:{title:i._getString("line.label"),"data-title-position":"bottom"}}];t("zimageeditor__linearrow--menu",r,{columnCount:r.length,appendTo:"#zimageeditor",addItemCallback:function(e){e.attr({name:"zimageeditor__line"})}}),i.lineMenu=e("#zimageeditor__linearrow--menu");var s=[{label:i._getString("10Percent.label"),id:"zimageditor__zoom--10","data-zoomAction":"10"},{label:i._getString("25Percent.label"),id:"zimageditor__zoom--25","data-zoomAction":"25"},{label:i._getString("50Percent.label"),id:"zimageditor__zoom--50","data-zoomAction":"50"},{label:i._getString("75Percent.label"),id:"zimageditor__zoom--75","data-zoomAction":"75"},{label:i._getString("100Percent.label"),id:"zimageditor__zoom--100","data-zoomAction":"100"},{label:i._getString("125Percent.label"),id:"zimageditor__zoom--125","data-zoomAction":"125"},{label:i._getString("150Percent.label"),id:"zimageditor__zoom--150","data-zoomAction":"150"},{label:i._getString("200Percent.label"),id:"zimageditor__zoom--200","data-zoomAction":"200"},{itemType:"separator",id:"zimageditor__zoom--seperator"},{label:i._getString("actualSize.label"),id:"zimageditor__zoom--ActualSize","data-zoomAction":"actualSize"},{label:i._getString("fitToScreen.label"),id:"zimageditor__zoom--fitToScreen","data-zoomAction":"fitToScreen"},{label:i._getString("fitToWidth.label"),id:"zimageditor__zoom--fitToWidth","data-zoomAction":"fitToWidth"}];t("zimageeditor__zoom--menu",s,{contentType:"text",type:"list",width:82,appendTo:"#zimageeditor",menuClass:"zimageeditor__zoom--menu",addItemCallback:function(e){e.addClass("zimageeditor__zoom--actions")}}),"screenshot"===this.options.captureType?e("#zimageditor__zoom--fitToWidth").css("display","none"):e("#zimageditor__zoom--fitToWidth").css("display","block");var l=[{c_action:"bringToFront",label:i._getString("bringToFront.label"),id:"zimageeditor__cmenu--bringToFront"},{c_action:"sendToBack",label:i._getString("sendToBack.label"),id:"zimageeditor__cmenu--sendToBack"},{c_action:"bringForward",label:i._getString("bringForward.label"),id:"zimageeditor__cmenu--bringForward"},{c_action:"moveBackward",label:i._getString("moveBackward.label"),id:"zimageeditor__cmenu--moveBackward"},{itemType:"separator"},{c_action:"zoomIn",label:i._getString("zoomIn.label"),id:"zimageeditor__cmenu--zoomIn"},{c_action:"zoomOut",label:i._getString("zoomOut.label"),id:"zimageeditor__cmenu--zoomOut"},{itemType:"separator",id:"zimageeditor__cmenu--separator"},{c_action:"undo",label:i._getString("undo.label"),shortcutkey:a.undo,id:"zimageeditor__cmenu--undo"},{c_action:"redo",label:i._getString("redo.label"),shortcutkey:a.redo,id:"zimageeditor__cmenu--redo"},{itemType:"separator"},{c_action:"copy",label:i._getString("copy.label"),shortcutkey:a.copy,id:"zimageeditor__cmenu--copy"},{c_action:"paste",label:i._getString("paste.label"),shortcutkey:a.paste,id:"zimageeditor__cmenu--paste"},{c_action:"crop",label:i._getString("crop.label"),id:"zimageeditor__cmenu--crop"},{c_action:"cancel",label:i._getString("cancel.label"),id:"zimageeditor__cmenu--cancel"}];t("zimageeditor__context--menu",l,{contentType:"text",type:"list",menuClass:"zimageeditor__context--menu",addItemCallback:function(e){e.addClass("zimageeditor__objects--actions")},appendTo:"#zimageeditor"}),i.rightClickMenu=e("#zimageeditor__context--menu");var d=[{icon:"zimageedit__icon zimageedit__icon--blur",itemType:"radio","data-action":"blur",customAttributes:{title:i._getString("blur.label"),"data-title-position":"bottom"}},{icon:"zimageedit__icon zimageedit__icon--smudge",itemType:"radio","data-action":"smudge",customAttributes:{title:i._getString("smudge.label"),"data-title-position":"bottom"}}];t("zimageeditor__blur--menu",d,{columnCount:2,addItemCallback:function(e){e.attr({name:"zimageeditor__blur"})},appendTo:"#zimageeditor"}),i.blurMenu=e("#zimageeditor__blur--menu");var c=[{icon:"zimageedit__icon zimageedit__icon--markerYellow","data-action":"marker",itemType:"radio",actionColor:"ffff00",actionOpacity:.35,customAttributes:{title:i._getString("yellow.label"),"data-title-position":"bottom"}},{icon:"zimageedit__icon zimageedit__icon--markerRed","data-action":"marker",itemType:"radio",actionColor:"ff0000",actionOpacity:.25,customAttributes:{title:i._getString("red.label"),"data-title-position":"bottom"}},{icon:"zimageedit__icon zimageedit__icon--markerGreen","data-action":"marker",itemType:"radio",actionColor:"05d823",actionOpacity:.3,customAttributes:{title:i._getString("green.label"),"data-title-position":"bottom"}},{icon:"zimageedit__icon zimageedit__icon--markerOrange","data-action":"marker",itemType:"radio",actionColor:"ff8a00",actionOpacity:.3,customAttributes:{title:i._getString("orange.label"),"data-title-position":"bottom"}}];t("zimageeditor__marker--menu",c,{columnCount:4,addItemCallback:function(e){e.attr({name:"zimageeditor__marker"})},appendTo:"#zimageeditor"}),i.markerMenu=e("#zimageeditor__marker--menu");var h=[{icon:"zimageedit__icon zimageedit__icon--numbering","data-action":"numbering",itemType:"radio",actionType:"numbering",customAttributes:{title:i._getString("numbering.label"),"data-title-position":"bottom"}},{icon:"zimageedit__icon zimageedit__icon--tick","data-action":"numbering",itemType:"radio",actionType:"tick",customAttributes:{title:i._getString("correct.label"),"data-title-position":"bottom"}},{icon:"zimageedit__icon zimageedit__icon--delete","data-action":"numbering",itemType:"radio",actionType:"wrong",customAttributes:{title:i._getString("wrong.label"),"data-title-position":"bottom"}},{icon:"zimageedit__icon zimageedit__icon--question","data-action":"numbering",itemType:"radio",actionType:"question",customAttributes:{title:i._getString("unclear.label"),"data-title-position":"bottom"}}];t("zimageeditor__numbering--menu",h,{columnCount:4,addItemCallback:function(e){e.attr({name:"zimageeditor__numbering"})},appendTo:"#zimageeditor"}),i.numberingMenu=e("#zimageeditor__numbering--menu");var u=[{"inner-color":"ff004e",itemType:"radio",customAttributes:{title:i._getString("pink.label")}},{"inner-color":"ff3131",itemType:"radio",customAttributes:{title:i._getString("red.label")}},{"inner-color":"fe9300",itemType:"radio",customAttributes:{title:i._getString("orange.label")}},{"inner-color":"ffc300",itemType:"radio",customAttributes:{title:i._getString("yellow.label")}},{"inner-color":"19de5e",itemType:"radio",customAttributes:{title:i._getString("green.label")}},{"inner-color":"226cfb",itemType:"radio",customAttributes:{title:i._getString("blue.label")}},{"inner-color":"8b23d5",itemType:"radio",customAttributes:{title:i._getString("violet.label")}},{"inner-color":"8b4513",itemType:"radio",customAttributes:{title:i._getString("brown.label")}},{"inner-color":"ffffff",itemType:"radio",customAttributes:{title:i._getString("white.label")}},{"inner-color":"000000",itemType:"radio",customAttributes:{title:i._getString("black.label")}},{"inner-color":"none",icon:"zimageedit__icon zimageedit__icon--nofill",itemType:"radio",customAttributes:{title:i._getString("noFill.label")}},{itemType:"separator","inner-color":"separator"},{itemType:"custom","inner-color":"opacity",innerHTML:'<div class="zimageeditor__slider--label">'+i._getString("opacity.label")+'</div><div class="zimageeditor__opacity"><span></span></div><input id="zimageeditor__slider" data-class-name="zimageeditor__slider" min="0" max="100" style="width:70px" />'}];t("zimageeditor__colorpalatte--menu",u,{submenuDirection:"bottom-left",columnCount:5,addItemCallback:function(e,t){e.attr({id:"zimageeditor__colors--"+t["inner-color"],name:"zimageeditor__colors"})},appendTo:"#zimageeditor",animation:{open:{className:"zimageeditColorPallate--slideInDown",duration:"200"},close:{className:"zimageeditor__transistionPropertiesHide",duration:"200"}}});for(var m=i.colorPalatteMenu=e("#zimageeditor__colorpalatte--menu"),p=0;p<u.length;p++){var g=u[p]["inner-color"];m.find("#zimageeditor__colors--"+g+" .zmenu__image").css("background","#"+g)}var _=[{icon:"zimageedit__icon zimageedit__icon--text",itemType:"default","plus-action":"text"},{icon:"zimageedit__icon zimageedit__icon--numbering",itemType:"default","plus-action":"numbering"}];t("zimageeditor__plus--menu",_,{columnCount:2,appendTo:"#zimageeditor",menuClass:"zimageeditor__menu zimageeditor__plus--menu"});var f=[{itemType:"custom",innerHTML:'<div id="zimageeditor__strokewidth" class="zimageeditor__strokewidth"><div class="zimageeditor__line" title='+i._getString("solid.label")+'><span></span></div><div class="zimageeditor__dashed zimageeditor--unchecked" title='+i._getString("dashed.label")+"><span></span></div></div>"},{borderWidth:"2",itemType:"radio"},{borderWidth:"4",itemType:"radio"},{borderWidth:"7",itemType:"radio"},{borderWidth:"10",itemType:"radio"},{borderWidth:"4",borderType:"dash",itemType:"radio",icon:"#zimageedit__icon--dashedsmall"},{borderWidth:"8",borderType:"dash",itemType:"radio",icon:"#zimageedit__icon--dashedbig"}],v="line";t("zimageeditor__strokewidth--menu",f,{submenuDirection:"bottom-left",columnCount:4,appendTo:"#zimageeditor",addItemCallback:function(e,t){"custom"!==t.itemType&&(v=t.borderType||v,e.data({borderWidth:t.borderWidth}).attr({name:"zimageeditor__strokewidth--menu",id:"zimageeditor__"+v+"--"+t.borderWidth}),e.addClass("zimageedit--stroke--"+v))},animation:{open:{className:"zimageeditColorPallate--slideInDown",duration:"200"},close:{className:"zimageeditor__transistionPropertiesHide",duration:"200"}}}),e("#zimageeditor__strokewidth--menu .zimageedit--stroke--line").css("display",""),e("#zimageeditor__strokewidth--menu .zimageedit--stroke--dash").css("display","none"),e("#zimageeditor__strokewidth--menu .zimageeditor__line").on("click",function(){e("#zimageeditor__strokewidth--menu .zimageedit--stroke--line").show(),e("#zimageeditor__strokewidth--menu .zimageedit--stroke--dash").hide()}),e("#zimageeditor__strokewidth--menu .zimageeditor__dashed").on("click",function(){e("#zimageeditor__strokewidth--menu .zimageedit--stroke--line").hide(),e("#zimageeditor__strokewidth--menu .zimageedit--stroke--dash").show()});var b=[{itemType:"custom",id:"zimageeditor--propertiesTool--header",innerHTML:'<div class="zimageeditor__propertiesTools--header"><span></span><span></span><span></span></div>'},{itemType:"custom",id:"zimageeditor--fontsize--slider",innerHTML:'<div class="zimageeditor__fontsize" ><span class="zimageedit__icon zimageedit__icon--fontsize"></span><input id="zimageeditor__fontsize--slider" data-class-name="zimageeditor__slider" min="12" max="40"/></div>',customAttributes:{title:i._getString("fontSize.label"),"data-title-position":"bottom",tabindex:"-1"}},{itemCssClass:"zimageeditor__textarea--item",itemType:"custom",id:"zimageeditor__text--fontcolor",innerHTML:'<span class="zimageedit__icon zimageedit__icon--shadow"></span><span class="zimageedit__fontcolor"></span><span class="zimaggeditor__submenuArrow"></span>',"textclick-action":"color",menuId:"zimageeditor__colorpalatte--menu",openOn:"click",customAttributes:{"data-objectaction":"text",title:i._getString("fontColor.label"),"data-title-position":"bottom",tabindex:"-1"}},{itemCssClass:"zimageeditor__textarea--item",icon:"zimageedit__icon zimageedit__icon--glow","textclick-action":"glow",id:"zimageedit__icon--textglow",itemType:"checkbox",customAttributes:{name:"zimageedit__icon--textglow",title:i._getString("textOutline.label"),"data-title-position":"bottom",tabindex:"-1"}},{itemCssClass:"zimageeditor__textarea--item",itemType:"custom",innerHTML:'<span class="zimageedit__fill--border"></span><span class="zimageedit__fill--transparent"></span><span class="zimageedit__fill--bg"></span><span class="zimaggeditor__submenuArrow"></span>',id:"zimageedit__icon--cfill","textclick-action":"fill",menuId:"zimageeditor__colorpalatte--menu",openOn:"click",customAttributes:{title:i._getString("fillColor.label"),"data-title-position":"bottom","data-objectaction":"fill",tabindex:"-1"}},{itemType:"custom",itemCssClass:"zimageeditor__textarea--item",innerHTML:'<span class="zimageedit__stroke--border zimageedit__prop--nofill" style="border: 2px solid white;"></span><span class="zimageedit__stroke--bg" style="background: gray;"></span><span class="zimaggeditor__submenuArrow"></span>',"textclick-action":"stroke",id:"zimageedit__icon--cstroke",menuId:"zimageeditor__colorpalatte--menu",openOn:"click",customAttributes:{"data-objectaction":"stroke","data-title-position":"bottom",title:i._getString("borderColor.label"),tabindex:"-1"}},{itemType:"custom",innerHTML:'<span class="zmenu__image zimageedit__icon zimageedit__icon--strokeWidth"></span><span class="zimaggeditor__submenuArrow"></span>',"textclick-action":"strokeWidth",id:"zimageedit__icon--cstrokWidth",menuId:"zimageeditor__strokewidth--menu",openOn:"click",customAttributes:{"data-objectaction":"strokewidth",title:i._getString("borderWidth.label"),"data-title-position":"bottom",tabindex:"-1"}}];t("zimageeditor__textarea--menu",b,{columnCount:3,direction:"after-pointer",toggle:!1,appendTo:"#zimageeditor",menuClass:"zimageeditor__menu zimageeditor__textarea--menu",addItemCallback:function(e,t){"checkbox"===t.itemType&&e.attr({name:"zimageeditor__textarea"})}});var y=0;i.propertiesMenu=e("#zimageeditor__textarea--menu"),i.propertiesMenu.on("zmenubeforehide",function(){return i.opacitySliderMoved===!0?!1:void 0}).on("zmenubeforesubmenushow",function(){y=0;var t,o=e(i.lastHover).data("objectaction");if("text"===o||i.numberingStrokeSelected===!0?(i.colorPalatteMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__colors--opacity","#zimageeditor__colors--separator"],"hidden",!0),i.colorPalatteMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__colors--none"],"disabled",!0),i.colorPalatteMenu.zmenu("hideMenuItems",["#zimageeditor__colors--none"]),i.colorPalatteMenu.zmenu("showMenuItems",["#zimageeditor__colors--8b4513"])):(i.colorPalatteMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__colors--opacity","#zimageeditor__colors--separator"],"hidden",!1),i.colorPalatteMenu.zmenu("hideMenuItems",["#zimageeditor__colors--8b4513"]),i.colorPalatteMenu.zmenu("showMenuItems",["#zimageeditor__colors--none"])),("fill"===o||"stroke"===o||"text"===o)&&(i.tagSelected=o,t=i.init_properties(o)),void 0!==i.lastHover&&void 0!==z&&(e("#zimageeditor__arrow").fadeOut(),z.data("zmenu")&&z.zmenu()),("fill"===o||"stroke"===o||"text"===o)&&void 0!==t&&(e("#zimageeditor__slider").zslider("setValue",t[0]),i.changeOpacitySliderProperties(t[1])),"strokewidth"===o){for(var a,n,r=0;r<i._noOfIdSelected.length;r++){var s,l,d=i._noOfIdSelected[r];if(s=parseFloat(e(d).attr("stroke-width")),l=e(d).attr("stroke-dasharray"),0===r)a=s,n=l;else if(a!==s||n!==l)return e("#zimageedit__svg--Icon .zimageedit__icon--dashedbig").attr("class","zimageedit__icon--dashedbig"),e("#zimageedit__svg--Icon .zimageedit__icon--dashedsmall").attr("class","zimageedit__icon--dashedsmall"),e("#zimageeditor__strokewidth--menu").zmenu("uncheckMenuItems"),e("#zimageeditor__strokewidth--menu .zimageeditor__line").trigger("click"),!0}if(void 0!==i._idSelected||1===i._noOfIdSelected.length)if((void 0===n||"undefined"===n)&&(n="none"),"none"===n)e("#zimageedit__svg--Icon .zimageedit__icon--dashedbig").attr("class","zimageedit__icon--dashedbig"),e("#zimageedit__svg--Icon .zimageedit__icon--dashedsmall").attr("class","zimageedit__icon--dashedsmall"),e("#zimageeditor__strokewidth--menu").zmenu("setMenuItemsAttribute",["#zimageeditor__line--"+a],"checked",!0),e("#zimageeditor__strokewidth--menu .zimageeditor__line").trigger("click");else{var c=parseFloat(e(i._noOfIdSelected[0]).attr("stroke-width"));10==c?e("#zimageedit__svg--Icon .zimageedit__icon--dashedbig").attr("class","zimageedit__icon--dashedbig is-selected"):e("#zimageedit__svg--Icon .zimageedit__icon--dashedbig").attr("class","zimageedit__icon--dashedbig"),6==c?e("#zimageedit__svg--Icon .zimageedit__icon--dashedsmall").attr("class","zimageedit__icon--dashedsmall is-selected"):e("#zimageedit__svg--Icon .zimageedit__icon--dashedsmall").attr("class","zimageedit__icon--dashedsmall"),e("#zimageeditor__strokewidth--menu").zmenu("setMenuItemsAttribute",["#zimageeditor__dash--"+c],"checked",!0),e("#zimageeditor__strokewidth--menu .zimageeditor__dashed").trigger("click")}}}),e("#zimageeditor__slider").zslider({change:function(){i.opacitySliderMoved===!1&&o(),i.isDraw=!0;var e=i._noOfIdSelected.length;for(y=0,e--;e>=0;e--)i.pushIntoTempStack(i._idSelected,2*e+1);i.copyFromTempToUndoStack(),i.opacitySliderMoved=!1},slide:function(){o()}}),e("#zimageeditor__slider").next().attr("id","zimageeditor__zslider"),e("#zimageeditor__fontsize--slider").zslider({change:function(){i.pushIntoStack("resize"),i.isDraw=!0,"undefined"!==i.focussedTextareaID&&1===i._noOfIdSelected.length&&e("#"+i.focussedTextareaID).focus();for(var t=0;t<i._noOfIdSelected.length;t++)i._idSelected=i._noOfIdSelected[t],i._idSelected=i._idSelected.substr(1,i._idSelected.length),i.pushIntoTempStack(i._idSelected,2*t+1),i.textFontSize=parseFloat(e("#zimageeditor__fontsize--slider").zslider("getAttribute","value")),e("#"+i._idSelected).css({"font-size":Math.round(i.textFontSize)}),i.textareaAlignment(i._idSelected),i.textFontShadow="none"===e("#"+i._idSelected).css("text-shadow")?!1:!0,i.applyTextShadow(i._idSelected,i.textFontShadow);i.copyFromTempToUndoStack()},slide:function(){var t;if(i._checkFlagMouseAction===!1){for(t=0;t<i._noOfIdSelected.length;t++)i._idSelected=i._noOfIdSelected[t].substr(1,i._noOfIdSelected[t].length),i.pushIntoTempStack(i._idSelected,2*t);i._checkFlagMouseAction=!0}var o=e("#zimageeditor__fontsize--slider").zslider("getAttribute","value");for(t=0;t<i._noOfIdSelected.length;t++)i._idSelected=i._noOfIdSelected[t].substr(1,i._noOfIdSelected[t].length),e("#"+i._idSelected).css({"font-size":Math.round(o)}),i.textareaAlignment(i._idSelected)},min:12,max:40}),e("#zimageeditor__fontsize--slider").next().attr("id","zimageeditor__fontsize--zslider"),e("#zimageeditor__strokewidth--menu").on("zmenubeforeshow",function(){e("#zimageeditor__context--menu").zmenu("hide");var t=e("#zimageeditor__strokewidth--menu").find(".zmenu__item:not(.zmenu__custom)"),i=e(t[0]).height()/2;t.each(function(t,o){o=e(o);var a=o.data("borderWidth"),n={"margin-top":i-a/2};"dash"!==o.data("borderType")&&(n["border-top-width"]=a+"px"),o.find("i").css(n)})});var z;e("#zimageeditor__strokewidth").children().on("click",function(t){return e(t.target).hasClass("zimageeditor__line")?(e("#zimageeditor__strokewidth .zimageeditor__dashed").addClass("zimageeditor--unchecked"),e(this).removeClass("zimageeditor--unchecked"),e("#zimageeditor__strokewidth--menu").removeClass("zimageeditor__dashed").addClass("zimageeditor__line")):(e("#zimageeditor__strokewidth .zimageeditor__line").addClass("zimageeditor--unchecked"),e(this).removeClass("zimageeditor--unchecked"),e("#zimageeditor__strokewidth--menu").removeClass("zimageeditor__line").addClass("zimageeditor__dashed")),t.preventDefault(),t.stopPropagation(),!1}),e("#zimageeditor .zimageeditor__btns:not(#zimageeditor__plus), .zimageeditor__textarea--item, #zimageedit__icon--cstrokWidth, #zimageeditor--fontsize--slider").on("mouseenter",function(t){i.toolMove===!0?i.moveToolbar(t,i.toolbarMove,i.propertiesMove):(t.stopPropagation(),i.lastHover=e(this))}).on("click",function(t){i.lastHover=e(this);var o=i.lastHover.data("objectmenu");"colorpalatte"===o||"strokewidth"===o?(z=e("#zimageeditor__"+i.lastHover.data("objectmenu")+"--menu"),i.handleMenuOpen(t,z,dir)):void 0!==i.lastHover.data("colorpalatte")&&(z=i.colorPalatteMenu)}),e("#zimageeditor__arrow").on("click",function(e){setTimeout(function(){i.handleMenuOpen(e,z)},100)}).on("mouseenter",function(e){setTimeout(function(){i.handleMenuOpen(e,z)},100)})}},handleMenuOpen:function(t,o,a){var n=e(i.lastHover).attr("class"),r=i.lastHover;-1!==n.indexOf("zimageeditor__btns_spilit")&&(i.lastHover=i.lastHover.parent(),a="right","zoom"===i.lastHover.children().eq(0).data("objectmenu")&&(a="top"));var s=i.lastHover.data("objectmenu");if("zoom"===s&&(a="top"),"zoom"===i.lastHover.data("objectmenu")&&e("#zimageeditor__zoom--menu").is(":visible")===!0)return e("#zimageeditor__zoom--menu").zmenu("hide"),!0;if(e("#zimageeditor__zoom--menu").is(":visible")&&e("#zimageeditor__zoom--menu").zmenu("hide"),i.handleToolsMenuAnimation(s,o),void 0!==i.lastHover&&void 0!==o){e("#zimageeditor__arrow").fadeOut(),o.data("zmenu")&&o.zmenu();var l={top:0,left:0};"zimageedit__plus"===i.lastHover.attr("id")&&(l.top=-4,l.left=-18),o.zmenu("show",{forElement:i.lastHover,direction:a?a:"right-bottom",event:t,offset:{top:l.top,left:l.left},preventHover:!0}),i.lastHover=r}},textareaAlignment:function(t){var o,a,n,r,s,l,d;o=document.getElementById(t),e(o).css("overflow","hidden"),a=parseFloat(i.SVGElement.attr("height")),d=e(o).parent(),n=parseFloat(d.attr("y")),r=parseFloat(d.attr("x")),s=parseFloat(d.attr("width")),l=parseFloat(d.attr("height"));var c=e(o).data("resized");o.style.height="0px";var h=parseFloat(o.style.fontSize),u=o.scrollHeight+8;e(o).attr("wrap","off"),o.style.width="0px";var m=o.scrollWidth;o.style.height="100%",o.style.width="100%",c===!1?(d.attr({width:"0px",height:"0px"}),i.isIEBrowser&&d.css({width:"0px",height:"0px"}),m=o.scrollWidth+(h+2),d.attr({width:m>40?m:40,height:u>31?u:31}),i.isIEBrowser&&d.css({width:m>40?m:40,height:u>31?u:31}),o.scrollWidth+r>i.actualWidth&&(m=Math.abs(i.actualWidth-r-5),o.scrollWidth=s,d.attr("width",m),i.isIEBrowser&&d.css("width",m)),d.attr({width:m>40?m:40,height:u>31?u:31}),i.isIEBrowser&&(d.css({width:m>40?m:40,height:u>31?u:31}),n+u>a&&(u=a-n,d.css({height:u}))),s=m,l=u):(d.attr({width:s>40?s:40,height:u>31?u:31}),i.isIEBrowser===!0&&d.css({width:s,height:u}),l=u),i.checkTextareaOverflow(t),e(o).css("overflow","hidden"),i.multiSelectFlag===!1?(n-=1,i.drawBorder("textarea",n,r-4,s>47?s:47,l>33?l:33)):i.setBoundaryValuesMultiSelect("#"+t,n,r-4,s,l),h=parseFloat(o.style.fontSize);var p=12;h+p>l&&e("#"+t+"--fobject").attr("height",h+p),e(o).attr("wrap","soft")},handleToolsMenuAnimation:function(t,o){if("shapes"===t||"marker"===t||"numbering"===t||"blur"===t||"linearrow"===t){var a,n,r,s,l=60;s=i.getWindowDimensions(),a="shapes"===t?135:"marker"===t||"numbering"===t?180:"linearrow"===t||"blur"===t?90:0,"shapes"===t?a=135:"marker"===t||"numbering"===t?a=180:"blur"===t?a=90:"linearrow"===t&&(a=90),r=parseFloat(e("#zimageeditor .zimageeditor__tools").offset().left),n=s.width-r-l;var d=n>a?"Left":"Right";e(o).zmenu("setAttribute","animation",{open:{className:"zimageditToolsShowFrom"+d,duration:"100"},close:{className:"zimageditToolsHideFrom"+d,duration:"100"}})}},init_properties:function(t){var o,a,n=i._noOfIdSelected.length,r=i._noOfIdSelected[n-1],s=i.getValuesOfObject(r);return"fill"===t?(a=s.fill,"transparent"===a&&(a="none"),"textarea"===s.tool&&(a=a.bck_color,"rgba"===a.substr(0,4)&&(a="none")),void 0===a&&(a=i.previousFillColor),o="none"===s.fillOpacity||void 0===s.fillOpacity?100:100*s.fillOpacity):"stroke"===t?(a=s.borderColor,"transparent"===a&&(a="none"),"textarea"===s.tool?(a=s.fill.border,a="transparent"===a?"none":i.regtohex_convert(a),"#000000"===a&&(a="none")):"numbering"===s.tool&&(a=s.borderStroke),"textarea"===i._selectedTool&&void 0===a&&(a="none"),void 0===a&&(a=i.previousBorderColor),o="none"===s.strokeOpacity||void 0===s.strokeOpacity?100:100*s.strokeOpacity,void 0===s.strokeOpacity&&"Marker"===i._selectedTool&&(o=70)):"text"===t&&(a=e(r).css("color"),a=i.regtohex_convert(a)),"transparent"===a&&(a="none"),void 0!==a&&"none"!==a&&-1!==a.indexOf("#")&&(a=a.substr(1,a.length)),i.colorPalatteMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__colors--"+a],"checked",!0),"stroke"===t&&"#7F7F7F"===i.borderIconColor&&i.colorPalatteMenu.zmenu("uncheckMenuItems"),"fill"===t&&"#7F7F7F"===i.fillIconColor&&i.colorPalatteMenu.zmenu("uncheckMenuItems"),i.colorPalatteMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__colors--none"],"disabled","text"===t||i.numberingStrokeSelected===!0),[o,a]},regtohex_convert:function(e){var t=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+)/i);return t&&4===t.length?"#"+("0"+parseInt(t[1],10).toString(16)).slice(-2)+("0"+parseInt(t[2],10).toString(16)).slice(-2)+("0"+parseInt(t[3],10).toString(16)).slice(-2):e},CropDone:function(){i.cropCancelAnimationHandle(),i.onCropDone=!0,i.isImageCropped=!0,i.catureButtonClickFunction(),i.cropCaptureCount++,e("#zimageeditor .zimaggeditor__crop--container").children().closest("#zimaggeditor__crop--container").remove(),i.resetToDefaultAfterCrop()},onCropCancel:function(){i.onCropDone=!1,i.cropCancelAnimationHandle(),i.removeBorderFocus(),void 0===i._crop_arr[0]?e("#zimageeditor .zimaggeditor__crop--container").remove():(i.modifyTheCropAreaValues(0,0,i.actualWidth,i.actualHeight),i.drawBorder("crop_element",i._crop_arr[1]+3,i._crop_arr[0]+3,i._crop_arr[2]-3,i._crop_arr[3]-3),i.removeBorderFocus()),e("#zimageeditor .zimaggeditor__crop--container").remove(),i.resetToDefaultAfterCrop(),i.undoStack.pop()},initMouseFunction:function(){e(document).off("dragstart.zimageeditor").on("dragstart.zimageeditor",function(){return!1}),e(".zimageeditor__btns").off("mousedown click").on("mousedown",function(t){i.rightClickMenu.is(":visible")===!0&&i.rightClickMenu.zmenu("hide"),e("#zimageeditor__plus--menu").is(":visible")===!0&&e("#zimageeditor__plus--menu").zmenu("hide"),i.lastHover.data("objectmenu"),e(i.splitMenuOpen).show();var o=e(i.splitMenuOpen).data("objectmenu");void 0!==o&&"zoom"!==o&&e("#zimageeditor__"+o+"--menu").zmenu("hide");var a,n=e(this).attr("class");-1!=n.indexOf("zimageeditor__btns_spilit")?(e(".zimageeditor__btns--focus").removeClass("zimageeditor__btns--focus"),i.lastHover=e(this),a=e("#zimageeditor__"+i.lastHover.data("objectmenu")+"--menu"),i.splitMenuOpen=this,"rectangle"!==i._selectedTool&&"ellipse"!==i._selectedTool&&"polyline"!==i._selectedTool&&e("#zimageeditor__shapes--menu").zmenu("uncheckMenuItems"),"line"!==i._selectedTool&&e("#zimageeditor__linearrow--menu").zmenu("uncheckMenuItems"),"numbering_"!==i._selectedTool&&e("#zimageeditor__numbering--menu").zmenu("uncheckMenuItems"),"blur"!==i._selectedTool&&"smudge"!==i._selectedTool&&e("#zimageeditor__blur--menu").zmenu("uncheckMenuItems"),i.handleMenuOpen(t,a)):i.splitMenuOpen=void 0;var r=e(this).attr("data-objectaction");return t.stopPropagation(),"crop"===r&&(e("#zimaggeditor__crop--container").remove(),i.textareaSelected=!1,i.resetMultiSelect(),i._idSelected="zimageedit__crop",i.resize_flag=!0,i._noOfIdSelected.length=0,i._noOfIdSelected.push("#"+i._idSelected),i.removeCssFromCrop(),i.cursorHandling({type:"toolSelect",tool:"crop"}),i.setPropertiesForSelectedObject("crop"),i.hidePlusMenu(),i.multiSelectFlag=!1,e("#zimageedit__focus--crop").css("visibility","visible"),i.showBorderFocus(),i.createCropDiv(),i.previousSelectedTool=i._selectedTool,i.showBorderFocus(),i._selectedTool="crop"),"zoomin"!==r&&"zoomout"!==r&&"fill"!==r&&"stroke"!==r&&"strokewidth"!==r&&"select"!==r?-1==n.indexOf("zimageeditor__btns_spilit")&&("textarea"!==r&&"crop"!==r&&(i.lastHover=e(this),a=e("#zimageeditor__"+i.lastHover.data("objectmenu")+"--menu"),i.splitMenuOpen=this,"rectangle"!==i._selectedTool&&"ellipse"!==i._selectedTool&&"polyline"!==i._selectedTool&&e("#zimageeditor__shapes--menu").zmenu("uncheckMenuItems"),"line"!==i._selectedTool&&e("#zimageeditor__linearrow--menu").zmenu("uncheckMenuItems"),"marker"!==i._selectedTool&&e("#zimageeditor__marker--menu").zmenu("uncheckMenuItems"),"numbering_"!==i._selectedTool&&e("#zimageeditor__numbering--menu").zmenu("uncheckMenuItems"),"blur"!==i._selectedTool&&"smudge"!==i._selectedTool&&e("#zimageeditor__blur--menu").zmenu("uncheckMenuItems"),"zoom"===i.lastHover.data("objectmenu")?i.handleMenuOpen(t,a,"top"):i.handleMenuOpen(t,a)),"crop"!==i._selectedTool&&(i.previousSelectedToolObj=this),i._toolSelected=!0,void 0!==i._selectedTool&&i.setPropertiesForSelectedTool(i._selectedTool,r),"textarea"===i._selectedTool?i.cursorHandling({type:"toolSelect",tool:i._selectedTool}):"crop"===i._selectedTool&&(i.cropSelected=!0)):"zoomin"!==r&&"zoomout"!==r||e(this).is(":disabled")!==!1||(i.handleZoomCases(r),i.isFitToScreen=!1),"undefined"!=typeof r&&e("#zimageeditor__zoom--menu").is(":visible")&&e("#zimageeditor__zoom--menu").zmenu("hide"),!0}).on("click",function(t){var o=e(this).attr("data-objectaction");t.stopPropagation(),"textarea"===o?(i._stLine=!1,i.hideProperties(),e(".zimageeditor__btns--focus").removeClass("zimageeditor__btns--focus"),i.resetProperties(),i.textID=void 0,i.textareaSelected=!1,i.hidePlusMenu(),i.removeShadowForMarker(),i._selectedTool=o,i.cursorHandling({type:"toolSelect",tool:o}),e(".zimageeditor__btns--active").removeClass("zimageeditor__btns--active"),e("#zimageeditor__btns--"+o).addClass("zimageeditor__btns--active"),i.setPropertiesForSelectedTool(i._selectedTool,o)):"select"===o&&(i._stLine=!1,i._selectedTool=void 0,e(".zimageeditor__btns--active").removeClass("zimageeditor__btns--active"),i._toolSelected=!1,e("#zimageeditor__btns--select").addClass("zimageeditor__btns--active"),i.cursorHandling({type:"toolSelect",tool:void 0}))}),e("#zimageeditor__textarea--menu > ul").on("mouseup",function(){ZComponents.$document.trigger("mouseup")}),e(document).off("zmenuitemclick.ze zmenusubmenuitemclick.zimageeditor").on("zmenuitemclick.ze",function(t,o){if(o.menuitem.is(".zmenu--submenu"))return void("stroke"===o.data.customAttributes["data-objectaction"]?e("#zimageeditor__colors--none").attr("title",i._getString("noColor.label")):"fill"===o.data.customAttributes["data-objectaction"]&&e("#zimageeditor__colors--none").attr("title",i._getString("noFill.label")));var a,n=o.data,r=n["data-action"],s=n["plus-action"],l=n["textclick-action"],d=n.actionColor,c=n.actionOpacity,h=n["data-zoomAction"],u="c_action",m=n[u],p="inner-color",g=n[p];void 0!==g&&(a=g);var _=o.menuitem[0].id;if("zimageeditor--propertiesTool--header"===_||"zimageeditor--fontsize--slider"===_)return"zimageeditor--fontsize--slider"===_&&ZComponents.$document.trigger("mouseup"),!1;var f,v,b,y;if(p="borderWidth",f=n[p],void 0!==d)i._stLine=!1,e("#"+i.textID).blur(),i.textareaSelected=!1,i._idSelected=i.textID=void 0,i.resetMultiSelect(),i._noOfIdSelected.length=0,i.hideProperties(),i.resetProperties(),i.markerColor=d,i.markerColorOpacity=c,i._selectedTool="marker",y=e(i.lastHover).attr("class"),-1!=y.indexOf("zimageeditor__btns_spilit")&&(i.lastHover=e(i.lastHover).parent().children().eq(0)),e(".zimageeditor__btns--active").removeClass("zimageeditor__btns--active"),e("#zimageeditor__btns--marker").addClass("zimageeditor__btns--active"),i.hidePlusMenu(),i.setPropertiesForSelectedTool(i._selectedTool),i.cursorHandling({type:"toolSelect",tool:i._selectedTool});else if(void 0!==r)i._stLine=!1,i.textareaSelected=!1,e("#"+i.textID).blur(),i.textID=void 0,i.hideProperties(),e(i.splitMenuOpen).show(),"numbering"===r?(i._selectedTool="numbering_",i.numberingTagSelected=n.actionType):("stline"===r&&(r="line",i._stLine=!0),i._selectedTool=r),i.hidePlusMenu(),i.resetMultiSelect(),i.setPropertiesForSelectedTool(i._selectedTool),i._noOfIdSelected.length=0,i.cursorHandling({type:"toolSelect",tool:i._selectedTool}),i._toolSelected=!0,y=e(i.lastHover).attr("class"),-1!=y.indexOf("zimageeditor__btns_spilit")&&(i.lastHover=e(i.lastHover).parent().children().eq(0)),"numbering_"===i._selectedTool?i.lastHover=e("#zimageeditor__btns--numbering"):"ellipse"===i._selectedTool||"rectangle"===i._selectedTool||"polyline"===i._selectedTool?i.lastHover=e("#zimageeditor__btns--shapes"):"line"===i._selectedTool?i.lastHover=e("#zimageeditor__btns--linearrow"):("blur"===i._selectedTool||"smudge"===i._selectedTool)&&(i.lastHover=e("#zimageeditor__btns--blur"),i.lastDrawnId=void 0),e(".zimageeditor__btns--active").removeClass("zimageeditor__btns--active"),e("#zimageeditor__btns--"+i.lastHover.attr("data-objectmenu")).addClass("zimageeditor__btns--active"),i.previousSelectedToolObj=i.lastHover,"crop"!==i._selectedTool&&i.resetProperties();else if(void 0!==g&&"opacity"!==g){if(i.isDraw=!0,"fill"===i.tagSelected)i.changeFillColor(a);else if("stroke"===i.tagSelected)i.changeBorderColor(a);else if("text"===i.tagSelected){for(i.pushIntoStack("resize"),b=i._noOfIdSelected.length,a="none"===a?"transparent":"#"+a,e("#zimageeditor__textarea--menu .zimageedit__fontcolor").css("background-color",a),v=0;b>v;v++)i._idSelected=i._noOfIdSelected[v],i._idSelected=i._idSelected.substr(1,i._idSelected.length),i.pushIntoTempStack(p,2*v),e("#"+i._idSelected).css({color:a}),i.pushIntoTempStack(p,2*v+1);1===b&&"undefined"!==i.focussedTextareaID&&e("#"+i.focussedTextareaID).focus(),i.copyFromTempToUndoStack(),i.textFontColor=a}"none"===a?(a="transparent",e("#zimageeditor__colors--opacity").css("opacity",.5),i.colorPalatteMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__colors--opacity"],"disabled",!0)):(a="#"+a,e("#zimageeditor__colors--opacity").css("opacity",1),i.colorPalatteMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__colors--opacity"],"disabled",!1)),i.changeOpacitySliderProperties(a)}else if(void 0!==f){var z=n.borderType;10==f&&"dash"===z?e("#zimageedit__icon--dashedbig .zimageedit__icon--dashedbig").attr("class","zimageedit__icon--dashedbig is-selected"):e(".zimageedit__icon--dashedbig").attr("class","zimageedit__icon--dashedbig"),6==f&&"dash"===z?e("#zimageedit__icon--dashedsmall .zimageedit__icon--dashedsmall").attr("class","zimageedit__icon--dashedsmall is-selected"):e(".zimageedit__icon--dashedsmall").attr("class","zimageedit__icon--dashedsmall"),i.changeStrokeWidth(parseFloat(f),"dash"===z)}else if(void 0!==s){var S=i._idSelected,w=i.calculateElementPosition(i._idSelected),x=Math.round(1e7*Math.random());if(i.temp_id="zimageedit__shapes--"+x,"numbering"===s){var C=!1,k=i.editorSVG.getAttribute("viewBox").split(/\s+|,/);w.top-parseFloat(k[1])<40&&(w.top+=w.height+60,C=!0,w.top+30-parseFloat(k[1])>parseFloat(k[3])&&(w.top-=60,C=!1));var I=i.typeOfElement(i._noOfIdSelected[0].substr(1,i._noOfIdSelected[0].length));i.cursorHandling({type:"toolSelect",tool:i._selectedTool}),e(i._noOfIdSelected[0]).attr("class","zimageedit__"+I),i.numberingTagSelected="numbering",i.createNumbering(w.left+w.width/2,w.top-30),i.lastDrawnId=i._idSelected,i._idSelected=i.temp_id,C===!0&&e("#"+i.temp_id+"--path").attr("transform","translate("+(w.left+w.width/2)+","+(w.top-65+15)+") rotate(270 0 7.5)"),i.hideProperties(),i.pushIntoStack("create"),i._idSelected=S,i._noOfIdSelected.length=0,i._noOfIdSelected.push("#"+i.temp_id),i.checkForPlusDisplay(void 0,t),i.removeBorderForNumbering(),i.removePlusAttributes(),i.drawnElements.push(i.temp_id),i._idSelected=i.temp_id,i.showBroderForNumbering(w.left+w.width/2,w.top-30,i._idSelected),i.checkForPlusDisplay(e("#"+i._idSelected).attr("class"),t,i._idSelected);var T="";i.isIEBrowser===!0&&(T="--IE"),e("#"+i._idSelected+"--group").attr("class","zimageedit__numbering zimageedit__move--cursor"+T)}else if("text"===s){i._stLine=!1;var E=i.temp_id,M=document.createElementNS(i.svgPath,"path");x=Math.round(1e7*Math.random()),i.temp_id="zimageedit__shapes--"+x,i.drawnElements.push(i.temp_id);var A=e("#"+i._idSelected).attr("stroke"),O=e("#"+i._idSelected).attr("stroke-width");i.setAttributeForObj(M,["class","zimageedit__line","id",i.temp_id,"stroke-linecap","round","stroke-width",4,"fill","none","stroke",A,"stroke-width",O]);var P=document.createElementNS(i.svgPath,"polygon");i.setAttributeForObj(P,["id",i.temp_id+"--line","class","zimageedit__line","stroke-width",O-5,"fill",A,"stroke",A]);var F=document.createElementNS(i.svgPath,"g");i.setAttributeForObj(F,["id",i.temp_id+"--group","class","zimageedit__line"]),e(F).insertBefore("#zimageedit__focus--shape"),e(F).append(M).append(P);var B;i.setPropertiesForSelectedObject("textarea");var N=i.textFontSize+15,k=i.editorSVG.getAttribute("viewBox").split(/\s+|,/);w.left+w.width+150-parseFloat(k[0])<parseFloat(k[2])?(i.createTextarea(w.top+w.height/2-N/2,w.left+w.width+80,N+5,N,E),B="M"+(w.left+w.width)+" "+(w.top+w.height/2)+", "+(w.left+w.width+70)+" "+(w.top+w.height/2)):w.left+w.width-parseFloat(k[2])-parseFloat(k[0])<200&&w.top-parseFloat(k[1])+w.height+200<parseFloat(k[3])?(i.createTextarea(w.top+w.height+100,w.left+w.width/2,N+5,N,E),B="M"+(w.left+w.width/2)+" "+(w.top+w.height)+", "+(w.left+w.width/2)+" "+(w.top+w.height+75)):(i.createTextarea(w.top+w.height/2-N/2,w.left-250,170,N,E),B="M"+w.left+" "+(w.top+w.height/2)+", "+(w.left-70)+" "+(w.top+w.height/2),e("#"+E).data("resized",!0)),M.setAttribute("d",B),i.changeArrowHeadValues(i.temp_id+"--line",i.temp_id),i.textID=E,e("#"+E).focus(),i.textareaSelected=!0,i._idSelected=i.temp_id,i.isDraw=!0,i.pushIntoStack("create"),i._idSelected=E,i.pushIntoStack("create"),i.undoStack.push(2),i.checkForContinuousDrawing(!0),i._noOfIdSelected.length=0,i._noOfIdSelected.push("#"+i._idSelected),i.drawnElements.push(i._idSelected),i.lastDrawnId=E,i.showProperties(E,"textarea"),i.textID=E,i.lastAction="draw",i.actionDone="create",i.textareaCreated=!0,i.removePlusAttributes()}}else if(void 0!==l){if("glow"===l){i.colorPalatteMenu.zmenu("hide","#zimageeditor__colorpalatte--menu");var D=i._idSelected;for(i.pushIntoStack("resize"),i.isDraw=!0,b=i._noOfIdSelected.length,v=0;b>v;v++)D=i._noOfIdSelected[v],D=D.substr(1,D.length),e("#zimageedit__icon--textglow").prop("checked")===!0?i.applyTextShadow(D,!0):i.applyTextShadow(D,!1);return 1===b&&"undefined"!==i.focussedTextareaID&&e("#"+i.focussedTextareaID).focus(),i.pushIntoStack("resize"),!1}"color"===l&&(i.lastHover=e(o.menuitem),i.tagSelected="text",i.init_properties("text"),i.handleMenuOpen(t,i.colorPalatteMenu,"top"))}else if(void 0!==m)"undo"===m?(i.undoFunc(),i._idSelected=void 0):"redo"===m?i.redoFunc():"paste"===m?i.pasteElements():"copy"===m?i.copyElements():"crop"===m?i.CropDone():"cancel"===m?i.onCropCancel():"zoomIn"===m?i.handleZoomCases("zoomin"):"zoomOut"===m?i.handleZoomCases("zoomout"):i.layeringFunction(m,i._idSelected);else if(void 0!==h)if("fitToWidth"!==h&&"fitToScreen"!==h&&"actualSize"!==h)i.isFitToScreen=!1,i.handleZoomCases(parseFloat(h));else if("actualSize"===h)i.isFitToScreen=!1,h=100,i.handleZoomCases(parseFloat(h));else if("fitToScreen"===h){var V=i.getCurrentCanvasDimensions(),L=i.getWindowDimensions();i.isFitToScreen=!0;var H=L.width-220,W=L.height-150;W>V[1]&&(W=V[1]),H>V[0]&&(H=V[0]);var R=Math.min(H/V[0],W/V[1]);h=parseFloat(V[0]*R/V[0]*100),i.handleZoomCases(parseFloat(h))}else if("fitToWidth"===h){var V=i.getCurrentCanvasDimensions(),L=i.getWindowDimensions();H=L.width-220,W=i._imageHeight;var R=Math.min(H/i._imageWidth,W/i._imageHeight);h=parseFloat(V[0]*R/V[0]*100),i.handleZoomCases(parseFloat(h)),e("#zimageeditor__container").css("overflow-x","hidden")}}).on("zmenusubmenuitemclick.zimageeditor",function(){return ZComponents.$document.trigger("mouseup"),!1})},initFunction:function(){i.isIEBrowser||e(window).off("resize.zimageedit").on("resize.zimageedit",function(){if(i.commandKeyPressed&&(i.plusKeyPressed||i.minusKeyPressed))return 0;var t,o,a,n,r,s,l=0;"none"!==i._imageCanvas.css("display")?(l=1,t=parseFloat(i._imageCanvas.attr("width")),o=parseFloat(i._imageCanvas.attr("height"))):(t=parseFloat(i._imageCropCanvas.attr("width")),o=parseFloat(i._imageCropCanvas.attr("height")));var d=e(window).width(),c=e(window).height(),h=d-220,u=c-150;if(i.isFitToScreen===!1&&(o>u||t>h))return!1;u>o&&(u=o),h>t&&(h=t);var m=Math.min(h/t,u/o);r=t*m,s=o*m,i.currentZoomValue=100*m,i.changeZoomTextValue(i.currentZoomValue),a=(d-r)/2,n=(c-s)/2,1===l?i._imageCanvas.css({width:r,height:s}):i._imageCropCanvas.css({width:r,height:s}),i.SVGElement.attr({width:r>0?r:0,height:s>0?s:0}),e("#zimageeditor__image").css({left:a-110>0?a-110:0,top:n-80>0?n-80:0,width:r,height:s}),i.svgContainer.css({left:a-110>0?a-110:0,top:n-80>0?n-80:0,width:r,height:s}),clearTimeout(i.resizeTimeout),i.resizeTimeout=setTimeout(function(){i.zoomFunction()},200)});var t=document.getElementById("zimageedit__canvas--blur");i._ctx3=t.getContext("2d"),i.orgin_ctx2=t.getContext("2d");var o=e("<canvas>").attr({width:i._imageWidth,height:i._imageHeight,id:"zeditcanvastempblur"});i.blurCompleted=!1,e("#zimageeditor__image").append(o),stackBlurImage(i.inputImageId,"zeditcanvastempblur",30,!1);var a=document.getElementById("zeditcanvastempblur");i._ctx3.drawImage(a,0,0,i._imageWidth,i._imageHeight),e("#zeditcanvastempblur").remove(),i.blurCompleted=!0,"blur"===i._selectedTool&&(ZAlertBanner.hide(".zimageedit__blur--initBanner"),i.cursorHandling({type:"toolSelect",tool:"blur"}))},changeZoomTextValue:function(t){e("#zimageeditor__zoom").find("span").text(parseInt(t)+"%"),parseInt(t)<10&&e("#zimageeditor__btns--zoomOut").attr("disabled","true")},getCurrentCanvasDimensions:function(){var e=i._imageCropCanvas;return"none"!==i._imageCanvas.css("display")&&(e=i._imageCanvas),[parseFloat(e.attr("width")),parseFloat(e.attr("height")),parseFloat(e.css("width")),parseFloat(e.css("height"))]},getWindowDimensions:function(){return{width:e(window).width(),height:e(window).height()}},_editActions:function(){var t,o,a,n,r,s,l=this,d=!1;e("#zimageeditor--fontsize--slider").off("mousedown").on("mousedown",function(){i.fontSliderMove=!0}),i.toolMove=!1,e("#zimageeditor .zimageeditor__tools--header, #zimageeditor--propertiesTool--header").off("mousedown mouseup mousemove").on("mousedown",function(t){"zimageeditor--propertiesTool--header"!==e(this).attr("id")&&(e(".zmenu").zmenu("hide"),i.resetProperties(),i.removePlusAttributes());var o,a;"zimageeditor__tools--header"===e(this)[0].className?(o=parseFloat(e("#zimageeditor .zimageeditor__tools").position().top),a=parseFloat(e("#zimageeditor .zimageeditor__tools").position().left),i.toolbarMove=!0):(o=parseFloat(i.propertiesMenu.css("top")),a=parseFloat(i.propertiesMenu.css("left")),i.colorPalatteMenu.is(":visible")===!0&&i.colorPalatteMenu.zmenu("hide","#zimageeditor__colorpalatte--menu"),e("#zimageeditor__strokewidth--menu").is(":visible")===!0&&e("#zimageeditor__strokewidth--menu").zmenu("hide","#zimageeditor__strokewidth--menu"),i.propertiesMove=!0),i._imageContainer.addClass("zimagedit__noselect"),i.toolMove=!0,i.clickPosition[0]=t.clientX-a,i.clickPosition[1]=t.clientY-o,i.cursorHandling({event:"headerMouseDown"})}).on("mouseup",function(){i.toolbarMove=i.propertiesMove=i.toolMove=!1,i._imageContainer.removeClass("zimagedit__noselect"),i.cursorHandling({event:"headerMouseUp"})}).off("mousemove").on("mousemove",function(e){i.toolMove===!0&&i.moveToolbar(e,i.toolbarMove,i.propertiesMove)}),e("#zimageeditor").off("mouseup click").on("mouseup",function(){i.toolMove===!0&&(i.toolMove=!1),i.propertiesMove===!0&&(i.propertiesMove=!1)}).on("click",function(e){e.preventDefault(),e.stopPropagation()}),e("#zimageeditor .zimageeditor__header").off("click").on("click",function(){i.hideProperties(),i.resetMultiSelect(),i.resetProperties()});var c;i.tapped=!1,e("#zimageeditor__container").off("contextmenu mousedown mousemove mouseup click dblclick").on("contextmenu",function(e){e.preventDefault(),e.stopPropagation();var t=i.checkForSelectedElement(["svg"],e.target.id);i._noOfIdSelected.length<2&&"zimageeditor__svgcontainer"!==e.target.id&&(i.rightClickPreventDefault=!0,d=i.handleRightClick(e,t),i.isRightClick=!0)}).on("mousedown",function(a){if(i.mousedown=!0,e(".zimageeditor__btns--focus").removeClass("zimageeditor__btns--focus"),3===a.which)return a.stopPropagation(),a.preventDefault(),!1;if(e("#zimageeditor__zoom--menu").is(":visible")&&e("#zimageeditor__zoom--menu").zmenu("hide"),i.blurMenu.is(":visible")&&i.blurMenu.zmenu("hide"),i.numberingMenu.is(":visible")&&i.numberingMenu.zmenu("hide"),i.markerMenu.is(":visible")&&i.markerMenu.zmenu("hide"),i.shapesMenu.is(":visible")&&i.shapesMenu.zmenu("hide"),i.lineMenu.is(":visible")&&i.lineMenu.zmenu("hide"),i.isRightClick=!1,void 0!==i.lastHover){var h=e("#zimageeditor__"+i.lastHover.data("objectmenu")+"--menu");e(h).is(":visible")===!0&&e(h).zmenu("hide")}if("ontouchstart"in document.documentElement){var u=500;i.timer=setTimeout(function(){var e=i.checkForSelectedElement(["svg"],a.target.id);i._noOfIdSelected.length<2&&"zimageeditor__svgcontainer"!==a.target.id&&(i.rightClickPreventDefault=!0,d=i.handleRightClick(a,e),i.isRightClick=!0)},u)}o=a,window.hasOwnProperty("event")&&window.event.shiftKey===!1&&(i.shiftKeyPressed=!1);var m,p,g,_,f,v,b=i.checkForSelectedElement(["svg"],a.target.id);_=i.typeOfElement(a.target.id),c="textarea"===_;var y=i.checkForSelectedElement(["marker","pencil"],a.target.id);if(r=a.target.className,"object"==typeof r&&(r=r.baseVal),c===!0||-1!=r.indexOf("zimageedit__active--shape")&&"visible"===e(".zimageedit__active--text--right").css("visibility")&&"none"!==e(".zimageedit__active--text--right").css("display")?i.textareaSelected=!0:(i.textareaSelected=i.textareaCreated=!1,i.focussedTextareaID="undefined"),i.shiftKeyPressed===!0&&"zimageeditor__svgeditor"===a.target.id)return 0;if(-1===r.indexOf("zimageedit__active--text--")&&(-1!==r.indexOf("zimageedit__active--")&&-1===r.indexOf("zimageedit__active--text--")==0||1==c)&&(i.focussedTextareaID="undefined"),i.shiftKeyPressed===!0&&void 0===i._selectedTool&&void 0!==r&&("zimageedit__"===r.toString().substr(0,12)||-1!==r.indexOf("zimageedit__numbering"))&&"move"!==i.lastAction&&"zimageedit__focus--multiselect"!==r)return l._idSelected=a.target.id,i._idSelected=i.extractID(a.target.id),i.multiSelectFlag=!0,i.removeBorderForNumbering(),y&&i.removeShadowForMarker(),void i.multiSelect("#"+l._idSelected,a);if(-1===r.indexOf("zimageedit__active--")&&-1===a.target.id.indexOf("zimageedit__plus--cirlce")){for(i.resize_flag=!0,v=i._noOfIdSelected.length,f=0,v--;v>=0;--v)if(i._noOfIdSelected[v]==="#"+i._idSelected){f=1;break}v=i._noOfIdSelected.length;var z=!0;for(v--;v>=0;--v)if(i._noOfIdSelected[v]==="#"+a.target.id){z=!1;break}if(0===f||z===!0&&i.cropCreated===!1){if(i.multiSelectFlag=!1,i.showBorderFocus(),b===!1&&void 0!==i._idSelected){var S=i.typeOfElement(i._idSelected);i.setPropertiesForSelectedObject(S),i.elementSelect("#"+i._idSelected,"return")}i.resetMultiSelect(),void 0!==i._idSelected&&i._noOfIdSelected.push("#"+i._idSelected)}}y===!0||c||b===!0&&"textarea"===i._selectedTool||-1!==r.indexOf("zimageedit__active--text--")?y===!0?(i.removeBorderFocus(),i.setPropertiesForSelectedObject("polyline")):i.setPropertiesForSelectedObject("textarea"):3!==a.which&&(i.cropCreated===!0&&(_="crop"),("svg"===_&&"line"===i._selectedTool||-1!=r.indexOf("zimageedit__active--c1c"))&&(_="line"),i.setPropertiesForSelectedObject(_));var w=!1;s=!1,3!==a.which?(d=!1,i.rightClickMenu.is(":visible")===!0&&i.rightClickMenu.zmenu("hide"),i.rightClickPreventDefault=!1):(a.stopPropagation(),a.preventDefault()),"crop"===i._selectedTool&&(i._idSelected="zimageedit__crop",i._noOfIdSelected.length=0,i._noOfIdSelected.push("#zimageedit__crop")),i.markerSelected===!0&&i.removeShadowForMarker(),n=a.target.id,"zimageeditor__svgeditor"!==a.target.id&&"zimageeditor__svgcontainer"!==a.target.id||3===a.which||(i._noOfIdSelected.length=0),c===!0&&e("#"+a.target.id).is(":focus")===!1&&(a.preventDefault(),s=!0);var x="numbering"===i.typeOfElement(a.target.id);x&&"numbering"===e("#"+a.target.id).attr("type-contains")&&e("#"+a.target.id).prop("readonly")===!1&&(w=!0),i.cursorHandling(a);var C=r;if(w===!1&&void 0!==r&&0!==C.length&&"zimageedit__focus--numbering"!==C&&"zimageedit__plus"!==r&&3!==a.which){if(void 0!==r&&"zimageedit__active--"===r.substr(26,20)&&(l.row_val=r.slice(46,48),l.col_val=r.slice(48,50),""!==l.col_val))for(v=i._noOfIdSelected.length,v--;v>=0;--v)i.boundaryClicked[v]=i.row_val+" "+i.col_val;var k=i.checkForSelectedElement(["numbering"],a.target.id);if((void 0===r||"zimageedit__active--shape"!==r.substr(0,25))&&"zimageedit__"!==r.substr(0,12)&&"zimageedit__crop"!==r&&k!==!0&&i.cropSelected!==!0&&"zimageedit__focus--shape"!==r||i.lastDrawnId!==i.extractID(a.target.id)&&i.cropCreated!==!0&&void 0!==i._selectedTool&&-1==r.indexOf("zimageedit__active")){if(i._imageContainer.addClass("zimagedit__noselect"),("numbering_"!==i.previousSelectedTool&&"numbering_"!==i._selectedTool||"numbering"!==i._selectedTool)&&i.hideProperties(),i.removePlusAttributes(),i.multiSelectFlag=!1,i.resize_flag=!0,l.actionDone="create",l.isDraw=!1,t=l.initDrawElements(a),i.setPropertiesForSelectedObject(i._selectedTool),p=i.editorSVG.createSVGPoint(),p.x=a.clientX,p.y=a.clientY,p=p.matrixTransform(i.editorSVG.getScreenCTM().inverse()),t[0]=p.x,t[1]=p.y,i.showBorderFocus(),"numbering_"===i._selectedTool){i.orginalCanvasFitToWidth,i._imageWidth,i.cursorHandling({type:"beforeDraw",tool:"numbering_"}),l.createNumbering(p.x,p.y-7*i.fitToWidthZoomValue/100);var I="";i.isIEBrowser===!0&&(I="--IE"),e("#"+i._idSelected+"--group").attr("class","zimageedit__numbering zimageedit__move--cursor"+I),i.lastDrawnId=i._idSelected,l._drag=!1,i.numberingCreated=!0,i.checkForPlusDisplay(e("#"+i._idSelected).attr("class"),a,i._idSelected)}else if("textarea"===i._selectedTool){var T,E;T=p.y,E=p.x,i.createTextarea(T-8,E-5,i.textFontSize+20,i.textFontSize+15,i.temp_id),i.textID=i.temp_id,i.drawnElements.push(i.temp_id),i.cursorHandling({type:"select__tool"}),i.textareaSelected=!0,i._noOfIdSelected.length=0,i._noOfIdSelected.push("#"+i.textID),i._idSelected=i.temp_id,i.isDraw=!0,i.lastAction="draw",i.actionDone="create",i.textareaCreated=!0}}else{if("foreignObject"===a.target.nodeName)return;if(l.actionDone="resize",t=[a.clientX,a.clientY],p=i.editorSVG.createSVGPoint(),p.x=a.clientX,p.y=a.clientY,p=p.matrixTransform(i.editorSVG.getScreenCTM().inverse()),t[0]=p.x,t[1]=p.y,l.previousX=p.x,l.previousY=p.y,l.resizeElementSelected=!0,l.getValuesForFunc(l._idSelected),i.removePlusAttributes(),""!==r&&i.removePlusAttributes(),i.multiSelectFlag===!1&&i.hideProperties(),i.stackPushFlag=!1,l.isDraw=!0,("zimageedit__"===r.substr(0,12)||"zimageedit__crop"===r||k===!0||"zimageedit__focus--shape"===r&&"zimageedit__active--shape"!==r.substr(0,25))&&(-1==r.indexOf("zimageedit__focus--shape")&&-1==r.indexOf("zimageedit__active--shape")&&(i._idSelected=a.target.id),-1!=r.indexOf("zimageedit__line")&&(i._idSelected=e("#"+i._idSelected).parent().attr("id"),i._idSelected=i._idSelected.substr(0,i._idSelected.length-7)),l.lastAction="select",l.getValuesForFunc(l._idSelected),i.elementMove=!0,-1!==r.indexOf("zimageedit__active--text--")&&(i.resizeElementSelected=!1),"zimageeditor__svgeditor"!==a.target.id&&-1===r.indexOf("zimageedit__active--text--")&&(""!==a.target.id&&(i._idSelected=a.target.id),""!==r&&i.removePlusAttributes(),i.stackPushFlag=!1,l.isDraw=!0,("zimageedit__"===r.substr(0,12)||"zimageedit__crop"===r||k===!0)&&"zimageedit__focus--shape"!==r&&-1==r.indexOf("zimageedit__active--shape")&&(i._idSelected=a.target.id,-1!=r.indexOf("zimageedit__line")&&(i._idSelected=e("#"+i._idSelected).parent().attr("id"),i._idSelected=i._idSelected.substr(0,i._idSelected.length-7),n=i._idSelected),l.lastAction="select",l.getValuesForFunc(l._idSelected),i.shiftKeyPressed!==!0)))){for(v=i._noOfIdSelected.length,f=0,v--;v>=0;--v)if(i._noOfIdSelected[v]==="#"+i._idSelected){f=1;break}if(0===f?(i.multiSelectFlag=!1,k!==!0?(i.showBorderFocus(),i.markerSelected=!1,g=i.checkForSelectedElement(["marker"],i._idSelected),m=i.checkForSelectedElement(["pencil"],i._idSelected),(g===!0||m===!0)&&i.createShadowForMarker(i._idSelected),i.elementSelect("#"+i._idSelected,"return","color_select")):i._idSelected=i.extractID(i._idSelected),i.resetMultiSelect(),i._noOfIdSelected.push("#"+i._idSelected)):(i.markerSelected=!1,g=i.checkForSelectedElement(["marker"],i._idSelected),m=i.checkForSelectedElement(["pencil"],i._idSelected),(g===!0||m===!0)&&i.createShadowForMarker(i._idSelected)),k===!0&&i.multiSelectFlag===!1){i._idSelected=i.extractID(a.target.id),e("#"+i._idSelected).prop("readonly","readonly");var M,A,O=e("#"+i._idSelected+"--circle");M=parseFloat(e(O).attr("cx")),A=parseFloat(e(O).attr("cy")),i.showBroderForNumbering(M,A,i._idSelected),i.changeIconColorProperties(void 0,i.regtohex_convert(e("#"+i._idSelected+"--path").attr("stroke")))}}"crop"===i._selectedTool&&("zimageedit__crop"!==a.target.id&&(i.elementMove=!1),i._noOfIdSelected.length=0,i._idSelected="zimageedit__crop",i._noOfIdSelected.push("#zimageedit__crop"))}}i.textareaSelected===!0&&-1!==r.indexOf("zimageedit__active--shape")&&i.cropCreated===!1&&i.setPropertiesForSelectedObject("textarea"),"zimageedit__focus--numbering"===r&&(i.isNumberingBeackSelected=!0)}).on("mousemove",function(o){if(i.toolMove===!0&&i.moveToolbar(o,i.toolbarMove,i.propertiesMove),"foreignObject"===o.target.nodeName?e("#"+o.target.id).removeClass("zimageedit__move--cursor"):"TEXTAREA"!==o.target.nodeName||i._toolSelected||!e("#"+o.target.id).parent().hasClass("zimageedit__move--cursor")&&o.target.readOnly&&e("#"+o.target.id).parent().addClass("zimageedit__textarea--fobject zimageedit__move--cursor"),i.mousedown===!0&&d===!1){var a,h,u;if(i.timer&&clearTimeout(i.timer),l._drag&&"blur"!==l._selectedTool&&"undefined"!=typeof i._selectedTool)o.target.className.baseVal,i.lastAction="draw",i.dragOnly=!0,l._drawSvgElements(o,l._selectedTool,t),l.isDraw=!0;else if(l._drag&&"blur"===l._selectedTool&&i.blurCompleted===!0)0===e("#"+l.temp_id).length&&(l.create_canvas(),i.lastAction="createcanvas"),e("#zimageeditor .zimageedit__focus--shape").css("visibility","visible"),i.isDraw=!0,i.functionForBlur(o,l,t);else if(!l.resizeElementSelected||"zimageedit__active--shape"!==r.substr(0,25)||s!==!1||i.resize_flag!==!0&&i.multiSelect!==!1){if(i.isNumberingBeackSelected){if(a=i._noOfIdSelected.length,i.stackPushFlag===!1)for(i.stackPushFlag=!0,a--;a>=0;--a)h=i._noOfIdSelected[a],h=h.substr(1,h.length),i._idSelected=h,i.pushIntoTempStack(i._idSelected,2*a);i.actionDone="resize",i.lastAction="move",i.moveNumberinngBeack(o.target.id,o,!0)}else if(i.elementMove===!0||s===!0){if(a=i._noOfIdSelected.length,u=i.editorSVG.createSVGPoint(),u.x=o.clientX,u.y=o.clientY,u=u.matrixTransform(i.editorSVG.getScreenCTM().inverse()),i.stackPushFlag===!1){i.removePlusAttributes(),i.stackPushFlag=!0;var m=0;for(a--;a>=0;--a)h=i._noOfIdSelected[a],h=h.substr(1,h.length),i._idSelected=h,i.pushIntoTempStack(i._idSelected,2*a),m=1;i.multiSelectFlag===!1&&i.hideProperties(),1===m&&(i._checkFlagMouseAction=!0)}if(a=i._noOfIdSelected.length,i._checkFlagMouseAction===!0&&c===!1&&n!==i.textID||a>1||s===!0)for(o.preventDefault(),a--;a>=0;--a)h=i._noOfIdSelected[a],h=h.substr(1,h.length),i._idSelected=h,l.elementMouseMove(o,t);i.lastAction="move",i.previousX=u.x,i.previousY=u.y,l.targetAction="mousemove"}}else{if(a=i._noOfIdSelected.length,i.lastAction="resize",i.stackPushFlag===!1){for(i.stackPushFlag=!0,a--;a>=0;--a)h=i._noOfIdSelected[a],h=h.substr(1,h.length),i._idSelected=h,i.pushIntoTempStack(i._idSelected,2*a);-1!=e("#"+i._idSelected).attr("class").indexOf("zimageedit__textarea")&&i.setPropertiesForSelectedObject("textarea"),o.onResize=!0,i.cursorHandling(o)}if(a=i._noOfIdSelected.length,i._noOfIdSelected.length<=1)for(o.preventDefault(),a--;a>=0;--a)h=i._noOfIdSelected[a],h=h.substr(1,h.length),i._idSelected=h,l.getValuesForFunc(i._idSelected),l.resizeElementsFunc(t,o,a);u=i.editorSVG.createSVGPoint(),u.x=o.clientX,u.y=o.clientY,u=u.matrixTransform(i.editorSVG.getScreenCTM().inverse()),i.previousX=u.x,i.previousY=u.y}}else i.lastAction="none",l.actionDone="none"}).on("mouseup",function(n){if(i._doubleTouchHandler(n),i.timer&&clearTimeout(i.timer),"foreignObject"===n.target.nodeName&&e(".zimageeditor__header").trigger("click"),"none"===i.lastAction&&"create"===i.actionDone){var d,c,h,u;if(d=t[1],c=t[0],"rectangle"===i._selectedTool?(h=132,u=100):"ellipse"===i._selectedTool&&(d+=50,c+=66,h=66,u=50),"rectangle"===i._selectedTool||"ellipse"===i._selectedTool||"line"===i._selectedTool){if(i._idSelected=e(i._elem).attr("id"),e(i._elem).insertBefore("#zimageedit__focus--shape"),"line"===i._selectedTool){h=t[0]+132,u=t[1];var m=document.createElementNS(i.svgPath,"g");m.setAttribute("id",i._idSelected+"--group"),e(m).attr("class","zimageedit__line"),e(m).insertBefore("#zimageedit__focus--shape"),e("#"+i._idSelected).appendTo("#"+i._idSelected+"--group"),e("#zimageedit__triangle").clone().attr({id:i._idSelected+"--line","class":"zimageedit__line"}).css("visibility","visible").appendTo("#"+i._idSelected+"--group"),"true"===e("#"+i._idSelected+"--line").attr("data-stline")&&e("#"+i._idSelected+"--line").css("visibility","hidden")}i.elementValues={tool:i._selectedTool,top:d,left:c,width:h,height:u},i.moveElements(i.elementValues),i._noOfIdSelected.length=0,i._noOfIdSelected.push("#"+i._idSelected),i.checkForPlusDisplay(e("#"+i._idSelected).attr("class"),n,i._idSelected),l.actionDone="create",i.drawObject=i.isDraw=!0,i.lastDrawnId=i._idSelected}else"marker"===i._selectedTool||"polyline"===i._selectedTool?(i._idSelected=e(i._elem).attr("id"),e(i._elem).insertBefore("#zimageedit__focus--shape"),i._elem.setAttributeNS(null,"points",""+c+" "+d+" "+c+" "+d+" "),l.actionDone="create",i.drawObject=i.isDraw=!0,i._noOfIdSelected.length=0,i._noOfIdSelected.push("#"+i._idSelected),i.checkForPlusDisplay(e("#"+i._idSelected).attr("class"),n,i._idSelected),i.lastDrawnId=i._idSelected):"smudge"===i._selectedTool?(i.makeSmudge(n,"smudge",t),i._noOfIdSelected.length=0):"textarea"===i._selectedTool&&(randomNum=Math.round(1e7*Math.random()),i.temp_id="zimageedit__shapes--"+randomNum,i.createTextarea(t[1],t[0],32,32,i.temp_id),l.actionDone="create",i._idSelected=i.temp_id,i.drawObject=i.isDraw=!0,i._noOfIdSelected.length=0,i._noOfIdSelected.push("#"+i._idSelected),e("#"+i._idSelected).focus(),i.lastDrawnId=i._idSelected);i.textareaCreated=!1}var p,g;if(i.mousedown=!1,a=n,i._imageContainer.removeClass("zimagedit__noselect"),i.smudgeStackFlag===!0&&(i.smudgeStackFlag=!1,i.smudgeStackPosition+=1),i.mouseupFunction(l,n),r=n.target.className,void 0!==r.baseVal&&(r=r.baseVal),i.multiSelectFlag===!0&&e("#"+i.textID).blur(),s=!1,"mousemove"===l.targetAction)for(g=i._noOfIdSelected.length,g--;g>=0;--g){p=i._noOfIdSelected[g],p=p.substr(1,p.length),i._idSelected=p;var _=i.typeOfElement(i._idSelected);("pencil"===_||"marker"===_)&&i.setValuesFromTranslate(),i.targetAction=" "}var f=r;if(l._drag=i.elementMove=!1,i.cursorHandling(n,{mousedown:o}),void 0!==r&&0!==f.length){var v=i._idSelected;if("crop"!==i._selectedTool){if("move"===i.lastAction||"resize"===i.lastAction&&(o.clientX!==a.clientX||o.clientY!==a.clientY)){for(g=i._noOfIdSelected.length,i._checkFlagMouseAction=!1,--g;g>=0;--g)p=i._noOfIdSelected[g],p=p.substr(1,p.length),i._idSelected=p,i.pushIntoTempStack(i._idSelected,2*g+1);i.copyFromTempToUndoStack()}var b=!1;"create"===l.actionDone&&0!==i.lastAction.length&&("numbering_"===i._selectedTool&&"numbering"===i.numberingTagSelected&&e("#"+i._idSelected).attr("readOnly",!0),"smudge"===i._selectedTool?(b=!0,i.lastDrawnId=void 0,i.smudgeStack[i.smudgeStack.length-1][0]=i._imageWidth/i.actualWidth):(i.pushIntoStack("create"),i.drawObject=!1,i.checkForContinuousDrawing()),"marker"===i._selectedTool&&(i._noOfIdSelected.length=0),"smudge"!==i._selectedTool&&"blur"!==i._selectedTool&&void 0!==i._selectedTool&&void 0!==i._idSelected&&i.drawnElements.push(i._idSelected))}b===!1&&"create"!==l.actionDone&&i.multiSelectFlag===!1&&i.isRightClick===!1&&void 0!==i._noOfIdSelected[0]&&i.checkForPlusDisplay(e(i._noOfIdSelected[0]).attr("class"),n,i._noOfIdSelected[0].substr(1,i._noOfIdSelected[0].length)),i._idSelected=v}if(i.isNumberingBeackSelected===!0&&i.removeTextSelection(),i.isNumberingBeackSelected=l.resizeElementSelected=i.stackPushFlag=!1,i.textareaCreated===!0&&(e("#"+i.textID).focus(),i.textareaCreated=!1),"draw"===i.lastAction&&"create"===i.actionDone&&"blur"!==i._selectedTool){var y=e("#"+i._idSelected).attr("class");void 0!==y&&(y=y.substr(12,y.length),"ellipse"===i._selectedTool||"rectangle"===i._selectedTool&&("ellipse"===y||"rectangle"===y)?i.showPlusMenu(i._idSelected):"marker"===y||"marker"===i._selectedTool?i.smoothenPolylLine(i._idSelected):"polyline"===y&&(i.smoothenPolylLine(i._idSelected),i.createShadowForMarker(i._idSelected),i.checkForPlusDisplay(e("#"+i._idSelected).attr("class"),n,i._idSelected))),i.multiSelectFlag===!1&&1===i._noOfIdSelected.length&&i.checkForPlusDisplay(e(i._noOfIdSelected[0]).attr("class"),n,i._noOfIdSelected[0].substr(1,i._noOfIdSelected[0].length))}}).on("click",function(t){i.mousedown=!1;var o=t.target.id;i._imageContainer.removeClass("zimagedit__noselect");var a=t.target.className;if("object"==typeof a&&(a=a.baseVal),-1!=a.indexOf("zimageedit__line")&&(o=e("#"+o).parent().attr("id"),o=o.substr(0,o.length-7)),"zimageedit__focus--numbering"===a&&i.moveNumberinngBeack(o,t,!1),"zimageedit__numbering"===a.substr(29,50)&&(t.preventDefault(),0==e("#"+o).is(":focus")&&e("#"+o).blur()),"select"===i.lastAction&&"resize"===i.actionDone){var n=i.checkForSelectedElement(["marker"],i._idSelected);n&&(i.markerSelected=!0,i.markerSelectedId=i._idSelected+"--shadow",i.createShadowForMarker(i._idSelected))}void 0!==a.baseVal&&(a=a.baseVal),"zimageeditor__svgeditor"===o&&"resize"!==l.actionDone&&i.multiSelectFlag===!1&&(i.resetMultiSelect(),void 0!==i._idSelected&&i._noOfIdSelected.push("#"+i._idSelected),"draw"===i.lastAction&&"create"===i.actionDone&&"marker"===i._selectedTool&&(i._noOfIdSelected.length=0)),void 0!==a&&"zimageedit__numbering"===a.slice(29,50)&&(l._idSelected=o),void 0!==a&&-1!==a.indexOf("zimageeditor__svgeditor")&&(i.temp_id=void 0),i.lastAction="none",i.actionDone="none"}).on("dblclick",function(t){var o=t.target.id,a=t.target.className;if("object"==typeof a&&(a=a.baseVal),i.cursorHandling(t),"crop"===i._selectedTool&&i.CropDone(),"zimageedit__numbering"===a.substr(29,50)&&"numbering"===e("#"+t.target.id).attr("type-contains")&&i.multiSelectFlag===!1){t.preventDefault(),e("#"+o).removeAttr("readonly").removeAttr("disabled").focus();var n=document.getElementById(o);n.setSelectionRange(n.value.length,n.value.length),i.numberingSelected=o}}),e("body").off("keydown.zimageeditor keyup.zimageeditor mouseup.zimageeditor mousemove.zimageeditor").on("keydown.zimageeditor",function(e){17===e.keyCode?i.ctrlKeyPressed=!0:16===e.keyCode?i.shiftKeyPressed=!0:91===e.keyCode||93===e.keyCode||224===e.keyCode?i.commandKeyPressed=!0:187===e.keyCode?i.plusKeyPressed=!0:189===e.keyCode&&(i.minusKeyPressed=!0),l.keypressevents(e)}).on("keyup.zimageeditor",function(e){17===e.keyCode?i.ctrlKeyPressed=!1:16===e.keyCode?i.shiftKeyPressed=!1:91===e.keyCode||93===e.keyCode||224===e.keyCode?i.commandKeyPressed=!1:187===e.keyCode?i.plusKeyPressed=!1:189===e.keyCode&&(i.minusKeyPressed=!1)}).on("mouseup.zimageeditor",function(){i.fontSliderMove=i.toolMove=!1}).on("mousemove.zimageeditor",function(e){i.toolMove===!0&&i.moveToolbar(e,i.toolbarMove,i.propertiesMove)})},checkForContinuousDrawing:function(e){("textarea"===i._selectedTool||e===!0)&&(i._selectedTool=void 0,i._toolSelected=!1,i.cursorHandling({type:"select__tool"}))},cursorHandling:function(t,o){var a=void 0,n="";if("beforeDraw"===t.type){if("marker"===t.tool||"polyline"===t.tool||"numbering_"===t.tool||"smudge"===t.tool){i.isIEBrowser===!0&&(n="--IE");var r="brush";"polyline"===t.tool?r="pencil":"numbering_"===t.tool&&(r=i.numberingTagSelected),a=r}"rectangle"===t.tool||"line"===t.tool||"ellipse"===t.tool||"blur"===t.tool?a="crosshair":"textarea"===t.tool&&(a="text")}else if("mousedown"===t.type)void 0!==i.numberingSelected&&t.target.id!==i.numberingSelected&&e("#"+t.target.id).is(":focus")===!1&&e("#"+i.numberingSelected).attr("readonly","readonly"),t.target.id!==i.textID&&e("#"+i.textID).blur();else if("mousemove"===t.type)1==t.onResize&&(i.cursorType=i.editContainer.css("cursor"),i.editContainer.css("cursor",e("#zimageeditor .zimageedit__active--"+i.row_val+i.col_val).css("cursor")));else if("mouseup"===t.type){if("create"===i.actionDone&&0!==i.lastAction.length||i.drawObject===!0){"polyline"===i._selectedTool||"marker"===i._selectedTool?(e("#"+i._idSelected).attr("class","zimageedit__"+i._selectedTool),"polyline"===i._selectedTool&&i.createShadowForMarker(i._idSelected)):("line"===i._selectedTool||"rectangle"===i._selectedTool)&&i.drawObject===!0&&(i.isDraw=!0,i.pushIntoStack("create"),i.isDraw=!1),i.isSafari===!0&&e("#"+i._idSelected).css("pointer-events","fill");var s=e("#"+i._idSelected).attr("class");s+=" zimageedit__move--cursor","line"===i._selectedTool||"numbering_"===i._selectedTool?i.isIEBrowser&&"numbering_"===i._selectedTool?(s+="--IE",e("#"+i._idSelected+"--fobject").attr("class","zimagedit__numbering--fobject zimageedit__move--cursor")):e("#"+i._idSelected+"--group").attr("class",s):"textarea"!==i._selectedTool&&e("#"+i._idSelected).attr("class",s),i.drawObject===!0&&"ellipse"===i._selectedTool&&(i.isDraw=!0,i.pushIntoStack("create"),i.isDraw=!1),i.drawObject=!1}i.toolMove===!0&&(i.toolbarMove=i.propertiesMove=i.toolMove=!1,i.editContainer.css("cursor",i.cursorType)),"resize"===i.lastAction&&i.editContainer.css("cursor",i.cursorType),("move"===i.lastAction||"resize"===i.lastAction&&(o.mousedown.clientX!==t.clientX||o.mousedown.clientY!==t.clientY))&&1===i._noOfIdSelected.length&&i.checkForSelectedElement(["textarea"],i._noOfIdSelected[0].substr(1,i._noOfIdSelected[0].length))&&i._noOfIdSelected[0].substr(1,i._noOfIdSelected[0].length)==i.focussedTextareaID&&e("#"+i._idSelected).focus().addClass("zimageedit__text--cursor")}else if("toolSelect"===t.type){var l="";if(i.isIEBrowser===!0&&(l="--IE"),i.lastDrawnId=void 0,i.editContainer.attr("class","zimageeditor__container").css("cursor",""),"textarea"===t.tool?(i.editContainer.css("cursor","text"),i.changeIconColorProperties("#fff","none")):"marker"===t.tool||"smudge"===t.tool?i.editContainer.attr("class","zimageeditor__container zimageedit__brush--cursor"+l):"polyline"===t.tool?i.editContainer.attr("class","zimageeditor__container zimageedit__pencil--cursor"+l):"numbering_"===t.tool?i.editContainer.attr("class","zimageeditor__container zimageedit__"+i.numberingTagSelected+"--cursor"+l):"crop"===t.tool?i.editContainer.attr("class","zimageeditor__container").css("cursor","default"):void 0!==t.tool&&"none"!==t.tool&&i.editContainer.css("cursor","crosshair"),"blur"===t.tool&&i.blurCompleted===!1&&(i.editContainer.css("cursor","wait"),ZAlertBanner.show({type:"info",className:"zimageedit__blur--initBanner",message:i._getString("initalisingBlur.label"),display:"inline"})),void 0!==t.tool&&i.resetMultiSelect(),"marker"===i.previousSelectedTool||"polyline"===i.previousSelectedTool||"smudge"===i.previousSelectedTool||"numbering_"===i.previousSelectedTool)for(var d=0;d<i.drawnElements.length;d++){var c=i.typeOfElement(i.drawnElements[d]),h=e("#"+i.drawnElements[d]);"pencil"===c?c="polyline":"line"===c||"numbering"===c?h=e("#"+i.drawnElements[d]+"--group"):"textarea"===c&&(h=e("#"+i.drawnElements[d]+"--fobject")),h.attr("class","zimageedit__"+c)}if(void 0!==t.tool){if("marker"===t.tool||"polyline"===t.tool||"numbering_"===t.tool||"smudge"===t.tool){i.isIEBrowser===!0&&(n="--IE");var r="brush";"polyline"===t.tool?r="pencil":"numbering_"===t.tool&&(i.previousNumberingTagSelected=r=i.numberingTagSelected),a=r}"rectangle"===t.tool||"line"===t.tool||"ellipse"===t.tool||"blur"===t.tool?a="crosshair":"textarea"===t.tool&&(a="text"),i.previousSelectedTool=t.tool}else a="move",i.showBorderFocus()}else if("headerMouseDown"===t.type)i.cursorType=i.editContainer.css("cursor"),i.editContainer.css("cursor","move");else if("headerMouseUp"===t.type)i.editContainer.css("cursor",i.cursorType);else if("dblclick"===t.type){var u=(e("#"+t.target.id).attr("class"),i.typeOfElement(t.target.id));"numbering"===u&&"numbering"===e("#"+t.target.id).attr("type-contains")?e("#"+t.target.id).focus().addClass("zimageedit__text--cursor"):"textarea"==u&&i.multiSelectFlag===!1&&(e("#"+i.textID).attr("readonly","readonly").removeClass("zimageedit__text--cursor").removeClass("zimageedit__move--cursor"),i.textID=t.target.id,e("#"+t.target.id).addClass("zimageedit__text--cursor").removeAttr("readonly").focus())}else"select__tool"===t.type&&(i.options.isContinuousDraw&&(e(".zimageeditor__btns--active").removeClass("zimageeditor__btns--active"),e("#zimageeditor__btns--select").addClass("zimageeditor__btns--active")),i.editContainer.css("cursor","default"),a="move");if(void 0!==a)for(var d=0;d<i.drawnElements.length;d++){var c=i.typeOfElement(i.drawnElements[d]),h=e("#"+i.drawnElements[d]);"pencil"===c?c="polyline":"line"===c||"numbering"===c?("numbering"===c&&i.isIEBrowser&&e("#"+i.drawnElements[d]+"--fobject").attr("class","zimagedit__numbering--fobject zimageedit__"+a+"--cursor"+n),h=e("#"+i.drawnElements[d]+"--group")):"textarea"===c&&(h=e("#"+i.drawnElements[d]+"--fobject"),c+="--fobject"),h.attr("class","zimageedit__"+c+" zimageedit__"+a+"--cursor"+n)}},moveToolbar:function(t,o,a){var n,r;if(o===!0){i.toolBarMoved=!0;var s=60,l=371;n=parseFloat(i._bodyObj.css("width")),e("#zimageeditor .zimageeditor__tools").css(t.clientX-i.clickPosition[0]+s>n?{left:n-s}:{left:t.clientX-i.clickPosition[0]<0?0:t.clientX-i.clickPosition[0]}),r=parseFloat(e(window).height()),t.clientY-i.clickPosition[1]+l>r?e("#zimageeditor .zimageeditor__tools").css({top:r-l}):e("#zimageeditor  .zimageeditor__tools").css("top",t.clientY-i.clickPosition[1]>0?t.clientY-i.clickPosition[1]:0)}if(a===!0){i.propertiesBarMoved=!0;var d,c=i.propertiesMenu;d=parseFloat(c.css("width")),n=parseFloat(i._bodyObj.css("width")),c.css(t.clientX-i.clickPosition[0]+d+10>n?{left:n-d+10}:{left:t.clientX-i.clickPosition[0]}),r=parseFloat(e(window).height());var h=parseFloat(c.css("height"));c.css(t.clientY-i.clickPosition[1]+h+10>r?{top:r-h-10}:{top:t.clientY-i.clickPosition[1]>0?t.clientY-i.clickPosition[1]:0}),i.propertiesLeft=t.clientX-i.clickPosition[0],i.propertiesTop=t.clientY-i.clickPosition[1]}},numberingDisabled:function(t){for(var o=0;o<i.numberingTagElements.length;o++)e("#"+i.numberingTagElements[o]).attr("disabled",t)},handleRightClick:function(t,o){if(e(".zmenu").zmenu("hide"),t.preventDefault(),t.stopPropagation(),"zimageeditor__container"===t.target.id)return 0;var a={target:{id:t.target.id}},n=i.checkForSelectedElement(["textarea"],t.target.id),r=i.checkForSelectedElement(["numbering"],t.target.id);if(n!==!0&&r!==!0||e("#"+t.target.id).is(":focus")!==!0){"zimageeditor__svgeditor"!==t.target.id&&void 0===i._selectedTool&&(i.removeBorderFocus(),i.removeShadowForMarker(),i.removePlusAttributes()),i.cMenuPasteProperty(!i.isElementCopied),i.cMenuUndoProperty(i.undoStack.length>0==0),i.cMenuRedoProperty(i.redoStack.length>0==0),i.cMenuZoomOutProperty(i.currentZoomValue<=10),i.cMenuZoomInProperty(i.currentZoomValue>=200);var s,l,d,c,h;s=!0,l=o,d=i.checkForSelectedElement(["ellipse","rectangle","numbering","textarea","pencil","marker","line"],t.target.id),c=i.checkForSelectedElement(["crop"],t.target.id),h=i.checkForSelectedElement(["pencil","marker"],t.target.id),"crop"===i._selectedTool&&(c=!0);var u=t.target.id;if(u="zimageeditor__svgcontainer"===u,d===!0)if(i.rightClickMenu.zmenu("showMenuItems"),t.target.id===i._idSelected||void 0===i._selectedTool){if(i._idSelected=t.target.id,-1!=e("#"+i._idSelected).attr("class").indexOf("zimageedit__rectangle")?i.setPropertiesForSelectedObject("rectangle"):-1!=e("#"+i._idSelected).attr("class").indexOf("zimageedit__ellipse")?i.setPropertiesForSelectedObject("ellipse"):-1!=e("#"+i._idSelected).attr("class").indexOf("zimageedit__line")&&i.setPropertiesForSelectedObject("line"),i._noOfIdSelected.length=0,i._noOfIdSelected.push("#"+i._idSelected),r===!1)i.elementSelect("#"+t.target.id);else{i._idSelected=i.extractID(t.target.id);var m,p,g=e("#"+i._idSelected+"--circle");m=parseFloat(e(g).attr("cx")),p=parseFloat(e(g).attr("cy")),i.showBroderForNumbering(m,p,i._idSelected)}h===!0&&i.createShadowForMarker(t.target.id),i.rightClickMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__cmenu--crop","#zimageeditor__cmenu--cancel"],"hidden",!0)}else i.rightClickMenu.zmenu("hideMenuItems"),i.rightClickMenu.zmenu("showMenuItems",["#zimageeditor__cmenu--zoomIn","#zimageeditor__cmenu--zoomOut","#zimageeditor__cmenu--separator","#zimageeditor__cmenu--undo","#zimageeditor__cmenu--redo","#zimageeditor__cmenu--paste"]);else c===!0?(i.rightClickMenu.zmenu("hideMenuItems"),i.rightClickMenu.zmenu("showMenuItems",["#zimageeditor__cmenu--crop","#zimageeditor__cmenu--cancel"]),e("#zimageeditor .zimaggeditor__crop--container").contextmenu(function(){})):(l===!0||u===!0||"zimageeditor__container"===t.target.id)&&(i.rightClickMenu.zmenu("hideMenuItems"),i.rightClickMenu.zmenu("showMenuItems",["#zimageeditor__cmenu--zoomIn","#zimageeditor__cmenu--zoomOut","#zimageeditor__cmenu--separator","#zimageeditor__cmenu--undo","#zimageeditor__cmenu--redo","#zimageeditor__cmenu--paste"]));return i.checkForPlusDisplay(e("#"+i._idSelected).attr("class"),a,i._idSelected),i.rightClickMenu.zmenu("show",{event:t,direction:"after-pointer"}),s}},resetProperties:function(){e("#zimageeditor__svgeditor .zimageedit__active--shape, #zimageeditor__svgeditor .zimageedit__focus--shape").attr("x","-2000000px"),e("#zimageeditor__svgeditor .zimageedit__active--c1c2, #zimageeditor__svgeditor .zimageedit__active--c1c1").attr("cx","-20000000px"),i.removeBorderFocus(),i.hideProperties(),i.removePlusAttributes(),void 0!==i.textID&&e("#"+i.textID).blur(),i.textareaSelected=!1,i.removeBorderForNumbering()},line_marker:function(t){var i={id:t,orient:"auto",stroke:"#ff004e",fill:"#ff004e","stroke-width":0},o=this._svgElements("polygon",i);"zimageedit__triangle"!==t?e(o).insertBefore("#zimageedit__focus--shape"):e("#zimageeditor__svgeditor").append(o)},removeBorderFocus:function(){e("#zimageeditor__svgeditor .zimageedit__active--shape, #zimageeditor__svgeditor .zimageedit__focus--shape").attr("x","-20000000px").hide(),e("#zimageeditor__svgeditor .zimageedit__active--text--left, #zimageeditor__svgeditor .zimageedit__active--text--leftWhite, #zimageeditor__svgeditor .zimageedit__active--text--right, #zimageeditor__svgeditor .zimageedit__active--text--rightWhite").attr("points","-2000,-2000").hide(),e("#zimageeditor__svgeditor .zimageedit__active--c1c2, #zimageeditor__svgeditor .zimageedit__active--c1c1").attr("cx","-20000000px").hide()},changeOpacitySliderProperties:function(t){void 0!==t&&(-1!==t.indexOf("#")&&(t=t.slice(1,t.length)),"none"===t||"transparent"===t?(t="transparent",e("#zimageeditor__colors--opacity").css("opacity",.35),e("#zimageeditor__slider").zslider("setAttribute","disabled",!0)):(t="#"+t,e("#zimageeditor__colors--opacity").css("opacity",1),e("#zimageeditor__slider").zslider("setAttribute","disabled",!1)),e("#zimageeditor__colors--opacity .zimageeditor__opacity span").css("background-color",t),e("#zimageeditor__zslider").find(".zslider__track").attr("style","background:rgba(0, 0, 0, 0) linear-gradient(to right, rgba(255, 255, 255, 0), "+t+") repeat scroll 0% 0% !important"))},setPropertiesForSelectedTool:function(e){var t;if("crop"!==e&&i.hideProperties(),void 0!==i._idSelected){var o=i.checkForSelectedElement(["rectangle","ellipse","line","marker","pencil"],i._idSelected);if(o===!0){var a=i.getValuesOfObject("#"+i._idSelected);i.lastSelectedStrokeColor=a.borderColor,i.lastSelectedStrokeWidth=a.borderWidth,i.lastSelectedFillColor=a.fill,i.lastSelectedFillOpacity=a.fillOpacity,i.lastSelectedStrokeOpacity=a.strokeOpacity,i.lastSelectedStrokeDashArray=a.borderStroke,i.lastSelectedId=i._idSelected}}else i.lastSelectedId=void 0;"rectangle"===e||"ellipse"===e?i.changeIconColorProperties(i.previousFillColor,void 0):i.changeIconColorProperties("#fff",void 0),"rectangle"===e||"ellipse"===e||"polyline"===e||"line"===e?(t=i.previousBorderColor,i.changeIconColorProperties(void 0,t)):(t="#ff004e",i.previousBorderColor="#ff004e",i.previousFillColor="none",i.previousOpacity=100,i.changeIconColorProperties(void 0,t)),"numbering_"===e&&(t=i.previousNumberingColor,"question"===i.numberingTagSelected?t="#226cfb":"wrong"===i.numberingTagSelected?t="#ff3131":"tick"===i.numberingTagSelected&&(t="#23d01b"),i.changeIconColorProperties(void 0,t)),"textarea"!==e&&(i.textFontSize=20,i.textFontColor="#8b23d5",i.textFontShadow=!0),("numbering_"!==e||"numbering"!==i.numberingTagSelected)&&(i.previousNumberingColor="#226cfb"),("textarea"===e||"numbering_"===e||"marker"===e||"blur"===e||"crop"===e)&&(i._idSelected=void 0,i.lastSelectedId=void 0)},changeIconColorProperties:function(t,o){var a;"none"===t?e("#zimageeditor__textarea--menu .zimageedit__fill--bg").css({"background-color":"#fff",margin:"3px 3px"}).addClass("zimageedit__icon").addClass("zimageedit__icon--nofill"):void 0!==t&&"none"!==t&&(e("#zimageeditor__textarea--menu .zimageedit__fill--bg").css({background:t}).removeClass("zimageedit__icon").removeClass("zimageedit__icon--nofill"),i.fillIconColor=t,a=t.substr(1,t.length),i.colorPalatteMenu.zmenu("setAttribute","#zimageeditor__colors--"+a,"checked",!0)),"none"===o||"transparent"==a?(e("#zimageeditor__textarea--menu .zimageedit__stroke--border").addClass("zimageedit__prop--nofill").css("border-color","white"),e("#zimageeditor__textarea--menu .zimageedit__stroke--bg").css("background","gray")):void 0!==o&&(a=o,"none"===a||"transparent"==a?(e("#zimageeditor__textarea--menu .zimageedit__stroke--bg").css("background","gray"),e("#zimageeditor__textarea--menu .zimageedit__stroke--border").addClass("zimageedit__prop--nofill").css("border-color","white"),a="white"):e("#zimageeditor__textarea--menu .zimageedit__stroke--border").css({border:"2px solid "+a}).removeClass("zimageedit__prop--nofill"),i.borderIconColor=o,i.colorPalatteMenu.zmenu("setAttribute","#zimageeditor__colors--"+a,"checked",!0))},hexaToRGB:function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,i,o){return t+t+i+i+o+o});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null},checkForPlusDisplay:function(t,o,a){if(i.shiftKeyPressed===!1&&i._noOfIdSelected.length<2){var n=a||o.target.id,r=i.checkForSelectedElement(["textarea"],n),s=i.checkForSelectedElement(["line","pencil"],n),l=i.checkForSelectedElement(["ellipse","rectangle"],n),d=i.checkForSelectedElement(["numbering"],i._idSelected)&&"numbering"===e("#"+i._idSelected).attr("type-contains");d===!0&&i.showProperties(i._idSelected,"numbering"),i.showBorderFocus(),void 0!==t&&0===t.indexOf("zimageedit__active--shape")&&(t=e("#"+i._idSelected).attr("class"),n=i._idSelected),r===!0&&i.showProperties(n,"textarea"),l===!0&&i.multiSelectFlag===!1&&(i.removePlusAttributes(),s?e("#zimageeditor .zimageedit__active--c1c2, #zimageeditor .zimageedit__active--c1c1").css("visibility","visible"):(i.showPlusMenu(n,t),e("#zimageeditor .zimageedit__active--c1c2, #zimageeditor .zimageedit__active--c1c1").css("visibility","hidden")),i.showProperties(n,"ellipse")),s===!0&&i.showProperties(n,"line")}else i.hideProperties(),i.removePlusAttributes()},showBorderFocus:function(){e("#zimageeditor .zimageedit__active--shape, #zimageeditor .zimageedit__focus--shape").show()},createNumbering:function(t,o){i.resetMultiSelect();var a=document.createElementNS(i.svgPath,"g");i.setAttributeForObj(a,["class","zimageedit__numbering","id",i.temp_id+"--group"]);var n;if(i.isIEBrowser){var r=i.editorSVG.getAttribute("viewBox").split(" ");n=e("<div/>",{"class":"zimagedit__numbering--fobject",id:this.temp_id+"--fobject",y:o-16-parseFloat(r[1]),x:t-16-parseFloat(r[0])}).css({top:o-16+80-parseFloat(r[1]),left:t-16+110-parseFloat(r[0])})}else n=document.createElementNS(i.svgPath,"foreignObject"),i.setAttributeForObj(n,["id",this.temp_id+"--fobject","class","zimagedit__numbering--fobject","width",32,"height",32]),n.setAttribute("y",o-16),n.setAttribute("x",t-16);var s=e("<input/>",{id:i.temp_id,maxlength:2,readonly:!0,"type-contains":i.numberingTagSelected,"class":"zimageedit__numbering--input zimageedit__numbering"});e(n).append(s),"numbering"!==i.numberingTagSelected?(e(s).attr({maxlength:0,readonly:!0}),e(s).on("focus",function(){e(s).blur()})):(e(s).attr("readonly",!0),i.numberingTagElements.push(i.temp_id),e(s).on("focus",function(){return i.multiSelectFlag===!0||"readonly"===e(s).attr("readonly")?void e(s).blur():(e(s).removeAttr("readonly"),e(s).attr("class","zimageedit__numbering--input zimageedit__numbering zimageedit__text--cursor"),void(i.focuessedNumbering=i.temp_id))}),e(s).on("blur","input",function(){e(s).attr({readonly:"readonly",disabled:!0}),i.focuessedNumbering=i.temp_id,e(s).attr("class","zimageedit__numbering--input zimageedit__numbering")}).on("click",function(t){void 0!==e(s).attr("readonly")&&(e(s).blur(),t.stopPropagation(),t.preventDefault())}).on("blur",function(){e(s).attr("readonly","readonly"),i.focuessedNumbering=i.temp_id,e(s).attr("class","zimageedit__numbering--input zimageedit__numbering")})),i.isIEBrowser===!0?i.svgContainer.append(n):e(a).append(n),e(a).insertBefore("#zimageedit__focus--shape");var l=document.createElementNS(i.svgPath,"path");i.setAttributeForObj(l,["id",this.temp_id+"--path","stroke","#226cfb","fill","#226cfb","class","zimageedit__numbering"]),l.setAttribute("d","M1,15V1l11.4,6.1c0.7,0.4,0.7,1.4,0,1.8L1,15z"),e(a).prepend(l);var d=document.createElementNS(i.svgPath,"circle");d.setAttribute("id",this.temp_id+"--circle");var c=5>o?5:o,h=t;i.setAttributeForObj(d,["cx",h,"cy",c,"fill","white","class","zimageedit__numbering","id",this.temp_id+"--circle","stroke-width",4,"r",16]),"numbering"===i.numberingTagSelected?(d.setAttribute("stroke",i.previousNumberingColor),l.setAttribute("fill",i.previousNumberingColor),l.setAttribute("stroke",i.previousNumberingColor)):d.setAttribute("stroke","#226cfb"),e(d).insertAfter(l),i.showBroderForNumbering(h,c,this.temp_id),i._idSelected=this.temp_id;var u,m,p;i.resetMultiSelect(),i._noOfIdSelected.push("#"+this.temp_id),p=i.findPointOnACircle(h,c,90,7),m=p[1],u=p[0];var g="translate("+u+","+m+") rotate(90 0 7.5)";e("#"+this.temp_id+"--path").attr({transform:g}),e("#"+i.temp_id).append("<textarea class='zimageedit__numbering--input zimageedit__numbering></textarea>");var _=e("#"+i.temp_id);if(_.css({"z-index":3,background:"transparent","border-radius":"100%"}),"numbering"===i.numberingTagSelected)e(_).on("keypress",function(e){if(!(e.which<32)){var t=new RegExp("^[a-zA-Z0-9]+$"),i=String.fromCharCode(e.charCode?e.charCode:e.which);return t.test(i)||8===e.charCode||46===e.charCode?void 0:(e.preventDefault(),!1)}}),i.currentValueForNumbering=i.currentValueForNumbering<=0?1:i.currentValueForNumbering,e(_).val(i.currentValueForNumbering),i.currentValueForNumbering++;else if("tick"===i.numberingTagSelected){var f=document.createElementNS(i.svgPath,"polyline");i.setAttributeForObj(f,["class","zimageedit__numbering","fill","none","stroke",i.numberingColor.tick,"stroke-width","2","id",this.temp_id+"--tick"]);var v,b;v=h-6,b=c+1.5,p=""+v+","+b+" ",v+=3.5,b+=3.4,p+=+v+","+b+" ",v+=8.5,b-=8.4,p=p+v+","+b,f.setAttribute("points",p),e("#"+this.temp_id+"--circle").attr({stroke:i.numberingColor.tick}),e("#"+this.temp_id+"--path").attr({stroke:i.numberingColor.tick,fill:i.numberingColor.tick}),i.isIEBrowser?e("#"+this.temp_id+"--group").append(f):e(f).insertBefore("#"+this.temp_id+"--fobject")}else if("wrong"===i.numberingTagSelected){var y=document.createElementNS(i.svgPath,"line");i.setAttributeForObj(y,["class","zimageedit__numbering","fill","none","stroke","#ff3131","stroke-width","2","points",p]),y.setAttribute("id",this.temp_id+"--wrong1"),i.isIEBrowser?e("#"+this.temp_id+"--group").append(y):e(y).insertBefore("#"+this.temp_id+"--fobject"),e("#"+this.temp_id+"--wrong1").attr({x1:h-5,y1:c-5,x2:h+5,y2:c+5}),y=document.createElementNS(i.svgPath,"line"),y.setAttribute("class","zimageedit__numbering"),i.setAttributeForObj(y,["class","zimageedit__numbering","fill","none","stroke","#ff3131","stroke-width","2","id",this.temp_id+"--wrong2","points",p]),i.isIEBrowser?e("#"+this.temp_id+"--group").append(y):e(y).insertBefore("#"+this.temp_id+"--fobject"),e("#"+this.temp_id+"--wrong2").attr({x1:h+5,y1:c-5,x2:h-5,y2:c+5}),e("#"+this.temp_id+"--circle").attr({stroke:"#ff3131"}),e("#"+this.temp_id+"--path").attr({stroke:"#ff3131",fill:"#ff3131"})}else if("question"===i.numberingTagSelected){l=document.createElementNS(i.svgPath,"path");var z="M 5 0 H 3 C 1.4 0 0 1.4 0 3 v 2 h 2 V 3 c 0 -0.6 0.4 -1 1 -1 h 2 c 0.6 0 1 0.4 1 1 v 3 C 4.3 6 3 7.3 3 9 v 2 h 2 V 8 c 1.7 0 3 -1.3 3 -3 V 3 C 8 1.4 6.7 0 5 0 L 5 0 Z";i.setAttributeForObj(l,["class","zimageedit__numbering","fill",i.numberingQuestionColor,"id",this.temp_id+"--question1","d",z]),h-=4,c-=7,g="translate("+h+","+c+") ",i.isIEBrowser?e(a).append(l):e(l).insertBefore("#"+this.temp_id+"--fobject"),e("#"+i.temp_id+"--question1").attr({transform:g}),d=document.createElementNS(i.svgPath,"circle"),i.setAttributeForObj(d,["class","zimageedit__numbering","fill",i.numberingQuestionColor,"stroke",i.numberingQuestionColor,"stroke-width","0","r","1"]),d.setAttribute("id",this.temp_id+"--question2"),i.isIEBrowser?e(a).append(d):e(d).insertBefore("#"+this.temp_id+"--fobject"),d=document.createElementNS(i.svgPath,"circle"),i.setAttributeForObj(d,["class","zimageedit__numbering","fill",i.numberingQuestionColor,"stroke",i.numberingQuestionColor,"stroke-width","0","r","1"]),d.setAttribute("id",this.temp_id+"--question3"),i.isIEBrowser?e(a).append(d):e(d).insertBefore("#"+this.temp_id+"--fobject"),e("#"+this.temp_id+"--question2, #"+this.temp_id+"--question3").attr({cx:h+4,cy:c+14}),e("#"+this.temp_id+"--circle").attr({stroke:i.numberingQuestionColor}),e("#"+this.temp_id+"--path").attr({stroke:i.numberingQuestionColor,fill:i.numberingQuestionColor})}i._idSelected=i.temp_id,i.isDraw=!0,i.pushIntoStack("create")},initDrawElements:function(t){if(void 0!==i._idSelected){var o=i.getValuesOfObject("#"+i._idSelected);i.lastSelectedStrokeColor=o.borderColor,i.lastSelectedStrokeWidth=o.borderWidth,i.lastSelectedFillColor=o.fill,i.lastSelectedFillOpacity=o.fillOpacity,i.lastSelectedStrokeOpacity=o.strokeOpacity,i.lastSelectedStrokeDashArray=o.borderStroke,i.lastSelectedId=i._idSelected}else i.lastSelectedId=void 0;i._idSelected=void 0,this.removeBorderFocus(),i.removeBorderForNumbering(),this._drag=!0;var a=[t.clientX,t.clientY],n=Math.round(1e7*Math.random());if("rectangle"===this._selectedTool||"ellipse"===this._selectedTool||"line"===this._selectedTool||"polyline"===this._selectedTool||"marker"===this._selectedTool){var r=i.previousBorderColor,s=i.previousFillColor,l={stroke:r,fill:s,"stroke-width":i.previousBorderThickness,id:"zimageedit__shapes--"+n,"class":"zimageedit__"+this._selectedTool,"stroke-opacity":1},d=this._selectedTool;"polyline"===this._selectedTool&&i.isSafari===!1?(l["stroke-linejoin"]="round",l["stroke-linecap"]="round"):"rectangle"===this._selectedTool?d="rect":"marker"===this._selectedTool&&(l.stroke="#"+i.markerColor,l["stroke-opacity"]=i.defaultMarkerOpacity,d="polyline",l["stroke-width"]=20,l["stroke-linejoin"]="round",l["stroke-linecap"]="round",l.fill="none"),("rectangle"===this._selectedTool||"ellipse"===this._selectedTool||"line"===this._selectedTool||"polyline"===this._selectedTool)&&(l["stroke-opacity"]=1,l["stroke-width"]=4,l["fill-opacity"]=1,l.fill="none",l.stroke="#ff004e",l["stroke-dasharray"]="none"),"line"===this._selectedTool&&(e("#zimageedit__triangle").attr("stroke",i.arrowStrokeColor).attr("fill","#ff004e"),l["stroke-linecap"]="round",l.fill="none",d="path"),void 0===i.lastSelectedId||!i.checkForSelectedElement(["ellipse","rectangle","line","pencil"],i.lastSelectedId)||"ellipse"!==this._selectedTool&&"rectangle"!==this._selectedTool&&"line"!==this._selectedTool&&"polyline"!==this._selectedTool||(l["stroke-opacity"]=i.lastSelectedStrokeOpacity,l["stroke-width"]=i.lastSelectedStrokeWidth,l["fill-opacity"]=i.previousOpacity/100,l.fill=i.previousFillColor,l.stroke=i.lastSelectedStrokeColor,e("#zimageedit__triangle").attr("stroke",i.lastSelectedStrokeColor).attr("fill",i.lastSelectedStrokeColor),l["stroke-dasharray"]=i.lastSelectedStrokeDashArray,"none"!==i.lastSelectedStrokeDashArray&&(l["stroke-linecap"]="round",l["stroke-linejoin"]="round")),void 0!==i.lastSelectedId&&i.checkForSelectedElement(["marker"],i.lastSelectedId)&&"marker"===this._selectedTool&&(l["stroke-opacity"]=i.lastSelectedStrokeOpacity,l["stroke-width"]=i.lastSelectedStrokeWidth,l.stroke=i.lastSelectedStrokeColor,l["stroke-dasharray"]=i.lastSelectedStrokeType),("polyline"===this._selectedTool||"marker"===this._selectedTool)&&(l.fill="none","marker"===this._selectedTool&&(l.stroke="#"+i.markerColor,l["stroke-opacity"]=i.markerColorOpacity,l["stroke-width"]=20)),i._elem=this._svgElements(d,l),e(this._elem).addClass("zimageedit_svg_obj_"+d),"line"===this._selectedTool&&e("#zimageedit__triangle").attr({"stroke-width":l["stroke-width"]>4?l["stroke-width"]-5:l["stroke-width"]/4,"stroke-opacity":l["stroke-opacity"],"fill-opacity":l["stroke-opacity"]})}var c="";i.isIEBrowser===!0&&(c="--IE");var h="brush";return"polyline"===i._selectedTool&&(h="pencil"),("polyline"===i._selectedTool||"marker"===i._selectedTool)&&e(i._elem).attr("class","zimageedit__"+i._selectedTool+" zimageedit__"+h+"--cursor"+c),i.cursorHandling({type:"beforeDraw",tool:i._selectedTool}),("textarea"===this._selectedTool||"numbering_"===this._selectedTool||"blur"===this._selectedTool)&&(this.temp_id="zimageedit__shapes--"+n),a},findPointOnACircle:function(e,t,i,o){var a=i*Math.PI/180;return[Math.round(e+o*Math.cos(a)),Math.round(t+o*Math.sin(a))]},moveNumberinngBeack:function(t,o,a){var n=t.length;t=parseFloat(t.substr(n-1,n));var r,s,l,d,c,h,u;if(l=i._noOfIdSelected[0].substr(1,i._noOfIdSelected[0].length),i._idSelected=l,r=parseFloat(e("#"+l+"--circle").attr("cx")),s=parseFloat(e("#"+l+"--circle").attr("cy")),7>=t&&a===!1)d=t=45*t,c=i.findPointOnACircle(r,s-7,t,15),u="translate("+c[0]+","+c[1]+") rotate("+t+" 0 7.5)",e("#"+l+"--path").attr("transform",u);else{c=i.editorSVG.createSVGPoint(),c.x=o.clientX,c.y=o.clientY,c=c.matrixTransform(i.editorSVG.getScreenCTM().inverse());var m=c.x,p=c.y;if(Math.abs(m-r)>16||Math.abs(p-s)>16){d=Math.atan2(p-s,m-r)*(180/Math.PI);var g=s-Math.sqrt(Math.abs(m-r)*Math.abs(m-r)+Math.abs(p-s)*Math.abs(p-s));d=2*Math.atan2(p-g,m-r)*180/Math.PI,90>d?d+=270:d-=90,22.5>d?d=0:67.5>d?d=45:112.5>d?(d=90,r+=1.15):d=157.5>d?135:202.5>d?180:247.5>d?225:292.5>d?270:337.5>d?315:0,c=i.findPointOnACircle(r,s-7,d,15),u="translate("+c[0]+","+c[1]+") rotate("+d+" 0 7.5)",e("#"+l+"--path").attr("transform",u)}}h=d/45,e("#zimageedit__active--numbering--8").attr({cx:e("#zimageedit__active--numbering--"+h).attr("cx"),cy:e("#zimageedit__active--numbering--"+h).attr("cy")})},keypressevents:function(t){if(27===t.keyCode){if(i.mousedown===!0&&"draw"===i.lastAction){i._drag=!1;var o=i.typeOfElement(i._idSelected);return"numbering"===o?e("#"+i._idSelected).parent().remove():"line"===o?(e("#zimageedit__triangle").css("visibility","hidden"),i.dragOnly=!1):"pencil"===o&&(i.polyline_points=""),e("#"+i._idSelected).remove(),i.resetProperties(),void(i.actionDone="none")}if("blur"===i._selectedTool&&"createcanvas"===i.lastAction&&"create"===i.actionDone)return e("#"+i._idSelected).remove(),i.actionDone=i.lastAction="none",void(i._drag=i.hasBlurred=!1);i.removeBorderFocus(),i.multiSelectFlag===!0?i.resetMultiSelect():1===i._noOfIdSelected.length&&"numbering"===i.typeOfElement(i._noOfIdSelected[0].substr(1,i._noOfIdSelected[0].length))&&e(i._noOfIdSelected[0]).blur(),i.resetProperties(),i._selectedTool="select",i.checkForContinuousDrawing(!0),i._noOfIdSelected.length=0,i._idSelected=void 0,e(".zimageeditor__btns--active").removeClass("zimageeditor__btns--active"),e("#zimageeditor__btns--select").addClass("zimageeditor__btns--active")}if(46===t.keyCode||8===t.keyCode){if(!e("#zimageeditor textarea").is(":focus")){if(1===i._noOfIdSelected.length&&-1!==e(i._noOfIdSelected[0]).attr("class").indexOf("zimageedit__numbering--input")&&e(i._noOfIdSelected[0]).prop("readOnly")===!1)return;t.preventDefault();for(var a=i._noOfIdSelected.length,n=a;n>0;n--){var r=i._noOfIdSelected.pop();i.removeMultiSelectBoundary(r),r=r.substr(1,r.length),this._idSelected=r;var s=e("#"+this._idSelected).attr("class"),o=i.typeOfElement(i._idSelected);s=s.slice(12,s.length),"marker"===o||"pencil"===o?i.removeShadowForMarker():("rectangle"===o||"ellipse"===o)&&i.removePlusAttributes(),"line"===o?e("#"+this._idSelected).parent().hide():-1!==e("#"+this._idSelected).attr("class").indexOf("zimageedit__numbering")?(i.removeBorderForNumbering(),i.isIEBrowser&&e("#"+this._idSelected+"--fobject").hide(),parseFloat(e("#"+this._idSelected).val())===i.currentValueForNumbering-1&&(i.currentValueForNumbering-=1),e("#"+this._idSelected+"--group").hide()):e("#"+this._idSelected).hide(),i.pushIntoStack("delete")}a>1&&(i.undoStack[i.undoStack.length]=a),i.removeBorderFocus(i._selectedTool)}e("#"+i._idSelected).is(":focus")===!1&&(i.removeBorderForNumbering(),i.hideProperties(),i._idSelected=void 0)}var l=!1;if(e("#"+i._idSelected).is(":focus")&&(l=!0),67===t.keyCode&&(t.metaKey===!0||i.ctrlKeyPressed===!0&&i.isWindowsOS===!0)&&l===!1?i.copyElements():86===t.keyCode&(t.metaKey===!0||i.ctrlKeyPressed===!0&&i.isWindowsOS===!0)&&l===!1&&(i.showBorderFocus(),i.pasteElements()),27===t.keyCode&&i.cropSelected===!0&&i.onCropCancel(),i.commandKeyPressed===!0&&65===t.keyCode||i.ctrlKeyPressed===!0&&65===t.keyCode){if(e("#"+i._idSelected).is(":focus")===!0)return;i.selectAll()}if(l=!1,t.metaKey&&t.shiftKey===!1&&90===t.keyCode&&l===!1||i.ctrlKeyPressed===!0&&i.shiftKeyPressed===!1&&90===t.keyCode&&l===!1){var d=i.typeOfElement(i._idSelected);if(i.multiSelectFlag===!1&&"textarea"===d&&e("#"+i._idSelected).is(":focus"))return;i.removeBorderFocus(),i.removeBorderForNumbering(),i.removeShadowForMarker(),i.undoFunc(),i._idSelected=void 0,l=!0}if(t.metaKey&&t.shiftKey&&90===t.keyCode&&l===!1||i.ctrlKeyPressed===!0&&89===t.keyCode&&l===!1){var d=i.typeOfElement(i._idSelected);if(i.multiSelectFlag===!1&&"textarea"===d&&e("#"+i._idSelected).is(":focus"))return;i.redoFunc(),i.removeShadowForMarker(),l=!0}l===!0&&(t.preventDefault(),i.resetMultiSelect());var c,h;if((37===t.keyCode||39===t.keyCode||40===t.keyCode||38===t.keyCode)&&i._noOfIdSelected.length>0){c=1,i.shiftKeyPressed===!0&&(c=10);var n=i._noOfIdSelected.length-1;for(n;n>=0;n--){var r=i._noOfIdSelected[n];if(r=r.substr(1,r.length),this._idSelected=r,i.pushIntoTempStack(i._idSelected,2*n),e("#"+i._idSelected).is(":focus")===!1||i.multiSelectFlag===!0){var o=i.typeOfElement(i._idSelected);if("numbering"===o)i.moveNumbering(37===t.keyCode||39===t.keyCode?(t.keyCode-38)*c:0,40===t.keyCode||38===t.keyCode?(t.keyCode-39)*c:0);else if("pencil"===o||"marker"==o){var u,m;u=m=0,t.keyCode%2===1?u=t.keyCode-38:m=t.keyCode-39,u*=c,m*=c;var p=document.getElementById(i._idSelected),g=Object.keys(p.points).length;for(void 0!==p.points.numberOfItems&&(g=p.points.numberOfItems),e("#"+i._idSelected).css("transform","none"),--g;g>=0;g--){var _=p.points.getItem(g);_.x+=u,_.y+=m}var f=e("#"+i._idSelected+"--shadowblack").css("transform");"none"==f&&void 0!==f?e("#"+i._idSelected+"--shadowblack").css("transform","translate("+u+"px,"+m+"px)"):void 0!==f&&(u=parseFloat(f.substr(10,f.length).split(" ")[3])+u,m=parseFloat(f.substr(10,f.length).split(" ")[4])+m,e("#"+i._idSelected+"--shadowblack, #"+i._idSelected+"--shadow").css("transform","translate("+u+"px,"+m+"px)"))}else{h=i.getValuesOfObject("#"+i._idSelected);var v="left";t.keyCode%2===0&&(v="top"),h[v]=h[v]+(t.keyCode-(t.keyCode%2===1?38:39))*c,"textarea"===h.tool?e("#"+i._idSelected).blur():"line"===h.tool&&(h[t.keyCode%2===1?"width":"height"]=h[t.keyCode%2===1?"width":"height"]+(t.keyCode-(t.keyCode%2===1?38:39))*c),i.moveElements(h),"ellipse"!==h.tool&&"rectangle"!==h.tool||1!==i._noOfIdSelected.length||i.showPlusMenu(i._idSelected)}i.pushIntoTempStack(i._idSelected,2*n+1),t.preventDefault(),i.setBoundaryValues("#"+i._idSelected,i.getValuesOfObject("#"+i._idSelected))}}i.copyFromTempToUndoStack()}},createBorderForNumbering:function(){var t,o,a=0;for(t=0;8>=t;t++,a+=45)o=document.createElementNS(i.svgPath,"circle"),i.setAttributeForObj(o,["id","zimageedit__active--numbering--"+t,"class","zimageedit__focus--numbering","r",2.5,"stroke","#7f7f7f","fill","#7f7f7f"]),e(o).appendTo("#zimageeditor__svgeditor"),8===t&&i.setAttributeForObj(o,["stroke","#11bf58","fill","white","r",4,"stroke-width",3]);o=document.createElementNS(i.svgPath,"circle"),i.setAttributeForObj(o,["id","zimageedit__active--numbering--9","class","zimageedit__focus--numbering","r",33,"stroke","blue"]),i.setAttributeForObj(o,["stroke-width","15","fill","none","stroke-opacity","0"]),e(o).insertBefore("#zimageedit__active--numbering--0")},updateBorderForNumbering:function(t,o,a,n){i.removeBorderFocus();var r,s,l=0;for(r=0;8>r;r++,l+=45)s=i.findPointOnACircle(t,o,l,a),e("#zimageedit__active--numbering--"+r).attr({cx:s[0]+.5,cy:s[1]+.5});s=i.findPointOnACircle(t,o,90,a),e("#zimageedit__active--numbering--8").css("visibility",e("#"+n+"--path").css("visibility")).attr({cx:s[0]+.5,cy:s[1]+.5});var d=e("#"+n+"--path").attr("transform");if(void 0!==d){var c=d.indexOf("rotate("),h=d.slice(c+7,d.length);h=h.split(" "),h[0]=h[0]/45,e("#zimageedit__active--numbering--8").attr({cx:e("#zimageedit__active--numbering--"+h[0]).attr("cx"),cy:e("#zimageedit__active--numbering--"+h[0]).attr("cy")})}},showBroderForNumbering:function(t,o,a){e("#zimageeditor__svgcontainer .zimageedit__focus--numbering").show();var n,r=0;for(n=0;8>=n;n++,r+=45){var s=document.getElementById("zimageedit__active--numbering--"+n),l=i.findPointOnACircle(t,o,r,32);i.setAttributeForObj(s,["cx",l[0]+.5,"cy",l[1]+.5])}e("#zimageedit__active--numbering--9").attr({cx:t,cy:o}),i.updateBorderForNumbering(t,o,32,a)},removeBorderForNumbering:function(){e("#zimageeditor__svgcontainer .zimageedit__focus--numbering").hide()},removeTextSelection:function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},mouseupFunction:function(t,o){if(i.isDraw===!0&&i.dragOnly===!0&&"blur"!==i._selectedTool&&"smudge"!==i._selectedTool&&(i.resetMultiSelect(),i._noOfIdSelected.push("#"+i._idSelected),i.checkForPlusDisplay(e("#"+i._idSelected).attr("class"),o,i._idSelected)),"blur"===i._selectedTool&&"createcanvas"===i.lastAction&&"create"===i.actionDone||i.hasBlurred===!0){i.hasBlurred=!1,i.blurPosition[i.blurPosition.length]=new Array(6),i.blurPositionLength++;var a,n=e("#"+i.hasBlurredID),r=parseFloat(n.attr("width")),s=parseFloat(n.attr("height")),l=parseFloat(n.css("top")),d=parseFloat(n.css("left")),c=i.fitToWidthZoomValue/100,h=i._imageWidth/i.actualWidth;"none"===i._imageCanvas.css("display")?(n=document.getElementById("zimageditCropCanvas"),a=parseFloat(i._imageCropCanvas.attr("width"))/parseFloat(i._imageCropCanvas.css("width"))):(a=h,n=document.getElementById("zimageedit-ele-canvas"));var u=document.getElementById(i.hasBlurredID),m=e("<canvas>").attr({width:r*h,height:s*h,id:"zimageedit__tempCanvas","class":"zimageedit__blurCanvas"}).css({position:"absolute",visibility:"hidden",top:(l-80)*h,left:(d-110)*h});r/=c,s/=c,l-=80,d-=110,l/=c,d/=c,e("#zimageeditor__image").append(m),i.blurPosition[i.blurPosition.length-1]=[l,d,r*h,s*h,i.actualWidth,i.actualHeight];var p=n.getContext("2d"),g=document.getElementById("zimageedit__tempCanvas"),_=g.getContext("2d");_.drawImage(n,d*h*c,l*h*c,r*h*c,s*h*c,0,0,r*h*c,s*h*c),p.drawImage(u,d*a*c,l*a*c,r*a*c,s*a*c),e("#"+i.hasBlurredID).remove(),e("#zimageedit__tempCanvas").attr("id",i.hasBlurredID).css("visibility","hidden"),e(m).css("display","none")}if(i.dragOnly===!0&&"none"!==i._selectedTool){if("line"===t._selectedTool){var f=document.createElementNS(i.svgPath,"g");f.setAttribute("id",i._idSelected+"--group"),e(f).insertBefore("#zimageedit__focus--shape"),e("#"+i._idSelected).appendTo("#"+i._idSelected+"--group"),e("#zimageedit__triangle").clone().attr({id:i._idSelected+"--line","class":"zimageedit__line"}).css("visibility","visible").appendTo("#"+i._idSelected+"--group"),e("#"+i._idSelected+"--group").attr("class","zimageedit__line"),e("#zimageedit__triangle").attr({points:"2,7 0,0 11,7 0,14","class":"zimageedit--triangle"}).css("visibility","hidden"),"true"===e("#"+i._idSelected+"--line").attr("data-stline")&&e("#"+i._idSelected+"--line").css("visibility","hidden")}var v=e("#"+i._idSelected).attr("class");void 0!==v&&-1!=v.indexOf("zimageedit__line")&&(i.idSelected=e("#"+i._idSelected).parent().attr("id"),i.idSelected=i._idSelected.substr(0,i._idSelected.length-7)),"draw"===i.lastAction&&"marker"!==i._selectedTool&&"blur"!==i._selectedTool&&("textarea"!==i._selectedTool&&i.elementSelect("#"+i._idSelected,"return","color_select"),e(this._elem).removeClass(i.isIEBrowser!==!0?"zimageedit__brush--cursor":"zimageedit__brush--cursor--IE")),("polyline"===t._selectedTool||"marker"===t._selectedTool)&&(i.polyline_points=""),i.shiftKeyPressed===!1&&i.resetMultiSelect(),void 0!==i._idSelected&&i._noOfIdSelected.push("#"+i._idSelected)}i.dragOnly=!1},_drawSvgElements:function(t,o,a){"textarea"!==o&&(i._idSelected=e(this._elem).attr("id"));var n,r,s,l,d,c,h,u,m,p,g,_=a[1];g=i.editorSVG.createSVGPoint(),g.x=t.clientX,g.y=t.clientY,i.lastDrawnId=i._idSelected,i.drawObject=!0,g=g.matrixTransform(i.editorSVG.getScreenCTM().inverse());var f=[g.x,g.y];a[1]>f[1]&&(_=f[1]);var v=a[0];a[0]>f[0]&&(v=f[0]);var b=Math.abs(a[1]-f[1]),y=Math.abs(a[0]-f[0]);"ellipse"===o?(s="cx",l="cy",d="rx",c="ry",h=v+y/2,u=_+b/2,m=y/2,p=b/2):"smudge"===o?i.makeSmudge(t,o,a):"rectangle"===o||"textarea"===o||"crop"===o?(s="x",l="y",d="width",c="height",h=v,u=_,m=y,p=b):"line"===o?(s="x1",l="y1",d="x2",c="y2",h=a[0],u=a[1],m=f[0],p=f[1]):("polyline"===o||"marker"===o)&&(n=f[0],r=f[1],i.polyline_points.length<5&&(i.previousXPoint=a[0],i.previousYPoint=a[1]),n=(i.previousXPoint+n)/2,r=(i.previousYPoint+r)/2,i.previousXPoint=(n+i.previousXPoint)/2,i.previousYPoint=(r+i.previousYPoint)/2,i.polyline_points+=n+","+r+" ",this._elem.setAttributeNS(null,"points",i.polyline_points),e(this._elem).insertBefore("#zimageedit__focus--shape")),"textarea"===o&&(s="left",l="top"),this._toolSelected!==!0||"rectangle"!==o&&"ellipse"!==o?"line"===o&&(m-=2,p-=2,g="M"+h+" "+u+", "+m+" "+p,this._elem.setAttributeNS(null,"d",g),e(this._elem).insertBefore("#zimageedit__focus--shape"),e("#zimageedit__triangle").css("visibility","visible"),i.changeArrowHeadValues("zimageedit__triangle",i._idSelected)):(this._elem.setAttributeNS(null,s,h),this._elem.setAttributeNS(null,l,u),this._elem.setAttributeNS(null,d,m),this._elem.setAttributeNS(null,c,p),e(this._elem).insertBefore("#zimageedit__focus--shape"))},makeSmudge:function(e,t,o){var a;o[1],a=i.editorSVG.createSVGPoint(),a.x=e.clientX,a.y=e.clientY,a=a.matrixTransform(i.editorSVG.getScreenCTM().inverse());var n=([a.x,a.y],[]);n[0]=n[1]=0,n=i.editorSVG.getAttribute("viewBox").split(/\s+|,/);var r=i._imageWidth/i.actualWidth,s=(i.fitToWidthZoomValue/100,a.x),l=a.y;if(s*=i._aspectRatio,l*=i._aspectRatio,"none"===i._imageCanvas.css("display")){n=i.editorSVG.getAttribute("viewBox").split(/\s+|,/),r=parseFloat(i._imageCropCanvas.attr("width"))/parseFloat(i._imageCropCanvas.css("width"));var d=document.getElementById("zimageeditor__svgeditor"),c=d.getBoundingClientRect(),s=(e.clientX-c.left)*r,l=(e.clientY-c.top)*r}s-=10,l-=10;var d;d="none"===i._imageCanvas.css("display")?document.getElementById("zimageditCropCanvas"):i.mainCanvas;var h=d.getContext("2d"),u=i.smudgeStackPosition;if(i.smudgeStackFlag===!1){i.smudgeStack[u]=[],i.smudgeStack[u][0]=r,i.smudgeStackFlag=!0;var m={idSelected:"blurr"+u};i.undoStack[i.undoStack.length]=m}var p;p=i.smudgeStack[u].length,i.smudgeStack[u][p]=s,i.smudgeStack[u][p+1]=l;var g=h.getImageData(s,l,i.smudgeBrushSize*r,i.smudgeBrushSize*r);g=i._blur(g,1),h.putImageData(g,s,l),i._idSelected=void 0},createTextarea:function(t,o,a,n,r){i.textareaSelected=i.dragOnly=!0,i.textID=r;var s;if(i.isIEBrowser===!1){var l=document.createElementNS(i.svgPath,"foreignObject");i.setAttributeForObj(l,["id",r+"--fobject","class","zimageedit__textarea--fobject"]),i.setAttributeForObj(l,["x",o,"y",t,"width",a,"height",n]),s=document.createElementNS("http://www.w3.org/1999/xhtml","textarea"),e(l).insertBefore("#zimageedit__focus--shape"),e(l).append(s),this._idSelected=r,s.setAttribute("id",r),s.setAttribute("class","zimageedit__textarea"),s.setAttribute("data-resized",!1),s.setAttribute("wrap","soft")}else{i.textareaCreatedElements.push(i.temp_id);var d=i.editorSVG.getAttribute("viewBox").split(" "),c=e("<div/>",{id:r+"--fobject",position:"absolute",x:o,y:t,width:a,height:n}).css({left:o-parseFloat(d[0])+110,top:t+80-parseFloat(d[1]),width:a,height:n,"z-index":4});i.svgContainer.append(c);var h=e("<textarea/>",{id:r,"class":"zimageedit__textarea","data-resized":!1,tabindex:-1});e("#"+r+"--fobject").css("position","absolute"),this._idSelected=r,e(c).append(h)}s=document.getElementById(r),_textarea=e(s),_textarea.css({"font-size":i.textFontSize,color:i.textFontColor}),i.applyTextShadow(r,i.textFontShadow),s.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/xmlns"),s.onkeydown=function(t){_textarea.is(":focus")!==!0||8!==t.keyCode&&46!==t.keyCode||(t.stopPropagation(),i.textareaAlignment(r)),27===t.keyCode&&(e("#"+i._idSelected).blur(),i.removeBorderFocus())},s.oninput=function(){i.textareaAlignment(r)},s.onfocus=function(){return i.multiSelectFlag===!0?void e(this).blur():(e(this).removeAttr("readonly"),i.focussedTextareaID=r,i.multiSelectFlag===!1&&e(this).addClass("zimageedit__text--cursor"),void e(this).parent().attr("class","zimageedit__textarea--fobject zimageedit__text--cursor"))},s.focusout=function(){_textarea.attr("readonly","readonly").removeClass("zimageedit__text--cursor").removeClass("zimageedit__move--cursor"),_textarea.parent().attr("class","zimageedit__textarea--fobject zimageedit__move--cursor"),e("#"+i.focussedTextareaID).attr("readonly","readonly").removeClass("zimageedit__text--cursor").removeClass("zimageedit__move--cursor")},e("#"+r).on("blur",function(){e("#"+r).attr("readonly","readonly").removeClass("zimageedit__text--cursor").removeClass("zimageedit__move--cursor"),window.getSelection().removeAllRanges(),e("#"+r).parent().attr("class","zimageedit__textarea--fobject zimageedit__move--cursor")}),i.textareaList.push(r),i.drawBorder("textarea",t,o-4,a+8,n),i.cursorHandling({tool:void 0,type:"toolSelect"})},textareaDisabled:function(t){for(var o=0;o<i.textareaList.length;o++){var a=i.textareaList[o];t===!0?e("#"+a).attr("disabled",t).addClass("zimagedit__noselect"):e("#"+a).attr("disabled",t).removeClass("zimagedit__noselect")}},checkTextareaOverflow:function(t){var o,a,n,r,s,l,d,c;r=i.editorSVG.getAttribute("viewBox"),n=e("#"+t).parent(),r=r.split(" "),o=parseFloat(r[2]),a=parseFloat(r[3]),s=parseFloat(n.attr("y")),l=parseFloat(n.attr("x")),d=parseFloat(n.attr("height")),c=parseFloat(n.attr("width")),s-parseFloat(r[1])+d>a&&n.attr({height:a-(s-parseFloat(r[1]))}),l-parseFloat(r[0])+c>o&&n.attr({width:o-(l-parseFloat(r[0]))})},applyTextShadow:function(t,o){var a=parseFloat(e("#"+t).css("font-size"));if(o===!0){var n;n=14>=a?"xs":20>=a?"small":36>=a?"medium":"large",e("#"+t).attr("class","zimageedit__textarea zimagedit__textshadow--"+n),i.textFontShadow=!0}else e("#"+t).attr("class","zimageedit__textarea"),i.textFontShadow=!1},setPropertiesForSelectedObject:function(t){i.cropCreated===!1&&i.showBorderFocus(),"textarea"===t||"polyline"===t||i._noOfIdSelected.length>1?(i.borderElement.css("visibility","hidden"),"textarea"===t&&(e("#zimageeditor__svgeditor .zimageedit__active--shape, #zimageeditor__svgeditor .zimageedit__focus--shape").css("visibility","hidden"),e("#zimageeditor__svgeditor .zimageedit__active--text--right, #zimageeditor__svgeditor .zimageedit__active--text--left, #zimageeditor__svgeditor .zimageedit__active--text--leftWhite").css("visibility","visible"),e("#zimageeditor__svgeditor .zimageedit__active--text--rightWhite, #zimageeditor__svgeditor .zimageedit__active--r1c3, #zimageeditor__svgeditor .zimageedit__active--r1c1").css("visibility","visible"))):"line"===t?(e("#zimageeditor__svgeditor .zimageedit__active--shape, #zimageeditor__svgeditor .zimageedit__focus--shape").css("visibility","hidden"),e(".zimageedit__active--c1c1, .zimageedit__active--c1c2").css("visibility","visible")):"crop"!==t&&i.cropCreated===!1?(e("#zimageeditor__svgeditor .zimageedit__active--shape, #zimageeditor__svgeditor .zimageedit__focus--shape").css("visibility","visible"),i.borderElement.css("visibility","visible"),e(".zimageedit__active--c1c1, .zimageedit__active--c1c2").css("visibility","hidden"),e("#zimageeditor__svgeditor .zimageedit__active--text--right, #zimageeditor__svgeditor .zimageedit__active--text--left, #zimageeditor__svgeditor .zimageedit__active--text--leftWhite,  #zimageeditor__svgeditor .zimageedit__active--text--rightWhite").css("visibility","hidden")):"crop"===t&&i.cropCreated===!0&&(e("#zimageeditor__svgeditor .zimageedit__active--text--right, #zimageeditor__svgeditor .zimageedit__active--text--left, #zimageeditor__svgeditor .zimageedit__active--text--leftWhite,  #zimageeditor__svgeditor .zimageedit__active--text--rightWhite").css("visibility","hidden"),e(".zimageedit__active--c1c1, .zimageedit__active--c1c2").css("visibility","hidden"),i.borderElement.css("visibility","visible"))},drawBorder:function(t,o,a,n,r,s,l){if(i.multiSelectFlag)return t="rect",0;var d,c,h,u;d=parseFloat(o),c=parseFloat(a),h=Math.abs(parseFloat(n)),u=Math.abs(parseFloat(r));var m=i.borderElement,p=0;if("line"===t){e("#zimageeditor .zimageedit__focus--shape").hide(),e(m).hide(),e(m).eq(12).attr({cx:c,cy:d}).show();var g=[];if(void 0!==l)g[0]=s,g[1]=l;else{g=i.getArrowEndPosition(i._idSelected),g=g.split(",");var _,f,v=e("#"+i._idSelected).css("transform");-1!==v.indexOf("matrix")&&void 0!==v&&"none"!==v&&(v=v.split("(")[1].split(")")[0].split(","),_=parseFloat(v[4]),f=parseFloat(v[5]),g[0]=parseFloat(g[0]),g[1]=parseFloat(g[1]),g[0]+=_,g[1]+=f)}e(m).eq(13).attr({cx:g[0],cy:g[1]}).show()}else if("textarea"===t){u=u>31?u:31,isNaN(h)&&(h=31),isNaN(u)&&(u=31),e("#zimageeditor__svgeditor .zimageedit__focus--shape").css("visibility","hidden");var b=c+4+","+d+","+c+","+d+","+c+","+(d+u)+","+(c+4)+","+(d+u);e("#zimageeditor__svgeditor .zimageedit__active--text--left").attr("points",b).css("visibility","visible"),b=c+5+","+d+","+c+","+d+","+c+","+(d+u)+","+(c+5)+","+(d+u),e("#zimageeditor__svgeditor .zimageedit__active--text--leftWhite").attr("points",b).css("visibility","visible"),b=c+h-4+","+d+","+(c+h)+","+d+","+(c+h)+","+(d+u)+","+(c+h-4)+","+(d+u),e("#zimageeditor__svgeditor .zimageedit__active--text--right").attr("points",b).css("visibility","visible"),b=c+h-5+","+d+","+(c+h)+","+d+","+(c+h)+","+(d+u)+","+(c+h-5)+","+(d+u),e("#zimageeditor__svgeditor .zimageedit__active--text--rightWhite").attr("points",b).css("visibility","visible"),e("#zimageeditor__svgeditor .zimageedit__active--r1c1").css("visibility","visible").attr({x:c-8,y:d+u/2-4}).css("cursor","ew-resize"),e("#zimageeditor__svgeditor .zimageedit__active--r1c3").css("visibility","visible").attr({x:c+h,y:d+u/2-4}).css("cursor","ew-resize")}else{var y=i.borderWidth;(void 0===y||isNaN(y)===!0)&&(y=1),e("#zimageeditor__svgeditor .zimageedit__active--r1c1").css("cursor","nwse-resize"),e("#zimageeditor__svgeditor .zimageedit__active--r1c3").css("cursor","nesw-resize"),"crop_element"!==t?(d-=y/1.9,c-=y/1.9,h+=y/1.9*2,u+=y/1.9*2,p=4):(p=14,e("#zimageeditor__svgeditor .zimageedit__focus--shape").css("visibility","hidden"),e("#zimageedit__focus--crop").css("visibility","visible")),isNaN(h)===!0&&(h=0,u=0,d="-1000000",c="-1000000"),e(m).eq(p+4).attr({x:c-5,y:d-5}),e(m).eq(p+5).attr({x:c+h-3,y:d-5}),e(m).eq(p+6).attr({x:c-5,y:d+u-3}),e(m).eq(p+7).attr({x:c+h-3,y:d+u-3}),e(m).eq(p+0).attr({x:c+h/2-6,y:d-2}),e(m).eq(p+1).attr({x:c-2,y:d-6+u/2}),e(m).eq(p+2).attr({x:c+h-2,y:d-6+u/2}),e(m).eq(p+3).attr({x:c+h/2-6,y:d+u-2}),"crop_element"===t&&(e("#zimageedit__focus--crop").attr({width:h,x:c,y:d,height:u}),h-=6,u-=6,c+=3,d+=3),i.focusElementRectWhite.attr({width:Math.abs(h),x:c,y:d,height:Math.abs(u)}),i.focusElementRectBlack.attr({width:Math.abs(h),x:c,y:d,height:Math.abs(u)})}},changeArrowHeadValues:function(t,o){var a=document.getElementById(t);this._drag&&(i._stLine?(e(a).css("visibility","hidden"),e(a).attr("data-stline",!0)):(e(a).css("visibility","visible"),e(a).attr("data-stline",!1)));var n=i.previousBorderThickness+5,r=i.arrowCalculatePosition(o,t,n),s=document.getElementById(o),l=s.getAttribute("d"),d=/[+-]?\d+(\.\d+)?/g;l.length>5&&void 0!==l&&(l=l.match(d).map(function(e){return parseFloat(e)}),a.setAttribute("points","2,7 0,0 11,7 0,14"),a.setAttribute("transform","translate("+l[2]+" "+l[3]+") rotate("+r[3]+" 0 0) translate(-2 -7)"))},getArrowEndPosition:function(t){var o=i.previousBorderThickness+6;return"true"===e("#"+t+"--line").attr("data-stline")&&(o=i.previousBorderThickness+2),i.arrowCalculatePosition(t,t+"--line",o)[0]},arrowCalculatePosition:function(e,t,i){var o=document.getElementById(e),a=o.getTotalLength(),n=o.getPointAtLength(a-i),r=o.getPointAtLength(a),s=Math.atan2(r.y-n.y,r.x-n.x),l=180*s/Math.PI,d=function(e,t,o){var a=(t+o)*Math.PI/180;return e.x+Math.cos(a)*i+","+(e.y+Math.sin(a)*i)};return[d(r,l,0),d(r,l,135),d(r,l,-135),l]},returnDifferenceArrowHead:function(e){var t,i,o,a,n,r,s,l;return t=e.split(" "),i=t[0].split(","),o=i[0],r=i[1],i=t[1].split(","),a=i[0],s=i[1],i=t[2].split(","),n=i[0],l=i[1],a=a>n?a:n,s=s>l?s:l,{x:Math.abs(o-a),y:Math.abs(s-r)}},resizeElementsFunc:function(t,o,a){var n,r,s,l,d,c,h,u,m,p,g,_,f,v=i.element_attr;p=i.boundaryClicked[a].split(" "),g=p[0],_=p[1],n=i.editorSVG.createSVGPoint();var b=i.getValuesOfObject("#"+i._idSelected);if("crop_element"===b.tool&&(n=i.cropSVGElement.createSVGPoint()),n.x=o.clientX,n.y=o.clientY,n=n.matrixTransform(i.editorSVG.getScreenCTM().inverse()),"ellipse"===b.tool)l=b.width,h=b.left,r=i.previousX-n.x,0!==r&&("r1"===g&&"c3"===_||"r3"===g&&"c3"===_||"r2"===g&&"c3"===_?(l=b.width-r/2,h=b.left-r/2):("r1"===g&&"c1"===_||"r3"===g&&"c1"===_||"r2"===g&&"c1"===_)&&(l=b.width+r/2,h=b.left-r/2),0>=l&&("c3"===_?_="c1":"c1"===_&&(_="c3"),i.boundaryClicked[a]=g+" "+_,l=Math.abs(l)),e("#"+this._idSelected).attr({rx:l,cx:h}),i.funcForCalc(b)),s=i.previousY-n.y,0!==s&&(d=b.height,u=b.top,"r1"===g&&"c3"===_||"r1"===g&&"c1"===_||"r1"===g&&"c2"===_?(d=b.height+s/2,u=b.top-s/2):("r3"===g&&"c1"===_||"r3"===g&&"c2"===_||"r3"==g&&"c3"===_)&&(d=b.height-s/2,u=b.top-s/2),0>=d&&("r3"===g?g="r1":"r1"===g&&(g="r3"),i.boundaryClicked[a]=g+" "+_,d=Math.abs(d)),e("#"+this._idSelected).attr({ry:d,cy:u}),i.funcForCalc(b));else if("rectangle"===b.tool||"textarea"===b.tool||"crop_element"===b.tool){if(b=i.getValuesOfObject("#"+i._idSelected),l=b.width,r=parseFloat(i.previousX-n.x)*i.zoomScaleValue,u=b.top,h=b.left,0!==r){if("r1"===g&&"c1"===_||"r3"===g&&"c1"===_||"r2"===g&&"c1"===_){if(l=b.width+r,h=b.left-r,"textarea"===b.tool&&n.x-h>0&&0>r)return 0;if("crop_element"===b.tool&&n.x<0)return 0}else if("r1"===g&&"c3"===_||"r3"===g&&"c3"===_||"r2"===g&&"c3"===_){if(l=b.width-r,"textarea"===b.tool&&n.x-(h+l)<0)return 0;if("crop_element"===b.tool){var y=document.getElementById("zimageedit__crop__svg");c=y.getAttribute("viewBox"),c=c.split(" ")}}if(0>=l&&("c3"===_&&"textarea"!==b.tool?_="c1":"c1"===_&&"textarea"!==b.tool&&(_="c3"),i.boundaryClicked[a]=g+" "+_,l=Math.abs(l),h-=l),"rectangle"===b.tool)e("#"+i._idSelected).attr({x:h,width:Math.abs(l)});else if("textarea"==b.tool&&l>50){if(e("#"+this._idSelected).css({height:0,overflow:"visible"}),d=e("#"+this._idSelected)[0].scrollHeight,e("#"+this._idSelected).css({overflow:"hidden",height:d}),0>=h)return;e("#"+this._idSelected).data("resized",!0).parent().attr({width:l,x:h,height:d}),i.isIEBrowser&&(f=parseFloat(i.SVGElement.attr("height")),u+d>f&&(d=f-u,e("#"+this._idSelected).css({height:d})),e("#"+this._idSelected).parent().css({width:l,left:h+110,height:d}))}else if("crop_element"===b.tool){0>h&&(h=0,l=b.width);var z=parseFloat(i.SVGElement.attr("width"));h+l>z&&(l=z-h),i.cropAreaLock=!0,e("#"+i._idSelected).attr({x:h,width:l}),i.modifyTheCropAreaValues(b.top,h,l,b.height)}b.width=l,b.left=h,"textarea"===b.tool?i.textareaAlignment(this._idSelected):i.funcForCalc(b)}if(s=(i.previousY-n.y)*i.zoomScaleValue,0!==s&&"textarea"!==b.tool){if(d=parseFloat(b.height),u=parseFloat(b.top),"r1"===g&&"c1"===_||"r1"===g&&"c2"===_||"r1"===g&&"c3"===_){if(d=parseFloat(b.height+parseFloat(s)),u=b.top-s,"crop_element"===b.tool&&n.y<0)return 0}else if(("r3"===g&&"c1"===_||"r3"===g&&"c2"===_||"r3"===g&&"c3"===_)&&(d=parseFloat(b.height-parseFloat(s)),"crop_element"===b.tool)){var S=document.getElementById("zimageedit__crop__svg");c=S.getAttribute("viewBox"),c=c.split(" ")}0>=d&&("r3"===g&&"textarea"!==b.tool?g="r1":"r1"===g&&"textarea"!==b.tool&&(g="r3"),i.boundaryClicked[a]=g+" "+_,d=Math.abs(d),u-=d),void 0===d&&(d=b.height),"rectangle"===b.tool?e("#"+i._idSelected).attr({y:u,height:d}):"crop_element"===b.tool&&(0>u&&(u=0,d=b.height),f=parseFloat(i.SVGElement.attr("height")),u+d>f&&(d=f-u),i.cropAreaLock=!0,e("#"+i._idSelected).attr({y:u,height:d}),i.modifyTheCropAreaValues(u,b.left,b.width,d)),b.top=u,b.height=d,i.funcForCalc(b)}}else if("line"===b.tool){var w=n.x;if(i.previousX-n.x!==0){var x=e("#"+i._idSelected+"--line").attr("points");x=i.returnDifferenceArrowHead(x),"c1"===g&&"c1"===_?(m="M"+w+" "+v[0]+", "+v[2]+" "+v[3],e("#"+this._idSelected).attr({d:m}),i.element_attr[1]=w,i.changeArrowHeadValues(i._idSelected+"--line",i._idSelected)):(v[1]<w?w-=x.x:w+=x.x,m="M"+v[1]+" "+v[0]+", "+w+" "+v[3],e("#"+this._idSelected).attr({d:m}),i.element_attr[2]=w,i.changeArrowHeadValues(i._idSelected+"--line",i._idSelected))}var C=n.y;i.previousY-n.y!==0&&(n=e("#"+i._idSelected+"--line").attr("points"),n=i.returnDifferenceArrowHead(n),"c1"===g&&"c1"===_?(m="M"+v[1]+" "+C+", "+v[2]+" "+v[3],e("#"+this._idSelected).attr({d:m}),i.element_attr[0]=C,i.changeArrowHeadValues(i._idSelected+"--line",i._idSelected)):(v[0]>C?C+=n.y:C-=n.y,m="M"+v[1]+" "+v[0]+", "+v[2]+" "+C,e("#"+this._idSelected).attr({d:m}),i.element_attr[3]=C),i.changeArrowHeadValues(i._idSelected+"--line",i._idSelected));var b=i.getValuesOfObject("#"+this._idSelected);i.funcForCalc(b),"true"===e("#"+i._idSelected+"--line").attr("data-stline")&&e("#"+i._idSelected+"--line").css("visibility","hidden")}},changeStrokeWidth:function(t,o){var a,n;a=i._noOfIdSelected.length,t=t>16?16:t,t=0>t?1:t;for(var r=0;a>r;r++){var s,l;s=i._noOfIdSelected[r].substr(1,i._noOfIdSelected[r].length),this._idSelected=s,i.pushIntoTempStack(i._idSelected,2*r),i.pushIntoStack("resize"),l=e("#"+this._idSelected).attr("class"),n=i.typeOfElement(this._idSelected),i.previousBorderThickness=t,-1!=l.indexOf("zimageedit__line")&&e("#"+this._idSelected+"--line").attr("stroke-width",t>4?t-5:t/4),void 0!==this._idSelected&&-1==l.indexOf("zimageedit__textarea")?(e("#"+this._idSelected).attr(o?{"stroke-dasharray":2*t+","+2*t,"stroke-linejoin":"round","stroke-linecap":"round"}:{"stroke-dasharray":"none","stroke-linejoin":"none"}),e("#"+this._idSelected).attr("stroke-width",t)):-1!=l.indexOf("zimageedit__textarea")&&e("#"+this._idSelected).css("border-width",t),i.pushIntoTempStack(i._idSelected,2*r+1),i.elementSelect("#"+this._idSelected,"a")}"rectangle"===n||"ellipse"===n?i.showPlusMenu(i._idSelected):"pencil"===n&&i.multiSelectFlag===!1&&i.createShadowForMarker(i._idSelected),i.copyFromTempToUndoStack()},copyElements:function(){return i._noOfIdSelected.length>1?0:void(void 0!==i._idSelected&&(i.isElementCopied=!0,i.copied_Elements=i._idSelected))},cMenuPasteProperty:function(e){i.rightClickMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__cmenu--paste"],"disabled",e)},cMenuUndoProperty:function(e){i.rightClickMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__cmenu--undo"],"disabled",e)},cMenuRedoProperty:function(e){i.rightClickMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__cmenu--redo"],"disabled",e)},cMenuZoomInProperty:function(e){i.rightClickMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__cmenu--zoomIn"],"disabled",e)},cMenuZoomOutProperty:function(e){i.rightClickMenu.zmenu("setMenuItemsAttribute",["#zimageeditor__cmenu--zoomOut"],"disabled",e)},pasteElements:function(){if(i.isElementCopied===!0){var t,o,a=i.getValuesOfObject("#"+i.copied_Elements),n=Math.round(1e7*Math.random());if("textarea"===a.tool){var r,s,l,d,c=e("#"+i.copied_Elements+"--fobject");r=parseFloat(c.attr("y")),s=parseFloat(c.attr("x")),l=parseFloat(c.attr("width")),d=parseFloat(c.attr("height")),r+=10,s+=10,t=e("#"+i.copied_Elements).val(),i.createTextarea(r+10,s+10,l,d,"zimageedit__shapes--"+n),i.textareaSelected=!0,e("#"+i.textID).val(t),i.drawBorder("textarea",r+10,s+10,l,d,"1"),i.resetMultiSelect(),i._idSelected=i.copied_Elements="zimageedit__shapes--"+n}else if("line"===a.tool){o="zimageedit__shapes--"+n,e("#"+i.copied_Elements).parent().clone().attr("id",o+"--group").insertBefore("#zimageedit__focus--shape").show(),e("#"+o+"--group").children().eq(0).attr("id",o),e("#"+o+"--group").children().eq(1).attr("id",o+"--line");var h,u,m,p,g;t=e("#"+o).attr("d").split(","),g=t[0].split(" "),h=parseFloat(g[0].substr(1,g[0].length))+20,u=parseFloat(g[1].substr(0,g[1].length))+20,g=t[1].split(" "),m=parseFloat(g[1].substr(0,g[1].length))+20,p=parseFloat(g[2].substr(0,g[2].length))+20,g="M"+h+" "+u+", "+m+" "+p,e("#"+o).attr("d",g),i.changeArrowHeadValues(o+"--line",o),i._idSelected=i.copied_Elements=o,i.drawBorder("line",u,h,m,p)}else if("numbering"===a.tool){e("#"+i.copied_Elements+"--group").clone().attr("id","zimageedit__shapes--"+n+"--group").insertBefore("#zimageedit__focus--shape");for(var _,f=e("#zimageedit__shapes--"+n+"--group").children().length,v=0;f>v;v++){var b;o=e("#zimageedit__shapes--"+n+"--group").children().eq(v).attr("id"),b=o.lastIndexOf("--"),_=o.slice(b,o.length);var y=o.indexOf("__shapes--")+10;o=o.slice(0,y)+n+_,e("#zimageedit__shapes--"+n+"--group").children().eq(v).attr("id",o)}var z=e("#zimageedit__shapes--"+n+"--path").attr("transform"),S=z;S=S.slice(S.indexOf("rotate"),S.length),z=z.slice(10,z.indexOf(" rotate")-1).split(","),z[0]=parseFloat(z[0])+10,z[1]=parseFloat(z[1])+10;var w="translate("+z[0]+","+z[1]+") "+S;i._idSelected="zimageedit__shapes--"+n,i.copied_Elements=i._idSelected,e("#zimageedit__shapes--"+n+"--fobject").children().eq(0).attr("id","zimageedit__shapes--"+n),i.drawObj(a.tool,i._idSelected,a.left+10,a.top+10,a.width,a.height,void 0,a.borderColor,a.borderStroke),e("#zimageedit__shapes--"+n+"--path").attr("transform",w),i.showBroderForNumbering(z[0],z[1],i._idSelected)}else if(void 0!==a.tool&&"textarea"!==a.tool){e("#"+i.copied_Elements).clone().attr("id","zimageedit__shapes--"+n).insertBefore("#zimageedit__focus--shape").show(),i.copied_Elements="zimageedit__shapes--"+n;var x=i.getValuesOfObject("#"+i.copied_Elements);if(x.top+=10,x.left+=10,i._idSelected=i.copied_Elements,"line"===a.tool)x.top+=5,x.left+=5,x.width+=15,x.height+=15;else if("polyline"===a.tool){var C=document.getElementById(i._idSelected),k=C.points.length;for(k--;k>=0;k--)C.points[k].y+=10,C.points[k].x+=10;i.removeShadowForMarker(),i.createShadowForMarker("zimageedit__shapes--"+n)}i.moveElements(x);var I={};I.target={},I.target.id=i._idSelected,i.multiSelectFlag===!0&&(i.resetMultiSelect(),i.multiSelectFlag=!1),i.setPropertiesForSelectedObject(a.tool),i.elementSelect("#zimageedit__shapes--"+n),i.checkForPlusDisplay(e("#zimageedit__shapes--"+n).attr("class"),I,"zimageedit__shapes--"+n)}void 0!==a.tool&&(i._noOfIdSelected.length=0,i._noOfIdSelected.push("#"+i._idSelected)),i.drawnElements.push("zimageedit__shapes--"+n),i.isDraw=!0,i.pushIntoStack("create")}},moveElements:function(t){if("ellipse"===t.tool)e("#"+i._idSelected).attr({cx:t.left,cy:t.top,rx:t.width,ry:t.height}),i.drawBorder("ellipse",t.top-t.height,t.left-t.width,t.width+t.width,t.height+t.height);else if("rectangle"===t.tool||"crop_element"===t.tool){if(e("#"+i._idSelected).attr({x:t.left,y:t.top,width:t.width,height:t.height}),"crop_element"===t.tool&&(i.cropAreaLock=!0,t.top=t.top<=0?1:t.top,t.left=t.left<=0?0:t.left,t.width+t.left>i.cropAreaWidth&&(t.left=i.cropAreaWidth-t.width),t.height+t.top>i.cropAreaHeight&&(t.top=i.cropAreaHeight-t.height),t.top=t.top<=0?0:t.top,t.left=t.left<=0?0:t.left,i.modifyTheCropAreaValues(t.top,t.left,t.width,t.height),e("#zimageedit__crop").attr({x:t.left,y:t.top,width:t.width,height:t.height})),"smudge"===e("#"+i._idSelected).attr("ctype")){var o=e("#"+i._idSelected).attr("cid");i.putValuesIntoCanvas(o,t.left,t.top,t.width,t.height)}i.drawBorder(t.tool,t.top,t.left,t.width,t.height)}else if("textarea"===t.tool)e("#"+i._idSelected).is(":focus")||(e("#"+i._idSelected).parent().attr({x:t.left,y:t.top}).css({left:t.left,top:t.top}),i.isIEBrowser&&e("#"+i._idSelected).parent().css({left:t.left,top:t.top}),i.multiSelectFlag===!1&&i.drawBorder("textarea",t.top,t.left,t.width,t.height));else if("line"===t.tool){var a="M"+t.left+" "+t.top+", "+t.width+" "+t.height;e("#"+i._idSelected).attr({d:a}),i.changeArrowHeadValues(i._idSelected+"--line",i._idSelected),i.drawBorder("line",t.top,t.left,t.width,t.height)}},elementMouseMove:function(t,o){var a,n,r,s,l,d,c;a=i.editorSVG.createSVGPoint(),a.x=t.clientX,a.y=t.clientY,a=a.matrixTransform(i.editorSVG.getScreenCTM().inverse()),i.element_attr[1]+=(a.x-i.previousX)*i.zoomScaleValue,i.element_attr[0]+=(a.y-i.previousY)*i.zoomScaleValue,"line"===i.element_attr[4]&&(i.element_attr[2]+=a.x-i.previousX,i.element_attr[3]+=a.y-i.previousY),n=a.x-i.previousX,r=a.y-i.previousY;var h=i.getValuesOfObject("#"+i._idSelected);if(i.element_attr[4]=h.tool,"polyline"===h.tool||"ellipse"===h.tool)l=a.x-o[0],d=a.y-o[1],s="translate("+l+"px,"+d+"px)",c=e("#"+i._idSelected),"ellipse"===h.tool?e("#"+i._idSelected).attr({cx:h.left+n,cy:h.top+r}):e(c).css({transform:s}),"polyline"!==h.tool&&i.multiSelectFlag===!1?i.drawBorder(h.tool,h.top+r-h.height,h.left+n-h.width,2*h.width,2*h.height):i.multiSelectFlag===!1?e("#"+i._idSelected+"--shadow, #"+i._idSelected+"--shadowblack").css({transform:s}):("ellipse"===h.tool?(h.top=h.top-h.height+r,h.left=h.left-h.width+n,h.width+=h.width,h.height+=h.height):(h.top+=d,h.left+=l),i.setBoundaryValuesMultiSelect("#"+i._idSelected,h.top,h.left,h.width,h.height));else if("textarea"===h.tool)l=parseFloat(e("#"+i._idSelected).parent().attr("x")),d=parseFloat(e("#"+i._idSelected).parent().attr("y")),e("#"+i._idSelected).parent().attr({x:l+n,y:d+r}),i.isIEBrowser&&e("#"+i._idSelected).parent().css({left:l+n+110,top:d+r+80}),i.multiSelectFlag===!1?i.drawBorder(h.tool,d+r,l+n,h.width,h.height):i.setBoundaryValuesMultiSelect("#"+i._idSelected,d+r,l+n,h.width,h.height);else if("rectangle"===h.tool)l=parseFloat(e("#"+i._idSelected).attr("x")),d=parseFloat(e("#"+i._idSelected).attr("y")),e("#"+i._idSelected).attr({x:l+n,y:d+r}),i.multiSelectFlag===!1?i.drawBorder(h.tool,h.top+r,h.left+n,h.width,h.height):i.setBoundaryValuesMultiSelect("#"+i._idSelected,d+r,l+n,h.width,h.height);else if("numbering"===h.tool)i.moveNumbering(n,r);else if("line"===h.tool)if(h.top+=r,h.height+=r,h.left+=n,h.width+=n,e("#"+i._idSelected).attr("d","M"+h.left+" "+h.top+", "+h.width+" "+h.height),i.changeArrowHeadValues(i._idSelected+"--line",i._idSelected),i.multiSelectFlag===!0){var u=document.getElementById(i._idSelected+"--group"),m=u.getBBox();br_w=parseFloat(e("#"+i._idSelected).css("stroke-width")),xr=m.width+br_w/2,yr=m.height+br_w/2,a.y=m.y*u.getScreenCTM().a,a.x=m.x*u.getScreenCTM().a,i.setBoundaryValuesMultiSelect("#"+i._idSelected,a.y,a.x,xr,yr)}else i.drawBorder("line",h.top,h.left,h.width,h.height);else i.previousX-a.x!=0&&(h.left+=a.x-i.previousX),i.previousY-a.y!=0&&(h.top+=a.y-i.previousY),i.moveElements(h,t)},moveNumbering:function(t,o){var a,n,r;if(r=e("#"+i._idSelected).attr("type-contains"),a=parseFloat(e("#"+i._idSelected+"--fobject").attr("y")),n=parseFloat(e("#"+i._idSelected+"--fobject").attr("x")),e("#"+i._idSelected+"--fobject").attr({y:a+o,x:n+t}),i.isIEBrowser&&e("#"+i._idSelected+"--fobject").css({top:a+o+80,left:n+t+110}),"wrong"===r){var s,l,d,c;p=e("#"+i._idSelected+"--wrong1"),s=parseFloat(p.attr("x1")),l=parseFloat(p.attr("y1")),c=parseFloat(p.attr("y2")),d=parseFloat(p.attr("x2")),p.attr({x1:s+t,y1:l+o,x2:d+t,y2:c+o}),e("#"+i._idSelected+"--wrong2").attr({x2:s+t,y1:l+o,x1:d+t,y2:c+o})}else if("tick"===r){var h;p=e("#"+i._idSelected+"--tick"),points=p.attr("points").split(","),h=parseFloat(parseFloat(points[0])+t),temp=points[1].split(" "),h=h+","+parseFloat(parseFloat(temp[0])+o)+" ",h+=parseFloat(parseFloat(temp[1])+t),temp=points[2].split(" "),h=h+","+parseFloat(parseFloat(temp[0])+o),h+=" "+parseFloat(parseFloat(temp[1])+t),h+=","+parseFloat(parseFloat(points[3])+o),p.attr("points",h)}else if("question"===r){var u,m;p=e("#"+i._idSelected+"--question1"),temp=p.attr("transform"),temp=temp.substr(10,temp.length).split(i.isIEBrowser===!1?",":" "),u=parseFloat(temp[0])+t,m=parseFloat(temp[1])+o,p.attr("transform","translate("+u+","+m+")"),p=e("#"+i._idSelected+"--question2"),u=parseFloat(p.attr("cx")),m=parseFloat(p.attr("cy")),e("#"+i._idSelected+"--question3, #"+i._idSelected+"--question2").attr({cx:u+t,cy:m+o})}var p=e("#"+i._idSelected+"--circle");a=parseFloat(p.attr("cy")),n=parseFloat(p.attr("cx")),p.attr({cx:n+t,cy:a+o}),trans=e("#"+i._idSelected+"--path").attr("transform"),trans=trans.match(/[+-]?\d+(\.\d+)?/g),trans[0]=parseFloat(trans[0])+t,trans[1]=parseFloat(trans[1])+o;var g="translate("+trans[0]+","+trans[1]+") rotate("+trans[2]+" "+trans[3]+" "+trans[4]+")";e("#"+i._idSelected+"--path").attr("transform",g),i.multiSelectFlag===!1?i.updateBorderForNumbering(n+t,a+o,32,i._idSelected):i.setBoundaryValuesMultiSelect("#"+i._idSelected,a+o-24,n+t-24,50,50)},smoothenPolylLine:function(){},setValuesFromTranslate:function(){var t,o,a,n=e("#"+i._idSelected).attr("class");if(a=document.getElementById(i._idSelected),-1==n.indexOf("zimageedit__textarea")){var r=document.getElementById(i._idSelected).style.transform;void 0!==r&&"none"!==r&&(r=r.split("(")[1].split(")")[0].split(","),t=parseFloat(r[0]),o=parseFloat(r[1]))}if(("number"!=typeof t||"number"!=typeof o)&&(o=t=0),-1!==n.indexOf("zimageedit__polyline")||-1!==n.indexOf("zimageedit__marker")){a=document.getElementById(i._idSelected);var s=Object.keys(a.points).length;for(void 0!==a.points.numberOfItems&&(s=a.points.numberOfItems),e("#"+i._idSelected).css("transform","none"),--s;s>=0;s--){var l=a.points.getItem(s);l.x+=t,l.y+=o}}i.createShadowForMarker(i._idSelected);var d=e("#"+i._idSelected).prev();e("#"+i._idSelected).insertAfter(d)},borders:function(){var t=i.initObjects("rect","2",void 0,void 0,"borderRect");i.focusElementRectWhite=e(t),t=i.initObjects("rect","1",void 0,void 0,"borderRect"),i.focusElementRectBlack=e(t),i.initObjects("polyline","zimageedit__active--text--leftWhite",i.textareaBorderWidth,1),i.initObjects("polyline","zimageedit__active--text--rightWhite",i.textareaBorderWidth,1),i.initObjects("polyline","zimageedit__active--text--left",i.textareaBorderWidth),i.initObjects("polyline","zimageedit__active--text--right",i.textareaBorderWidth),i.initObjects("rect","zimageedit__active--r1c2",12,4),i.initObjects("rect","zimageedit__active--r2c1",4,12),i.initObjects("rect","zimageedit__active--r2c3",4,12),i.initObjects("rect","zimageedit__active--r3c2",12,4),i.initObjects("rect","zimageedit__active--r1c1",8,8),i.initObjects("rect","zimageedit__active--r1c3",8,8),i.initObjects("rect","zimageedit__active--r3c1",8,8),i.initObjects("rect","zimageedit__active--r3c3",8,8),i.initObjects("circle","zimageedit__active--c1c1",5,4),i.initObjects("circle","zimageedit__active--c1c2",5,4)},initObjects:function(t,o,a,n,r){var s=document.createElementNS(i.svgPath,t),l=i.isMobileBrowser();if("borderRect"===r)s=document.createElementNS(i.svgPath,"rect"),i.setAttributeForObj(s,["stroke","white","fill","none","stroke-width",2,"id","zimageedit__focus--shape","class","zimageedit__focus--shape"]),"1"===o&&i.setAttributeForObj(s,["stroke","black","stroke-dasharray","4,4"]);else if("rect"===t)i.setAttributeForObj(s,["fill","none","width",a,"height",n,"stroke","black","fill","white","class","zimageedit__active--shape "+o,"stroke-width",1.4]),l&&(a===n?s.setAttribute("class","zimageedit__active--shape "+o+" resize--cornerpoints"):s.setAttribute("class","zimageedit__active--shape "+o+" resize--centerpoints"));else if("polyline"===t){var d="black",c="transparent";1===n&&(d="white",a=i.textareaBorderWidth+3),i.setAttributeForObj(s,["fill",c,"stroke-width",a,"stroke",d,"class","zimageedit__active--shape "+o])}else"circle"===t&&(i.setAttributeForObj(s,["fill","none","r",a,"stroke-width",n,"stroke","#2acf7a","fill","white","class","zimageedit__active--shape "+o]),l&&s.setAttribute("class","zimageedit__active--shape "+o+" resize--arrowpoints"));return i.editorSVG.appendChild(s),e(s)},setAttributeForObj:function(e,t){for(var i=t.length,o=0;i>o;o+=2)e.setAttribute(t[o],t[o+1])},isMobileBrowser:function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1},pushIntoStack:function(t,o){if(void 0===this._idSelected)return 0;e("#zimageeditor .zimageeditor__cancel").attr("disabled",!1);var a=i.undoStack.length,n={},r=i.getValuesOfObject("#"+this._idSelected);if("number"==typeof t&&i.undoStack.push(t),isNaN(r.left)!==!0&&this.isDraw===!0&&"delete"!==t&&"number"!=typeof t){if(n.action=t,n.idSelected=this._idSelected,n.object=r.tool,"polyline"===r.tool){var s=document.getElementById(this._idSelected);n.x1=s.getAttribute("points")}else n.x1=r.left;if(n.y1=r.top,n.x2=r.width,n.y2=r.height,n.fill=r.fill,n.brc=r.borderColor,n.brs=r.borderStroke,n.brw=r.borderWidth,n.fillOpacity=r.fillOpacity,n.strokeOpacity=r.strokeOpacity,"zimageedit__crop"===n.idSelected){var l;l="none"===i._imageCanvas.css("display")?parseFloat(i._imageCanvas.attr("width"))/parseFloat(i._imageCanvas.css("width")):parseFloat(i._imageCropCanvas.attr("width"))/parseFloat(i._imageCropCanvas.css("width")),n.percentage=l,n.crop_create=0===i.cropCaptureCount?!0:!1,n.crop_create===!0?i.cropAreaCanvasPosition=[n.x1,n.y1,n.x2,n.y2,parseFloat(i._imageCanvas.attr("width"))/parseFloat(i._imageCanvas.css("width"))]:1===o&&(i.cropAreaCanvasPosition=[i.cropAreaCanvasPosition[0]+n.x1,i.cropAreaCanvasPosition[1]+n.y1,n.x2,n.y2,parseFloat(i._imageCanvas.attr("width"))/parseFloat(i._imageCanvas.css("width"))]),n.canvasPosition=[i.cropAreaCanvasPosition[0],i.cropAreaCanvasPosition[1],i.cropAreaCanvasPosition[2],i.cropAreaCanvasPosition[3],i.cropAreaCanvasPosition[4]],n.zoomValue=i.fitToWidthZoomValue,n.cropCount=i.cropCaptureCount,i.cropCreated=!0}"resize"!==n.action&&"zimageedit__crop"===n.idSelected?i.undoStack[a]=n:"zimageedit__crop"!==n.idSelected&&(i.undoStack[a]=n),JSON.stringify(i.undoStack[a])===JSON.stringify(i.undoStack[a-1])&&"zimageedit__crop"!==i.undoStack[a].idSelected&&"zimageedit__crop"!==i.undoStack[a-1].idSelected&&i.undoStack.pop()}if("delete"===t&&void 0!==this._idSelected&&(n.action=t,n.idSelected=this._idSelected,n.object=r.tool,n.x1=r.left,n.y1=r.top,n.x2=r.width,n.y2=r.height,n.fill=r.fill,n.brc=r.borderColor,n.brs=r.borderStroke,n.brw=r.borderWidth,n.fillOpacity=r.fillOpacity,n.strokeOpacity=r.strokeOpacity,i.undoStack[a]=n,i.undoStack[a]===i.undoStack[a-1]&&i.undoStack.pop()),a=i.redoStack.length,a>0)for(a--;a>=0;a--)delete i.redoStack[a]},pushIntoUndoStack:function(e){i.undoStack.push(e)},pushIntoTempStack:function(e,t){if("zimageedit__crop"===e)return 0;0>=t&&(t=0);var o=i.getValuesOfObject("#"+this._idSelected),a={action:"resize",idSelected:this._idSelected,object:o.tool};if("polyline"===o.tool){var n=document.getElementById(this._idSelected);a.x1=n.getAttribute("points")}else a.x1=o.left;a.y1=o.top,a.x2=o.width,a.y2=o.height,a.fill=o.fill,a.brc=o.borderColor,a.brs=o.borderStroke,a.brw=o.borderWidth,a.fillOpacity=o.fillOpacity,a.strokeOpacity=o.strokeOpacity,i.tempStack[t]=a},copyFromTempToUndoStack:function(){var e,t=i.tempStack.length;for(e=0;t>e;e++)i.pushIntoUndoStack(i.tempStack[e]);t>2&&(i.undoStack[i.undoStack.length]=t/2),i.tempStack.length=0},pushIntoRedoStack:function(e){i.redoStack.push(e)},undoFunc:function(){i.removeBorderFocus(),i.removeBorderForNumbering(),i.removeShadowForMarker(),i.hideProperties(),i.removePlusAttributes(),i.removeMultiSelectBoundary();var t,o,a,n;if(t=i.undoStack.length,t=1>=t?t:t-1,t>0){o=i.undoStack[t];var r,s=1;for("number"==typeof o&&(s=o,i.undoStack.pop()),r=s,s;s>0;s--){o=i.undoStack.pop(),"blur"===o.idSelected.substr(0,4)&&(i.smudgeStackPosition-=1,i.redrawCanvas(o.idSelected,"undo")),i.pushIntoRedoStack(o);var l=o.action;if("create"===l){var d=o.object;a=o.idSelected,n=e("#"+a),void 0!==d&&"canvasDraw"===d&&(i.canvasBlurEditUndoRedo(o),i.blurPositionLength--);var c=e(n).attr("class");if(void 0!==c&&"zimageedit__numbering--input"===c.substr(0,28)){e("#"+a+"--group").hide();var h=e("#"+a).val();h==i.currentValueForNumbering-1&&(i.currentValueForNumbering-=1),i.isIEBrowser&&e("#"+a+"--fobject").toggle()}else void 0!==c&&-1!=c.indexOf("zimageedit__line")&&e("#"+a+"--group").hide();if(n.hide(),"zimageedit__crop"===o.idSelected&&(i.removeCssFromCrop(),o=i.undoStack.pop(),void 0!==o&&"zimageedit__crop"===o.idSelected))if(i.isImageCropped=!1,i.cropCaptureCount--,i.pushIntoRedoStack(o),o.crop_create===!0){i._imageCanvas.css("display","inherit"),i._imageCropCanvas.css("display","none");var u=parseFloat(i._imageCanvas.attr("width")),m=parseFloat(i._imageCanvas.attr("height"));u>e(window).width()-220&&(u=e(window).width()-220),m>e(window).height()-150&&(m=e(window).height()-150);var p=Math.min(u/i._imageWidth,m/i._imageHeight);u=i._imageWidth*p,m=i._imageHeight*p,i.SVGElement.attr({width:u*i.fitToWidthZoomValue/100,height:m*i.fitToWidthZoomValue/100}),i._imageCanvas.css({width:u*i.fitToWidthZoomValue/100,height:m*i.fitToWidthZoomValue/100}),i.finalCropPosition=[0,0,0,0,0],i.editorSVG.setAttribute("viewBox","0 0 "+u+" "+m),i.placeCropAreaInCenter(0,0,i.actualWidth,i.actualHeight),i.removeCssFromCrop(),i.cropAreaCanvasPosition=[0,0],i.zoomFunction(i.currentZoomValue)}else i.extractValuesdForCropFromStack(o,"undo")}else if("resize"===l)a=i.undoStack.pop(),void 0!==a&&(l===a.action&&o.idSelected===a.idSelected?(i.pushIntoRedoStack(a),o=a):i.pushIntoUndoStack(a)),i.extractValuesFromUndoStack(o);else if("delete"===l){a=o.idSelected;var g=i.typeOfElement(a);"line"===g?e("#"+a).parent().toggle():(e("#"+a).toggle(),n=e("#"+a),"numbering"===g&&(i.isIEBrowser===!0&&e("#"+a+"--fobject").toggle(),e("#"+a+"--group").toggle(),e("#"+a).toggle()))}}r>1&&i.pushIntoRedoStack(r)}},redrawCanvas:function(e,t){var o,a,n,r,s=0;a=parseInt(e.substr(5,e.length)),n="none"===i._imageCanvas.css("display")?document.getElementById("zimageditCropCanvas"):i.mainCanvas;var l=n.getContext("2d");"redo"===t?a+=1:r=document.getElementById(i.inputImageId),s=a;var d=i.smudgeStack[s][0],c=i._imageWidth/i.actualWidth;for("none"===i._imageCanvas.css("display")&&(viewBox=i.editorSVG.getAttribute("viewBox").split(/\s+|,/),c=parseFloat(i._imageCropCanvas.attr("width"))/parseFloat(i._imageCropCanvas.css("width"))),o=1;o<=i.smudgeStack[s].length-2;o+=2){var h,u;h=parseInt(i.smudgeStack[s][o]),u=parseInt(i.smudgeStack[s][o+1]),l.drawImage(r,h+i.finalCropPosition[0]*i.finalCropPosition[4],u+i.finalCropPosition[1]*i.finalCropPosition[4],i.smudgeBrushSize*d,i.smudgeBrushSize*d,h,u,i.smudgeBrushSize*d,i.smudgeBrushSize*d)}},changeOpacity:function(t,o){e("#zimageeditor__colorpalatte--menu .zimageeditor__opacity span").css("opacity",o);var a=i._noOfIdSelected.length;for(a--;a>=0;a--){var n=i._noOfIdSelected[a];n=n.substr(1,n.length),this._idSelected=n,n=e("#"+n);var r=i.typeOfElement(i._idSelected);"fill"!==t||"ellipse"!==r&&"rectangle"!==r?"stroke"===t&&("numbering"!==r&&n.attr({"stroke-opacity":o}),"line"===r&&e("#"+this._idSelected+"--line").attr({"fill-opacity":o,"stroke-opacity":o})):n.attr({"fill-opacity":o}),i.isDraw=!1}},changeFillColor:function(t){"none"!==t&&(t="#"+t),i.changeIconColorProperties(t,void 0);var o=i._noOfIdSelected.length-1;for(i.isDraw=!0,i.previousFillColor=t,o;o>=0;o--){i.previousFillColor=t;var a=i._noOfIdSelected[o];a=a.substr(1,a.length),this._idSelected=a,i.pushIntoTempStack(i._idSelected,2*o),a=e("#"+a);var n=a.attr("class").slice(12,a.attr("class").length);"textarea"!==n&&"line"!==n&&"marker"!==n&&"polyline"!==n&&e("#"+this._idSelected).attr("fill",t),i.pushIntoTempStack(i._idSelected,2*o+1)}i.copyFromTempToUndoStack(),i.isDraw=!1},canvasBlurEditUndoRedo:function(t){var o,a;o=t.brw,a=i._imageWidth/i.actualWidth;var n,r,s,l,d=e("#"+t.idSelected);n=parseFloat(e(d).css("left")),r=parseFloat(e(d).css("top")),s=parseFloat(e(d).attr("width")),l=parseFloat(e(d).attr("height")),e("#"+t.idSelected).clone().attr("id","zimageedit__canvasBlur--temp").appendTo("#zimageeditor__image");var c=i.mainCanvas;"none"===i._imageCanvas.css("display")&&(c=document.getElementById("zimageditCropCanvas"));var h=document.getElementById(t.idSelected),u=document.getElementById("zimageedit__canvasBlur--temp"),m=c.getContext("2d"),p=h.getContext("2d"),g=u.getContext("2d");g.drawImage(c,n,r,s,l,0,0,s,l),m.drawImage(h,n,r,s,l),p.drawImage(u,0,0,s,l),e("#zimageedit__canvasBlur--temp").remove()},changeBorderColor:function(t){t="none"!==t?"#"+t:"transparent",i.changeIconColorProperties(void 0,t),i.previousBorderColor=t;var o=i._noOfIdSelected.length-1;for(o;o>=0;o--){var a=i._noOfIdSelected[o];a=a.substr(1,a.length),this._idSelected=a,i.pushIntoTempStack(i._idSelected,2*o),a=e("#"+a);var n=a.attr("class");e("#zimageedit__triangle").attr("stroke",t).attr("fill",t),-1!=n.indexOf("zimageedit__line")&&e("#"+this._idSelected+"--line").attr("stroke",t).attr("fill",t),"zimageedit__numbering--input zimageedit__numbering"===n&&"numbering"===e("#"+i._idSelected).attr("type-contains")?(i.previousNumberingColor=t,e("#"+this._idSelected+"--circle, #"+this._idSelected+"--path").attr("stroke",t),e("#"+this._idSelected+"--path").attr("fill",t)):i.previousBorderColor=t,n=n.slice(11,n.length),"textarea"!==n&&e("#"+this._idSelected).attr("stroke",t),n=n.slice(8,n.length),i.pushIntoTempStack(i._idSelected,2*o+1)}i.copyFromTempToUndoStack()},extractValuesdForCropFromStack:function(t,o){i.isImageCropped=!0;var a,n,r,s,l,d;l=t.zoomValue;var c=t.percentage;d=i.fitToWidthZoomValue/l,c=i.fitToWidthZoomValue/l,a=Math.abs(t.x1)*d,n=Math.abs(t.y1)*d,r=t.x2*d,s=t.y2*d,i._crop_arr=[a,n,r,s];var h,u,m,p,g=document.getElementById("zimageditCropCanvas"),_=i.mainCanvas,f=g.getContext("2d");h=t.canvasPosition[0]*t.canvasPosition[4],u=t.canvasPosition[1]*t.canvasPosition[4],m=t.canvasPosition[2]*t.canvasPosition[4],p=t.canvasPosition[3]*t.canvasPosition[4],i.updateFinalCropPosition(t.canvasPosition[0],t.canvasPosition[1],t.canvasPosition[2],t.canvasPosition[3],t.canvasPosition[4]),i._imageCropCanvas.attr({width:m,height:p}).css({display:"block",width:m/t.canvasPosition[4]*c,height:p/t.canvasPosition[4]*c}),"redo"===o?(i.cropAreaCanvasPosition=[t.canvasPosition[0],t.canvasPosition[1],t.canvasPosition[2],t.canvasPosition[3]],f.drawImage(_,h,u,m,p,0,0,m,p),i._imageCanvas.css("display","none")):"undo"===o&&(f.drawImage(_,h,u,m,p,0,0,m,p),i._imageCanvas.css("display","none")),i.SVGElement.attr({width:m/t.canvasPosition[4]*c,height:p/t.canvasPosition[4]*c}),e("#zimageedit__crop--tempElement").remove(),i.placeCropAreaInCenter(n-85,a-100,r-110,s-85),i.editorSVG.setAttribute("viewBox",a+" "+n+" "+r+" "+s),i.zoomFunction(i.currentZoomValue)},redoFunc:function(){i.removeBorderFocus(),i.removeBorderForNumbering(),i.removeShadowForMarker(),i.hideProperties(),i.removePlusAttributes(),i.removeMultiSelectBoundary();var t,o,a,n=i.redoStack.length;if(n=1>=n?n:n-1,n>0){var r,s=1;for(t=i.redoStack[n],"number"==typeof t&&(s=t,i.redoStack.pop()),r=s,s;s>0;s--)if(t=i.redoStack.pop(),void 0!==t){var l=t.action;if(i.pushIntoUndoStack(t),"create"===l){"canvasDraw"===t.object&&i.canvasBlurEditUndoRedo(t),o=i.redoStack.pop(),void 0!==o&&("resize"===o.action&&t.idSelected===o.idSelected?(i.pushIntoUndoStack(o),t=o):i.pushIntoRedoStack(o)),o=t.idSelected,e("#"+o).show();var d=e("#"+o).attr("class");if(void 0!==d&&"zimageedit__numbering--input"===d.substr(0,28)){e("#"+o+"--group").show();var c=parseInt(e("#"+o).val());c===i.currentValueForNumbering&&(i.currentValueForNumbering+=1),i.isIEBrowser&&e("#"+o+"--fobject").show()}void 0!==d&&-1!=d.indexOf("zimageedit__line")&&e("#"+o+"--group").show(),a=e("#"+o),"zimageedit__crop"===t.idSelected&&(t=i.redoStack.pop(),i.pushIntoUndoStack(t),void 0!==t&&"zimageedit__crop"===t.idSelected&&(i.cropCaptureCount++,i.extractValuesdForCropFromStack(t,"redo")))}else if("resize"===l)o=i.redoStack.pop(),void 0!==o&&("resize"===o.action&&t.idSelected===o.idSelected?(i.pushIntoUndoStack(o),t=o):i.pushIntoRedoStack(o)),a=t,i.extractValuesFromUndoStack(a);else if("delete"===l){o=t.idSelected,a=e("#"+o);var h=i.typeOfElement(o);"line"===h?e("#"+o+"--group").toggle():("numbering"===h&&(i.isIEBrowser===!0&&e("#"+o+"--fobject").toggle(),e("#"+o+"--group").toggle(),e("#"+o).toggle()),a.toggle())}}r>1&&i.pushIntoUndoStack(r)}},removeCssFromCrop:function(){i.cropPosition[0]="none",i._imageCanvas.css({clip:""}),e("#zimageedit__canvas--blur, #zimageeditor__svgeditor").css({clip:""}),this._canvasContainer.css({clip:""})},extractID:function(e){var t=i.typeOfElement(e);if("line"===t||"rectangle"===t||"ellipse"===t||"pencil"===t||"marker"===t||"textarea"===t||"numbering"===t){var o=/\d+/g;return"zimageedit__shapes--"+e.match(o)}return e},extractValuesFromUndoStack:function(e){this.drawObj(e.object,e.idSelected,e.x1,e.y1,e.x2,e.y2,e.fill,e.brc,e.brs,e.brw,e.fillOpacity,e.strokeOpacity)},drawObj:function(t,o,a,n,r,s,l,d,c,h,u,m){if(void 0===c&&(c="none"),"ellipse"===t)e("#"+o).attr({cx:a,cy:n,rx:r,ry:s,fill:l,stroke:d,"stroke-width":h,"stroke-dasharray":c,"stroke-opacity":m,"fill-opacity":u}),i.previousFillColor=l,i.previousBorderColor=d;else if("rectangle"===t){e("#"+o).attr({x:a,y:n,width:r,height:s,fill:l,stroke:d,"stroke-width":h,"stroke-dasharray":c,"stroke-opacity":m,"fill-opacity":u});var p=e("#"+o).attr("ctype"),g=e("#"+o).attr("cid");"smudge"===p&&i.putValuesIntoCanvas(g,a,n,r,s)}else if("line"===t){var _="M"+a+" "+n+", "+r+" "+s;e("#"+o).attr({d:_,fill:l,stroke:d,"stroke-width":h,"stroke-dasharray":c,"stroke-opacity":m}),e("#"+o+"--line").attr({fill:d,stroke:d,"stroke-width":h>4?h-5:h/4,"stroke-opacity":m,"fill-opacity":m}),i.changeArrowHeadValues(o+"--line",o),i.previousFillColor=l,i.previousBorderColor=d}else if("textarea"===t)e("#"+o).css({color:d,"font-size":h}).attr("class",l.shadow).blur(),e("#"+o).parent().attr({x:a,y:n,left:a,top:n,width:r,height:s}).attr({x:a,y:n,width:r,height:s}),i.isIEBrowser&&e("#"+o).parent().css({left:a+110,top:n+80,width:r,height:s}),e("#"+o).val(c);else if("polyline"===t){var f=document.getElementById(o);f.setAttribute("points",a),e("#"+o).attr({fill:l,stroke:d,"stroke-width":h,"stroke-opacity":m})}else if("numbering"===t){e("#"+o+"--fobject").attr({y:n+9,x:a+5}),i.isIEBrowser&&e("#"+o+"--fobject").css({top:n+9+80,left:a+5+110}),e("#"+o+"--path").attr({transform:d}),e("#"+o+"--circle").attr({cx:a+21,cy:n+25});var v=e("#"+o).attr("type-contains");if("numbering"===v)e("#"+o+"--path").attr({fill:c,stroke:c}),e("#"+o+"--circle").attr({stroke:c});else if("wrong"===v)e("#"+o+"--wrong1").attr({x1:a+16,y1:n+20,x2:a+26,y2:n+30}),e("#"+o+"--wrong2").attr({x1:a+26,y1:n+20,x2:a+16,y2:n+30});else if("question"===v){var b,y;b=a+17,y=n+18,e("#"+o+"--question1").attr({transform:"translate("+b+","+y+")"}),e("#"+o+"--question2, #"+o+"--question3").attr({cx:a+21,cy:n+32})}else if("tick"===v){var z,S;z=a+15,S=n+26.5;var w=""+z+","+S+" ";z+=3.5,S+=3.4,w+=+z+","+S+" ",z+=8.5,S-=8.4,w=w+z+","+S,e("#"+o+"--tick").attr({points:w})}}},elementSelect:function(e,t,o){var a=i.getValuesOfObject(e);i.funcForCalc(a),"color_select"===o&&("textarea"===a.tool?(a.borderColor=i.regtohex_convert(a.fill.border),a.fill=a.fill.bck_color,"rgb"===a.fill.substr(0,3)&&(a.fill="none"),"#000000"===a.borderColor&&(a.borderColor="none")):"numbering"===a.tool&&(a.borderColor=a.borderStroke),i.strokeWidthSelected=a.borderWidth,i.strokeDasharraySelected=a.borderStroke,i.changeIconColorProperties(a.fill,a.borderColor,a.borderStroke,a.borderWidth,a.fillOpacity))},multiSelect:function(t,o){i.removeBorderFocus(),i.removeShadowForMarker(),i.removePlusAttributes();var a,n,r,s,l,d,c,h;for(h=this.getValuesOfObject(t),r=i._noOfIdSelected.length,s=0,r--;r>=0;--r){if(i._noOfIdSelected[r]===t){s=1;break}d=i._noOfIdSelected[r];var u=i.getValuesOfObject(d);if(l=i.createBoundary(d),1===l){if(i.setBoundaryValues(d,u),"polyline"===u.tool){var m=i.typeOfElement(d.substr(1,d.length));"marker"===m&&(u.tool="marker")}else"numbering"===u.tool&&(c=e(t).attr("type-contains"));i.checkPropertiesAvailableForMultiSelect(u.tool,c)}}if(0===s){i._noOfIdSelected.push(t),d=t;var p=i.getValuesOfObject(d);if(i.createBoundary(d),i.setBoundaryValues(d,p),"polyline"===p.tool){var m=i.typeOfElement(d.substr(1,d.length));"marker"===m&&(p.tool="marker")}else"numbering"===p.tool&&(c=e(t).attr("type-contains"));i.checkPropertiesAvailableForMultiSelect(p.tool,c)}else{var g=r;i.removeMultiSelectBoundary(i._noOfIdSelected[g]),i._noOfIdSelected.splice(g,1),i.PropertiesAvailableForMultiSelect=[!0,!0,!0,!0,!0,!0,!0];for(var _=0;_<i._noOfIdSelected.length;_++){var u=i.getValuesOfObject(i._noOfIdSelected[_]);if("polyline"===u.tool){var m=i.typeOfElement(i._noOfIdSelected[_].substr(1,i._noOfIdSelected[_].length));"marker"===m&&(u.tool="marker")}else"numbering"===u.tool&&(c=e(t).attr("type-contains"));i.checkPropertiesAvailableForMultiSelect(u.tool,c)}}i.hideProperties(),i._noOfIdSelected.length>0&&i.showProperties(o.target.id,"multiSelect"),1===i._noOfIdSelected.length&&("textarea"===h.tool?(h.borderColor=i.regtohex_convert(h.fill.border),h.fill=h.fill.bck_color,"rgb"===h.fill.substr(0,3)&&(h.fill="none"),"#000000"===h.borderColor&&(h.borderColor="none")):"numbering"===h.tool&&(h.borderColor=h.borderStroke),i.fillIconColor=h.fill,i.borderIconColor=h.borderColor,i.strokeWidthSelected=h.borderWidth,i.strokeDasharraySelected=h.borderStroke,i.changeIconColorProperties(h.fill,h.borderColor,h.borderStroke,h.borderWidth,h.fillOpacity)),i._noOfIdSelected.length>1&&("textarea"===h.tool?(h.borderColor=i.regtohex_convert(h.fill.border),h.fill=h.fill.bck_color,"rgb"===h.fill.substr(0,3)&&(h.fill="none"),"#000000"===h.borderColor&&(h.borderColor="none")):"numbering"===h.tool&&(h.borderColor=h.borderStroke),a=h.fill,i.fillIconColor!==h.fill&&(a="#7F7F7F",i.fillIconColor=a),n=h.borderColor,i.borderIconColor!==h.borderColor&&(n="#7F7F7F",i.borderIconColor=n),i.changeIconColorProperties(a,n,h.borderStroke,h.borderWidth,h.fillOpacity),h.borderStroke===i.strokeDasharraySelected||void 0===h.borderWidth&&"none"===h.borderWidth||e("#zimageeditor__strokewidth--menu").zmenu("uncheckMenuItems")),i.setPropertiesForSelectedObject()},selectAll:function(){if(void 0===i._selectedTool){var t=i.drawnElements;i.resetMultiSelect(),i.removeBorderForNumbering(),i.removeShadowForMarker(),e("#zimageeditor__svgeditor").children();for(var t=e("#zimageedit__focus--shape").prevAll(),o=0;o<t.length;o++){var a=i.extractID(t[o].id),n=i.typeOfElement(a);"hidden"!==e("#"+a).css("visibility")&&"none"!==e("#"+a).css("display")&&void 0!==a&&(void 0===e("#"+a).attr("class")||-1==e("#"+a).attr("class").indexOf("zimageedit__numbering")||"none"!==e("#"+a+"--fobject").css("display")&&"none"!==e("#"+a+"--group").css("display"))&&("line"!==n||"hidden"!==e("#"+a+"--group").css("visibility")&&"none"!==e("#"+a+"--group").css("display"))&&(i.multiSelectFlag=!0,i.multiSelect("#"+a,{target:{id:a}}))}if(i.isIEBrowser)for(var o=0;o<i.textareaCreatedElements.length;o++){var a=i.textareaCreatedElements[o];"none"!==e("#"+a).css("display")&&(i.multiSelectFlag=!0,i.multiSelect("#"+a,{target:{id:a}}))}}},createBoundary:function(t){var o;return e(t+"-MultiSelect").length>0?0:(t=t.substr(1,t.length),o=i.initObjects("rect","2",void 0,void 0,"borderRect"),o.attr({id:t+"-MultiSelect","class":"zimageedit__focus--multiselect"}),o=i.initObjects("rect","1",void 0,void 0,"borderRect"),o.attr({id:t+"-MultiSelect2","class":"zimageedit__focus--multiselect"}),1)},setBoundaryValuesMultiSelect:function(t,i,o,a,n){e(""+t+"-MultiSelect ,"+t+"-MultiSelect2").attr({x:o-4,y:i-4,width:a+6,height:n+6})},removeMultiSelectBoundary:function(t){e(t+"-MultiSelect").remove(),e(t+"-MultiSelect2").remove()},funcForCalc:function(e){var t,o,a,n,r;o=e.left,t=e.top,a=e.width,n=e.height,r=e.tool,"ellipse"===e.tool&&(t-=n,o-=a,a+=a,n+=n),"polyline"!==e.tool&&i.multiSelectFlag===!1&&"numbering"!==e.tool&&this.drawBorder(r,t,o,a,n),"numbering"!==e.tool&&i.removeBorderForNumbering()},resetMultiSelect:function(){var e=i._noOfIdSelected.length;for(e--;e>=0;e--){var t=i._noOfIdSelected.pop();i.removeMultiSelectBoundary(t)}i.PropertiesAvailableForMultiSelect=[!0,!0,!0,!0,!0,!0,!0]},checkPropertiesAvailableForMultiSelect:function(e,t){var o;"ellipse"===e?o=0:"rectangle"===e?o=1:"polyline"===e?o=2:"marker"===e?o=3:"numbering"===e?o=4:"line"===e?o=5:"textarea"===e&&(o=6),"numbering"===e&&"numbering"!==t&&(o=3),i.PropertiesAvailableForMultiSelect[0]&=i.propertiesOfObjects[o][1],i.PropertiesAvailableForMultiSelect[1]&=i.propertiesOfObjects[o][2],i.PropertiesAvailableForMultiSelect[2]&=i.propertiesOfObjects[o][3],i.PropertiesAvailableForMultiSelect[3]&=i.propertiesOfObjects[o][4],i.PropertiesAvailableForMultiSelect[4]&=i.propertiesOfObjects[o][5],i.PropertiesAvailableForMultiSelect[5]&=i.propertiesOfObjects[o][6],i.PropertiesAvailableForMultiSelect[6]&=i.propertiesOfObjects[o][7]},setBoundaryValues:function(t,o){var a,n,r,s,l;if(n=o.left,a=o.top,r=o.width,s=o.height,l=o.tool,"ellipse"===l)a=a-s-o.borderWidth/2,n=n-r-o.borderWidth/2,r=r+r+o.borderWidth,s=s+s+o.borderWidth;else if("line"===l){var d=document.getElementById(t.substr(1,t.length)+"--group"),c=d.getBBox();br_w=parseFloat(e(t).css("stroke-width")),r=c.width+br_w/2,s=c.height+br_w/2,a=c.y*d.getScreenCTM().a,n=c.x*d.getScreenCTM().a;var h=e(t).attr("d"),u=/[+-]?\d+(\.\d+)?/g;if(void 0!==h){if(h=h.match(u).map(function(e){return parseFloat(e)}),n=parseFloat(h[0]),a=parseFloat(h[1]),r=parseFloat(h[2]),s=parseFloat(h[3]),n>r){var m;m=r,r=n,n=m}if(a>s){var m;m=s,s=a,a=m}r-=n,s-=a,r+=br_w,s+=br_w}}else"numbering"===l?n-=2:"rectangle"===l&&(a-=o.borderWidth/2,n-=o.borderWidth/2,r+=o.borderWidth,s+=o.borderWidth);i.setBoundaryValuesMultiSelect(t,a,n,r,s)},handleZoomCases:function(e){var t,o=i.orginalCanvasFitToWidth;"none"!==i._imageCanvas.css("display")?t=i._imageWidth:(t=parseFloat(i._imageCropCanvas.attr("width")),o=i.cropImageWidth),i.previousZoomValue=i.currentZoomValue,"zoomin"===e&&i.currentZoomValue<=175?(i.currentZoomValue<10&&(i.currentZoomValue=10),i.currentZoomValue<25?i.currentZoomValue=25:i.currentZoomValue<50?i.currentZoomValue=50:i.currentZoomValue<75?i.currentZoomValue=75:i.currentZoomValue<100?i.currentZoomValue=100:i.currentZoomValue<125?i.currentZoomValue=125:i.currentZoomValue<150?i.currentZoomValue=150:i.currentZoomValue<175&&(i.currentZoomValue=200)):"zoomout"===e&&i.currentZoomValue>=10?i.currentZoomValue<=25?i.currentZoomValue=10:i.currentZoomValue<=50?i.currentZoomValue=25:i.currentZoomValue<=75?i.currentZoomValue=50:i.currentZoomValue<=100?i.currentZoomValue=75:i.currentZoomValue<=125?i.currentZoomValue=100:i.currentZoomValue<=150?i.currentZoomValue=125:i.currentZoomValue<=175?i.currentZoomValue=150:i.currentZoomValue<=200&&(i.currentZoomValue=175):i.currentZoomValue=e,t*=i.currentZoomValue/100;var a=t/o;i.fitToWidthZoomValue=100*a,i.zoomFunction()},zoomFunction:function(){var t,o,a,n,r,s,l,d;if(l=i._imageCanvas,d=i._imageCropCanvas,r="none"===l.css("display"),s=e("#zimageeditor__image"),r===!1)i.actualWidth=i._imageWidth*(i.currentZoomValue/100),i.actualHeight=i._imageHeight*(i.currentZoomValue/100),l.css({width:i.actualWidth,height:i.actualHeight});else{var c=i.fitToWidthZoomValue/100;i.actualWidth=parseFloat(d.attr("width"))*c,i.actualHeight=parseFloat(d.attr("height"))*c}o=i.actualWidth,t=i.actualHeight,a=e(window).width(),n=e(window).height();var h=(n-t)/2,u=(a-o)/2;i.addorRemoveTopBand(n,t),e("#zimageeditor__btns--zoomOut, #zimageeditor__btns--zoomIn").attr("disabled","disabled"),i.currentZoomValue>10&&e("#zimageeditor__btns--zoomOut").removeAttr("disabled"),i.currentZoomValue<200&&e("#zimageeditor__btns--zoomIn").removeAttr("disabled"),s.css({left:0>u-110?0:u-110,top:0>h-85?0:h-85,width:o,height:t}),r===!1?l.css({width:o,height:t}):d.css({width:o,height:t}),i.svgContainer.css({left:0>u-110?0:u-110,top:0>h-85?0:h-85,width:o,height:t}),i.SVGElement.attr({width:o,height:t}),e("#zimageedit__canvas--blur").css({width:o,height:t}),i._imageTop=h,i._imageLeft=u,e("#zimageeditor__container").css("overflow","auto");var m=document.getElementById("zimageeditor__container"),p=m.scrollHeight-m.offsetHeight,g=m.scrollWidth-m.offsetWidth;p/=2,g/=2,e("#zimageeditor__container").scrollTop(p).scrollLeft(g),i.changeZoomTextValue(i.currentZoomValue),i.cropCreated===!0&&(i.zoomScaleValue=i.fitToWidthZoomValue/100,i.resizeCropBoundaries(Math.round(o),Math.round(t)))},addorRemoveTopBand:function(t,i){i>t-85?e("#zimageeditor .zimageeditor__header").addClass("zimageeditor__header--bgdark"):e("#zimageeditor .zimageeditor__header").removeClass("zimageeditor__header--bgdark")},getValuesOfObject:function(t){i.valuesOfObject={};var o,a,n,r,s,l,d,c,h,u,m,p,g=e(t).attr("class"),_=e(t).prop("tagName");if((void 0===t||void 0===g)&&"CANVAS"!==_)return 0;if(g=g||"","CANVAS"===_&&(p=e(t),o=parseFloat(p.css("top")),a=parseFloat(p.css("left")),n=parseFloat(p.attr("width")),r=parseFloat(p.attr("height")),s="canvasDraw",l=i._imageWidth/i.actualWidth,o-=85,a-=110),-1!=g.indexOf("zimageedit__rectangle")||"zimageedit__crop"===g)p=e(t),o=parseFloat(p.attr("y")),a=parseFloat(p.attr("x")),n=parseFloat(p.attr("width")),r=parseFloat(p.attr("height")),l=parseFloat(p.attr("stroke-width")),d=p.attr("stroke"),m=p.attr("stroke-opacity"),c=p.attr("stroke-dasharray"),h=p.attr("fill"),u=p.attr("fill-opacity"),s="rectangle","zimageedit__crop"===g&&(s="crop_element");else if(-1!=g.indexOf("zimageedit__ellipse"))p=e(t),o=parseFloat(p.attr("cy")),a=parseFloat(p.attr("cx")),n=parseFloat(p.attr("rx")),r=parseFloat(p.attr("ry")),l=parseFloat(p.attr("stroke-width")),d=p.attr("stroke"),m=p.attr("stroke-opacity"),c=p.attr("stroke-dasharray"),h=p.attr("fill"),u=p.attr("fill-opacity"),s="ellipse";else if(-1!=g.indexOf("zimageedit__line")){if(void 0!==t&&void 0!==e(t).attr("points")){var f=t.substr(0,t.length-6);t=f,i._idSelected=f.substr(1,f.length)}p=e(t);var v=p.attr("d"),b=/[+-]?\d+(\.\d+)?/g;void 0!==v&&(v=v.match(b).map(function(e){return parseFloat(e)}),a=parseFloat(v[0]),o=parseFloat(v[1]),n=parseFloat(v[2]),r=parseFloat(v[3])),l=parseFloat(p.attr("stroke-width")),d=p.attr("stroke"),m=p.attr("stroke-opacity"),c=p.attr("stroke-dasharray"),h=p.attr("fill"),s="line"}else if(-1!=g.indexOf("zimageedit__textarea")){p=t.substr(1,t.length)+"--fobject",p=e("#"+p),o=parseFloat(p.attr("y")),a=parseFloat(p.attr("x")),n=parseFloat(p.attr("width")),r=parseFloat(p.attr("height"));var y=i.regtohex_convert(e("#"+t.substr(1,t.length)).css("border-color"));l=e("#"+t.substr(1,t.length)).css("font-size"),d=i.regtohex_convert(e("#"+t.substr(1,t.length)).css("color")),c=e("#"+t.substr(1,t.length)).val();var z=e("#"+t.substr(1,t.length)).attr("class"),S=i.regtohex_convert(e("#"+t.substr(1,t.length)).css("background-color"));h={shadow:z,bck_color:S,border:y},s="textarea"}else if("zimageedit__numbering--input zimageedit__numbering"===g){p=t.substr(1,t.length)+"--fobject";var w=t.substr(1,t.length);p=e("#"+p),o=parseFloat(p.attr("y"))-9,a=parseFloat(p.attr("x"))-5,s="numbering",n=parseFloat(e(p).attr("width"))+19,r=parseFloat(e(p).attr("height"))+21,d=e("#"+w+"--path").attr("transform"),c=i.regtohex_convert(e("#"+w+"--path").attr("stroke"))}else if("zimageedit__blur--canvas"===g)p=e(t),o=parseFloat(p.css("top")),a=parseFloat(p.css("left")),n=parseFloat(e(p).attr("width")),r=parseFloat(e(p).attr("height")),s="smudge";else if(-1!==g.indexOf("zimageedit__polyline")||-1!=g.indexOf("zimageedit__marker")){p=e(t);var x=p.attr("filter");void 0!==x&&p.removeAttr("filter");var C=p.css("display"),k=document.getElementById(t.substr(1,t.length));p.css("display","inline");var I=k.getBBox();p.css("display",C),n=I.width,r=I.height;var T={};T=i.editorSVG.createSVGPoint(),T.y=I.y*k.getScreenCTM().a,T.x=I.x*k.getScreenCTM().a,o=T.y,a=T.x,s="polyline",l=parseFloat(p.css("stroke-width")),r+=l/2,o-=l/2,o+=2,o/=i.fitToWidthZoomValue/100,a/=i.fitToWidthZoomValue/100,d=i.regtohex_convert(p.attr("stroke")),m=i.regtohex_convert(p.attr("stroke-opacity")),c=p.attr("stroke-dasharray"),h=i.regtohex_convert(p.attr("fill")),void 0!==x&&p.attr("filter",x)}return i.valuesOfObject={top:o,left:a,width:n,height:r,tool:s,fill:h,borderColor:d,borderStroke:c,borderWidth:l,fillOpacity:u,strokeOpacity:m},i.borderWidth=-1==g.indexOf("zimageedit__textarea")?i.valuesOfObject.borderWidth:1,i.valuesOfObject},_close:function(){i.options.annotatorType?i._createCanvas():(e("#zimageeditor .zimageeditor__cancel").off("click"),e(window).off("resize.zimageedit"),e("body").off("keyup.zimageeditor keydown.zimageeditor mouseup.zimageeditor mousemove.zimageeditor"),e(document).off("dragstart.zimageeditor zmenusubmenuitemclick.zimageeditor zmenuitemclick.ze"),e("#zimageeditor__shapes--menu, #zimageeditor__textarea--menu, #zimageeditor__numbering--menu, #zimageeditor__colorpalatte--menu").remove(),e("#zimageeditCanvasCreate, #zimageedit__svg--Icon,#zimageeditor__zoom--menu, #zimageeditor__blur--menu, #zimageeditor__context--menu ,#zimageeditor__marker--menu, #zimageeditor__linearrow--menu, #zimageeditor__plus--menu, #zimageditCanvasIE, #zimageeditor__strokewidth--menu").remove(),i._imageContainer.remove(),e("#zimageeditCanvasCreate, #zimageeditor, #zimageeditTempCropCanvas").remove(),e("#zimageeditor__sourceImage").remove()),i.undoStack.length=0,i.redoStack.length=0},close:function(){i.undoStack.length>=1?(e("body").addClass("zimageedit__alertDialog"),ZAlertDialog.open({type:"warning",position:"center",primaryMessage:i._getString("closeWarningMessgae.label"),secondaryMessage:i._getString("closeWarningMessgae2.label"),buttons:[{className:"zannotator__cancel--button",text:i._getString("discardChanges.label"),appearance:"primary",action:function(){e("#zimageeditor__btns--select").trigger("click"),i._close(),i.cancelEdit(),ZAlertDialog.close(),e("body").removeClass("zimageedit__alertDialog")}},{text:i._getString("cancel.label"),appearance:"secondary",id:"zimageedit__savealert--cancel",actions:function(){e("body").removeClass("zimageedit__alertDialog")}}],defaultActionButton:"#zimageedit__savealert--cancel"})):(e("#zimageeditor__btns--select").trigger("click"),i._close(),i.cancelEdit())},getValuesForFunc:function(){if(void 0===i._idSelected)return 0;var e=i.getValuesOfObject("#"+i._idSelected);i.element_attr=[e.top,e.left,e.width,e.height,e.tool]},_getString:function(e,t,i){return FCUtil.getI18NString("zannotator",e,i,this.options.keys)},functionForBlur:function(t,o,a){var n,r,s,l,d;if(d=i.editorSVG.createSVGPoint(),d.x=t.clientX,d.y=t.clientY,d=d.matrixTransform(i.editorSVG.getScreenCTM().inverse()),d.x<0||d.y<0)return 0;i.hasBlurred=!0;var c=i.editorSVG.getAttribute("viewBox").split(/\s+|,/),h=[d.x,d.y],u=a[1];a[1]>h[1]&&(u=h[1]);var m=a[0];a[0]>h[0]&&(m=h[0]),0>m&&(m=0),0>u&&(u=0);var p=Math.abs(a[1]-h[1]),g=Math.abs(a[0]-h[0]);m-=c[0],u-=c[1];var _=i.orginalCanvasFitToWidth;s=i._imageWidth,s*=i.currentZoomValue/100;var f=s/_;n=m*f,r=u*f,s=g*f,l=p*f;var v,b,y,z;"none"!==i._imageCanvas.css("display")?(v=parseFloat(i._imageCanvas.attr("width")),y=parseFloat(i._imageCanvas.css("width")),b=parseFloat(i._imageCanvas.attr("height")),z=parseFloat(i._imageCanvas.css("height"))):(v=parseFloat(i._imageCropCanvas.attr("width")),y=parseFloat(i._imageCropCanvas.css("width")),b=parseFloat(i._imageCropCanvas.attr("height")),z=parseFloat(i._imageCropCanvas.css("height"))),i.hasBlurredID=i._idSelected=i.temp_id,n+s>y&&(s=y-n),r+l>z&&(l=z-r),e("#"+i.temp_id).attr({width:s,height:l}).css({position:"absolute",left:n+110,top:r+80,"z-index":"3"}),n=(m+parseFloat(c[0]))*i.orginalRatio,r=(u+parseFloat(c[1]))*i.orginalRatio,e("#zimageedit__focus--shape, .zimageedit__active--shape").show();var S=g*i.orginalRatio,w=p*i.orginalRatio;s=0===s?1:s,l=0===l?1:l,m*i.orginalRatio+S>v&&(S=v-m*i.orginalRatio),u*i.orginalRatio+w>b&&(w=b-u*i.orginalRatio);var x=document.getElementById("zimageedit__canvas--blur");i.secCanvas.drawImage(x,Math.max(1,n),Math.max(1,r),Math.max(1,S),Math.max(1,w),0,0,Math.max(1,s),Math.max(1,l))},_blur:function(e,t){var i,o,a,n,r,s,l,d,c,h=e.width,u=e.height,m=e.data,p=t||0,g=r=s=l=d=c=0;for(n=0;p>n;n++)for(var _=0;2>_;_++)for(_?(d=h,l=u,r=4*h):(d=u,l=h,r=4),i=0;d>i;i++)for(s=0===_?i*h*4:4*i,a=0;3>a;a++){for(g=s+a,c=0,c=m[g]+m[g+r]+m[g+2*r],m[g]=Math.floor(c/3),c+=m[g+3*r],m[g+r]=Math.floor(c/4),c+=m[g+4*r],m[g+2*r]=Math.floor(c/5),o=3;l-2>o;o++)c=Math.max(0,c-m[g+(o-2)*r]+m[g+(o+2)*r]),m[g+o*r]=Math.floor(c/5);c-=m[g+(o-2)*r],m[g+o*r]=Math.floor(c/4),c-=m[g+(o-1)*r],m[g+(o+1)*r]=Math.floor(c/3)}return e},create_canvas:function(){var t=e("<canvas/>",{id:i.temp_id,position:"absolute","z-index":3,"class":"zimageedit__blur--canvas"});this._canvasContainer.append(t);var o=document.getElementById(i.temp_id);i.secCanvas=o.getContext("2d"),i._idSelected=i.temp_id},putValuesIntoCanvas:function(t,o,a,n,r){if(e("#"+t).attr({width:n,height:r}).css({left:o,top:a}),t=t.toString(),void 0!==t){var s=document.getElementById(t),l=s.getContext("2d"),d=i._ctx2.getImageData(o,a,n+1,r+1);l.putImageData(d,0,0)}},layeringFunction:function(t,o){var a,n,r,s,l,d=e("#zimageedit__triangle").index(),c=i.SVGElement.children().length,h=e("#zimageedit__focus--shape").index(),u=e("#"+o).attr("class");r=-1!=u.indexOf("zimageedit__textarea")?e("#"+o).parent().attr("id"):"zimageedit__numbering"===u||"zimageedit__numbering--input zimageedit__numbering"===u||-1!=u.indexOf("zimageedit__line")?o+"--group":o,r=e("#"+r),a=r.prevAll().length,n=r.nextAll().length,"bringForward"===t?n>c-h&&(l=i.SVGElement.children().eq(a+1).attr("id"),e(r).insertAfter("#"+l)):"bringToFront"===t?(s=e("#zimageeditor  .zimageedit__focus--shape").eq(0),e(r).insertBefore(s)):"sendToBack"===t?e(r).insertAfter("#zimageedit__triangle"):"moveBackward"===t&&a>=d+2&&(l=i.SVGElement.children().eq(a-1).attr("id"),e(r).insertBefore("#"+l));var m=i.typeOfElement(o);("pencil"===m||"marker"==m)&&i.createShadowForMarker(o)},saveFromCropToOrginalCanvas:function(){if("none"===i._imageCanvas.css("display")){var e,t,o,a,n,r;n=i.mainCanvas,e=document.getElementById("zimageditCropCanvas"),a=i.finalCropPosition[4],i.isIEBrowser&&(a=1),t=i.finalCropPosition[2]*a,o=i.finalCropPosition[3]*a,r=n.getContext("2d"),a=i.finalCropPosition[4],r.drawImage(e,0,0,t,o,i.finalCropPosition[0]*a,i.finalCropPosition[1]*a,t,o)}},saveFunction:function(t){function o(){try{"extension"!==i.options.annotatorType&&e(_).remove();var o;if(i.isImageCropped===!0){var a,r,s,l,d,c;d=i.finalCropPosition[4],a=i.finalCropPosition[0]*d,r=i.finalCropPosition[1]*d,s=i.finalCropPosition[2]*d,l=i.finalCropPosition[3]*d,c=document.getElementById("zimageeditCanvasCreate");var h=c.getContext("2d");h.drawImage(c,a,r,s,l,0,0,s,l);var u=e("<canvas>").attr({id:"zimageeditTempCropCanvas",width:s,height:l}).css({width:s,height:l});e("body").append(u);var m=document.getElementById("zimageditCropCanvas");if("extension"===i.options.annotatorType)var m=e("#zimageditCropCanvas").clone()[0];var p=m.getContext("2d");p.drawImage(g,0,0,s,l,0,0,s,l),o=m.toDataURL(i.imageType)}else o=g.toDataURL(i.imageType);i.onSuccess(o,t),i.editorSVG.setAttribute("viewBox",f),"extension"===i.options.annotatorType&&(e(n).css("display","block"),e("#zimageeditor__svgcontainer").css("display","block"))}catch(v){i.imageGenerationError(v,t)}}function a(t,a){i.imageEdited=e(t).children().length;var n=(new XMLSerializer).serializeToString(t);if(i.isIEBrowser===!1){var s=new Image;s.src="data:image/svg+xml;charset=utf8, "+encodeURIComponent(n),s.onload=function(){var e,t,n,s,l,d,c,h;for(e=r.length,a.drawImage(this,0,0),t=0;e>t;t++){n=r[t][0],s=r[t][1]*i.orginalRatio,l=r[t][2]*i.orginalRatio,d=r[t][5],c=parseFloat(r[t][6]),h=r[t][7],a.font="numbering"===r[t][8]?"400 "+c*i.orginalRatio+'px "Montserrat"':"700 "+c*i.orginalRatio+'px "Montserrat"';var u,u=14,m=10;14>=c?(m=4,u=4):20>=c?(m=6,u=8):36>=c?(m=8,u=12):(m=12,u=14),h===!0&&(a.shadowColor="#00000080",a.shadowBlur=u,a.lineWidth=m,a.lineJoin="round",a.strokeStyle="white",a.strokeText(n,l,s)),a.shadowBlur=0,a.fillStyle=d,a.fillText(n,l,s)}o()}}else{var l=document.createElement("canvas");l.id="zimageditCanvasIE",l.width=i._imageWidth,l.height=i._imageHeight,l.style.position="absolute",l.style.border="1px solid",l.style.visibility="hidden",e("body").append(l),canvg(document.getElementById("zimageditCanvasIE"),n),a.drawImage(document.getElementById("zimageditCanvasIE"),0,0);var d,c,h,u,m,p,g,_;for(d=r.length,c=0;d>c;c++)h=r[c][0],u=r[c][1]*i.orginalRatio,m=r[c][2]*i.orginalRatio,p=r[c][5],g=parseFloat(r[c][6])*i.orginalRatio,_=r[c][7],a.font=g+'px "Montserrat"',_===!0&&(a.shadowColor="black",a.shadowBlur=7,a.lineWidth=7,a.strokeStyle="white",a.strokeText(h,m,u),a.shadowBlur=0),a.fillStyle=p,a.fillText(h,m,u);o()}}i.imageEdited=!1;try{i.removeShadowForMarker(),i.resetMultiSelect();for(var n=e("foreignObject"),r="",s=0;s<n.length;s++){var l=e(n.eq(s)),d=l.children().eq(0);-1!==d.attr("class").indexOf("zimageedit__numbering--input")&&(d=l.parent()),"none"===d.css("display")&&e("#"+l.attr("id")).remove()}n=e("foreignObject");var c=i.convertTextArea();i.saveFromCropToOrginalCanvas();var h=e("<canvas>").attr({id:"zimageeditCanvasCreate",width:i._imageWidth,height:i._imageHeight}).css({width:i._imageWidth,height:i._imageHeight,visibility:"hidden"});e("body").append(h);var u=document.getElementById("zimageeditCanvasCreate"),m=u.getContext("2d"),p=i.mainCanvas;m.drawImage(p,0,0);var g=document.getElementById("zimageeditCanvasCreate");"extension"===this.options.annotatorType&&(e("#zimageeditor__svgcontainer").css("display","none"),e("body").css("overflow","hidden")),i.SVGElement.attr({width:i._imageWidth,height:i._imageHeight}).css({width:i._imageWidth,height:i._imageHeight}),i.removeCssFromCrop(),r=c,"extension"!==this.options.annotatorType&&(e(n).remove(),e("#zimageeditor .zimageedit__active--shape, #zimageeditor .zimageedit__focus--numbering, #zimageedit__triangle, #zimageeditor .zimageedit__focus--shape, #zimageedit__plus").remove()),e(n).css("display","none");var _=i.editorSVG,f=_.getAttribute("viewBox");_.setAttribute("viewBox","0 0 "+i._imageWidth/i.orginalRatio+" "+i._imageHeight/i.orginalRatio);var v=document.getElementById("zimageeditCanvasCreate"),b=v.getContext("2d");i.resetProperties(),/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),a(i.editorSVG,b)}catch(y){i.imageGenerationError(y)}},cancelEdit:function(){this.options.onCancel&&this.options.onCancel({change:!1,error:!1})},imageGenerationError:function(){ZAlertDialog.open({type:"error",title:i._getString("unexpectedError.label"),secondaryMessage:i._getString("imageSaveAlert.label"),buttons:[{text:i._getString("ok.label"),appearance:"primary"}],close:function(){i.onError("Image Save Error")}})},onSuccess:function(t){"function"==typeof i.options.onSuccess&&i.options.onSuccess({change:0===i.undoStack.length&&0===i.imageEdited?!1:!0,imageSource:t}),"extension"===this.options.annotatorType?(e("#zimageeditor__btns--select").trigger("click"),i._imageContainer.css("display","none")):i._close()},onError:function(e){this.options.onError&&this.options.onError({success:!1,error:!0,message:e}),i._close()},createDashedIconSVG:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");e(t).css({display:"none"}).attr({width:"45px",height:"45px"}),t.setAttribute("id","zimageedit__svg--Icon");var o,a,n=t.namespaceURI,r=document.createElementNS(n,"path");i.setAttributeForObj(r,["class","zimageedit__icon--dashedbig","fill","white","d","M15,8H4C1.8,8,0,6.2,0,4v0c0-2.2,1.8-4,4-4h11c2.2,0,4,1.8,4,4v0C19,6.2,17.2,8,15,8z"]),a=document.createElementNS(n,"path"),i.setAttributeForObj(a,["class","zimageedit__icon--dashedbig","fill","white","d","M38,8H27c-2.2,0-4-1.8-4-4v0c0-2.2,1.8-4,4-4h11c2.2,0,4,1.8,4,4v0C42,6.2,40.2,8,38,8z"]),o=document.createElementNS(n,"path"),i.setAttributeForObj(o,["class","zimageedit__icon--dashedbig","fill","white","d","M61,8H50c-2.2,0-4-1.8-4-4v0c0-2.2,1.8-4,4-4h11c2.2,0,4,1.8,4,4v0C65,6.2,63.2,8,61,8z"]);var s=document.createElementNS(n,"symbol");s.setAttribute("id","zimageedit__icon--dashedbig"),e(s).append(r).append(a).append(o),e(t).append(s),e("body").append(t),s=document.createElementNS(n,"symbol"),s.setAttribute("id","zimageedit__icon--dashedsmall"),r=document.createElementNS(n,"path"),i.setAttributeForObj(r,["class","zimageedit__icon--dashedsmall","fill","white","d","M11,4H2C0.9,4,0,3.1,0,2v0c0-1.1,0.9-2,2-2h9c1.1,0,2,0.9,2,2v0C13,3.1,12.1,4,11,4z"]),a=document.createElementNS(n,"path"),i.setAttributeForObj(a,["class","zimageedit__icon--dashedsmall","fill","white","d","M28,4h-9c-1.1,0-2-0.9-2-2v0c0-1.1,0.9-2,2-2h9c1.1,0,2,0.9,2,2v0C30,3.1,29.1,4,28,4z"]),o=document.createElementNS(n,"path"),i.setAttributeForObj(o,["class","zimageedit__icon--dashedsmall","fill","white","d","M45,4h-9c-1.1,0-2-0.9-2-2v0c0-1.1,0.9-2,2-2h9c1.1,0,2,0.9,2,2v0C47,3.1,46.1,4,45,4z"]),e(s).append(r).append(a).append(o),e(t).append(s)},createShadowForMarker:function(t){if(!i.multiSelectFlag){i.markerSelected=!0,e("#"+i._idSelected+"--shadow").length>0&&e("#"+i._idSelected+"--shadow, #"+i._idSelected+"--shadowblack").remove(),i.markerSelectedId=i._idSelected+"--shadow";var o=parseFloat(e("#"+t).attr("stroke-width"));e("#"+t).clone().attr({id:t+"--shadowblack",stroke:"#7f7f7f","stroke-opacity":.5,"stroke-width":o+6,"class":" ","stroke-linecap":"round"}).insertBefore("#"+t),e("#"+t).clone().attr({id:t+"--shadow",stroke:"white","stroke-opacity":.5,"stroke-width":o,"class":"","stroke-linecap":"round"}).insertBefore("#"+t)}},removeShadowForMarker:function(){e("#"+i.markerSelectedId).remove(),e("#"+i.markerSelectedId+"black").remove()},createCropDiv:function(){i.onCropDone=void 0,i.cropAreaLock=!1,i.cropCaptureCount>0&&(i.cropAreaLock=!0),i.cropCreated=!0,i.removeBorderFocus(),i.removeBorderForNumbering(),i.zoomScaleValue=i.fitToWidthZoomValue/100;var t=i.createDiv("zimaggeditor__crop--container","zimaggeditor__crop--container");e(t).appendTo(i.svgContainer);var o,a=Math.round(parseFloat(i.SVGElement.css("height"))),n=Math.round(parseFloat(i.SVGElement.css("width")));t.css({width:n,height:a}),e(".zimageedit__active--r3c1, .zimageedit__active--r3c3").css({visibility:"visible",display:"block"}),e(".zimageedit__active--r1c3").css("cursor","nesw-resize"),e(".zimageedit__active--r1c1").css("cursor","nwse-resize"),e(".zimageedit__active--shape").css("visibility","visible"),i.removePlusAttributes(),i.removeShadowForMarker(),i.cropAreaHeight=Math.round(a),i.cropAreaWidth=Math.round(n),i._svgRendering("zimageedit__crop__svg","zimageedit__crop__svg",e("#zimageeditor .zimaggeditor__crop--container")[0]),document.getElementById("zimageedit__crop__svg").setAttribute("viewBox","0 0 "+n+" "+a),i.focusElementRectWhite.clone().attr({id:"zimageedit__focus--crop","stroke-opacity":1,stroke:"black","stroke-dasharray":"4,4"}).appendTo(".zimageedit__crop__svg"),e("#zimageeditor__container .zimageedit__active--shape").not("polyline").clone().appendTo(".zimageedit__crop__svg"),i.cropSVGElement=document.getElementById("zimageedit__crop__svg");var r,s,l,d;r=n/90,s=r,l=n-2*r,d=a-2*s,r=(n-l)/2,i.fitToWidthZoomValue>100&&(l=l/i.fitToWidthZoomValue*100,d=d/i.fitToWidthZoomValue*100,r=(n-l)/2,s=(a-d)/2);var c=i.createDiv("zimageedit__crop--left","zimageedit__crop--left");e(t).append(c),c=i.createDiv("zimageedit__crop--top","zimageedit__crop--top"),e(t).append(c),c=i.createDiv("zimageedit__crop--right","zimageedit__crop--right"),e(t).append(c),c=i.createDiv("zimageedit__crop--bottom","zimageedit__crop--bottom"),e(t).append(c),i.modifyTheCropAreaValues(s,r,l,d),i.borderElement=e("#zimageeditor .zimageedit__active--shape"),i.drawBorder("crop_element",s,r,l,d);var h={stroke:"white",fill:"white","fill-opacity":0,"stroke-width":2,id:"zimageedit__crop","class":"ui_obj_svg_"+i._selectedTool};i._elem=i._svgElements("rect",h),e(i._elem).insertBefore("#zimageedit__focus--crop");var u=e(i._elem).attr("id");e("#"+u).css({position:"absolute",cursor:"move"}).attr({"class":"zimageedit__crop",x:r,y:s,width:l,height:d}),i.cropAnimationHandle(),i.isDraw=!0,i.pushIntoStack("create"),i.isDraw=!1;var m,p;p=e("#zimageeditor__image"),m=parseFloat(p.css("left")),o=parseFloat(p.css("top")),-85>o&&(o=0),-110>m&&(m=0),p.css({top:o,left:m}),i.svgContainer.css({top:o,left:m}),e("#zimageeditor__container").scrollLeft(r)},resizeCropBoundaries:function(t,o){var a,n,r,s,l;if(l=e("#zimageedit__crop"),a=parseFloat(l.attr("y")),n=parseFloat(l.attr("x")),r=parseFloat(l.attr("width")),s=parseFloat(l.attr("height")),i.cropAreaLock===!1)i.previousZoomValue>=100&&i.fitToWidthZoomValue>100?(a=(o-s)/2,n=(t-r)/2):(a=o/12,n=t/12,r=t-n,s=o-a,a/=2,n/=2);else{var d=i.currentZoomValue/i.previousZoomValue;a*=d,n*=d,r*=d,s*=d}var c=document.getElementById("zimageedit__crop__svg");c.setAttribute("viewBox","0 0 "+t+" "+o),e("#zimageeditor__container .zimageedit__crop").attr({y:a,x:n,width:r,height:s}),e("#zimaggeditor__crop--container").css({width:t,height:o}),i.cropAreaWidth=Math.round(t),i.cropAreaHeight=Math.round(o),i.modifyTheCropAreaValues(a,n,r,s),i.drawBorder("crop_element",a,n,r,s)},cropAnimationHandle:function(){var t=!1;i.toolBarMoved===!0?(t=!0,e("#zimageeditor .zimageeditor__tools").removeClass("zimageeditor__tools--animationShow").css("visibility","visible"),e("#zimageeditor .zimageeditor__tools").addClass("zimageeditor__tools--animationHide")):(e("#zimageeditor .zimageeditor__tools").addClass("zimageeditor__transistionToolHide"),e("#zimageeditor .zimageeditor__transistionToolHide").on("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){e(this).removeClass("zimageeditor__transistionToolHide"),e("#zimageeditor .zimageeditor__tools").css("visibility","hidden")})),i.propertiesBarMoved===!0?(t=!0,i.propertiesMenu.addClass("zimageeditor__tools--animationHide")):i.propertiesMenu.addClass("zimageeditor__transistionHeaderHide"),t===!0&&e(".zimageeditor__tools--animationHide").on("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){"zimageeditor__textarea--menu"===e(this).attr("id")?e(this).removeClass("zimageeditor__tools--animationHide"):e(this).removeClass("zimageeditor__tools--animationHide").css("visibility","hidden")}),e(".zimageeditor__tools--animationHide").on("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){e(this).removeClass("zimageeditor__tools--animationHide"),"zimageeditor__textarea--menu"===e(this).attr("id")&&i.hideProperties()}),0===e("#zimageeditor .zimageeditor__crop--done").length&&(e("#zimageeditor .zimageeditor__done, #zimageeditor .zimageeditor__cancel").addClass("zimageeditor__transistionHeaderHide"),e("#zimageeditor .zimageeditor__cancel").addClass("zimageeditor__crop--cancel")),e(".zimageeditor__transistionHeaderHide").on("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){if("zimageeditor__textarea--menu"===e(this).attr("id")?i.hideProperties():e(this).addClass("zimageeditor__transistionHeaderShow").removeClass("zimageeditor__transistionHeaderHide"),e("#zimageeditor .zimageeditor__done").addClass("zimageeditor__crop--done"),e("#zimageeditor .zimageeditor__crop--done").html(i._getString("crop.label")),"extension"===i.options.annotatorType&&e("#zimageeditor .zimageeditor__crop--cancel").html(i._getString("cancel.label")),e("#zimageeditor .zimageeditor__crop--done").off("click",i.CropDone),e("#zimageeditor .zimageeditor__crop--cancel").off("click",i.onCropCancel),e("#zimageeditor .zimageeditor__crop--done").on("click",i.CropDone),e("#zimageeditor .zimageeditor__crop--cancel").on("click",i.onCropCancel),i.onCropDone===!1||i.onCropDone===!0){e("#zimageeditor__tools .zimageeditor__tools").hasClass("zimageeditor__transistionToolShow")===!1&&(i.toolBarMoved===!0?e("#zimageeditor .zimageeditor__tools").addClass("zimageeditor__tools--animationShow").css("visibility","visible"):(e("#zimageeditor .zimageeditor__tools").addClass("zimageeditor__transistionToolShow"),e(".zimageeditor__transistionToolShow").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){e("#zimageeditor .zimageeditor__tools").css("visibility","visible")})),e("#zimageeditor .zimageeditor__transistionToolShow").on("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){e(this).removeClass("zimageeditor__transistionToolShow"),e("#zimageeditor .zimageeditor__tools").css("visibility","visible")})),e("#zimageeditor .zimageeditor__crop--done").off("click",i.CropDone),e("#zimageeditor .zimageeditor__crop--cancel").off("click",i.onCropCancel);var t=i._getString("done.label");i.options.finishButton&&i.options.finishButton.text&&(t=i.options.finishButton.text),"extension"===i.options.annotatorType&&e("#zimageeditor .zimageeditor__cancel").html(i._getString("discardChanges.label")),e("#zimageeditor .zimageeditor__done").html(t).removeClass("zimageeditor__crop--done"),e("#zimageeditor .zimageeditor__cancel").removeClass("zimageeditor__crop--cancel"),e(".zimageeditor__transistionHeaderShow").on("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){e(this).removeClass("zimageeditor__transistionHeaderShow")})}})},cropCancelAnimationHandle:function(){i.toolBarMoved===!0&&e("#zimageeditor .zimageeditor__tools").addClass("zimageeditor__tools--animationShow").css("visibility","visible"),e("#zimageeditor .zimageeditor__done, #zimageeditor .zimageeditor__cancel").addClass("zimageeditor__transistionHeaderHide")},resetToDefaultAfterCrop:function(){i.cropCreated=!1,i.zoomScaleValue=1,e("#zimageeditor .zimageeditor__imgname, #zimageeditor .zimageeditor__done, #zimageeditor .zimageeditor__cancel").removeClass("zimageeditor__transistionHeaderShow"),i._selectedTool=i.previousSelectedTool,e("#zimageeditor .zimageeditor__crop--done").off("click",i.CropDone),e("#zimageeditor .zimageeditor__crop--cancel").off("click",i.onCropCancel),e("#zimageedit__crop").remove(),e("#zimageeditor .zimageeditor__cancel").removeClass("zimageeditor__crop--cancel"),e("#zimageeditor .zimageeditor__done").removeClass("zimageeditor__crop--done"),i.cropSelected=!1,i.resetMultiSelect(),i.propertiesMenu.removeClass("zimageeditor__transistionHeaderHide"),e("#zimageeditor .zimageeditor__footer").css({visibility:"visible"}),i.borderElement=e("#zimageeditor .zimageedit__active--shape"),i.cursorHandling({type:"toolSelect",tool:i._selectedTool})},showProperties:function(t,o){i.multiSelectFlag===!1&&i.hideProperties(),i.PropertiesMenuVisible=!0;var a=e("#"+t).css("text-shadow"),n=0;if(i.numberingStrokeSelected=!1,i.propertiesMenu.zmenu("hideMenuItems"),"multiSelect"===o)i.PropertiesAvailableForMultiSelect[0]&&(n++,i.propertiesMenu.zmenu("showMenuItems",["#zimageedit__icon--cfill"])),i.PropertiesAvailableForMultiSelect[1]&&(n++,i.propertiesMenu.zmenu("showMenuItems",["#zimageedit__icon--cstroke"])),i.PropertiesAvailableForMultiSelect[2]&&(n++,i.propertiesMenu.zmenu("showMenuItems",["#zimageedit__icon--cstrokWidth"])),i.PropertiesAvailableForMultiSelect[3]&&(n+=3,i.propertiesMenu.zmenu("showMenuItems",["#zimageeditor--fontsize--slider","#zimageeditor__text--fontcolor","#zimageedit__icon--textglow"])),i.PropertiesAvailableForMultiSelect[6]&&(0===n&&(i.numberingStrokeSelected=!0),n++,i.propertiesMenu.zmenu("showMenuItems",["#zimageedit__icon--cstroke"])),n>0&&(n++,i.propertiesMenu.zmenu("showMenuItems",["#zimageeditor--propertiesTool--header"]));else if("textarea"===o){i.propertiesMenu.zmenu("showMenuItems",["#zimageeditor--propertiesTool--header","#zimageeditor--fontsize--slider","#zimageeditor__text--fontcolor","#zimageedit__icon--textglow"]),n=4;var r=e(i._noOfIdSelected[0]),s=parseFloat(r.css("font-size")),l=r.css("color");e("#zimageeditor__text--fontcolor .zimageedit__fontcolor").css("background-color",l),e("#zimageeditor__fontsize--slider").zslider("setValue",s)}else if("ellipse"===o)e("#zimageedit__icon--cstroke").attr("title",i._getString("borderColor.label")),e("#zimageedit__icon--cstrokWidth").attr("title",i._getString("borderWidth.label")),i.propertiesMenu.zmenu("showMenuItems",["#zimageeditor--propertiesTool--header","#zimageedit__icon--cfill","#zimageedit__icon--cstroke","#zimageedit__icon--cstrokWidth"]),n=4;else if("line"===o)e("#zimageedit__icon--cstroke").attr("title",i._getString("lineColor.label")),e("#zimageedit__icon--cstrokWidth").attr("title",i._getString("lineWidth.label")),i.propertiesMenu.zmenu("showMenuItems",["#zimageeditor--propertiesTool--header","#zimageedit__icon--cstroke","#zimageedit__icon--cstrokWidth"]),n=3;else if("numbering"===o){e("#zimageedit__icon--cstroke").attr("title",i._getString("borderColor.label")),i.numberingStrokeSelected=!0;var d=i.getValuesOfObject(i._noOfIdSelected[0]).borderStroke;i.changeIconColorProperties(void 0,d),i.propertiesMenu.zmenu("showMenuItems",["#zimageeditor--propertiesTool--header","#zimageedit__icon--cstroke"]),n=2}return i.propertiesMenu.zmenu("setMenuItemsAttribute",["#zimageedit__icon--textglow"],"checked","none"!==a),i.propertiesMenu.on("zmenubeforefocus",function(){return!1}),8===n?(i.propertiesMenu.zmenu("hideMenuItems"),void(n=0)):void(0!==n&&(i.propertiesMenu.zmenu("setAttribute","columnCount",n),i.propertiesMenu.is(":visible")?i.propertiesMenu.on("zmenuhide",function(){i.PropertiesMenuVisible===!0&&i.propertiesMenu.zmenu("show",{forElement:"#zimageeditor__svgcontainer",direction:"bottom-left",position:{top:i.propertiesTop,left:i.propertiesLeft}})}):i.propertiesMenu.zmenu("show",{forElement:"#zimageeditor__svgcontainer",direction:"bottom-left",position:{top:i.propertiesTop,left:i.propertiesLeft}})))},createPlusMenu:function(t){if(!e("#zimageedit__plus").length){var o=document.createElementNS(i.svgPath,"g");i.setAttributeForObj(o,["id","zimageedit__plus","class","zimageedit__plus","data-objectmenu","plus"]);var a=document.createElementNS(i.svgPath,"circle");i.setAttributeForObj(a,["class","zimageedit__plus","id","zimageedit__plus--cirlce","cx",8,"cy",8,"r","8"]),e(o).append(a);var n=document.createElementNS(i.svgPath,"path");i.setAttributeForObj(n,["d","M12,7H9V4c0-0.6-0.4-1-1-1h0C7.4,3,7,3.4,7,4v3H4C3.4,7,3,7.4,3,8v0c0,0.6,0.4,1,1,1h3v3c0,0.6,0.4,1,1,1h0c0.6,0,1-0.4,1-1V9h3c0.6,0,1-0.4,1-1v0C13,7.4,12.6,7,12,7z","class","zimageedit__plus","id","zimageedit__plus--polygon"]),e(o).append(n),e(t).append(o),e("#zimageedit__plus").on("mousedown",function(t){t.preventDefault(),t.stopPropagation(),i.lastHover=e(this),void 0!==i.lastHover.data("objectmenu")&&(menuToBeOpen=e("#zimageeditor__"+i.lastHover.data("objectmenu")+"--menu")),setTimeout(function(){i.handleMenuOpen(t,menuToBeOpen)},100)})}},showPlusMenu:function(t){if(i.multiSelectFlag===!0)return!0;var o=i.calculateElementPosition(t),a={left:o.left,right:o.right};o.top=o.top+o.height/2-8,o.left=o.left+o.width+o.borderWidth/2+6;var n=i.editorSVG.getAttribute("viewBox").split(/\s+|,/);parseFloat(n[2])<o.left+15-parseFloat(n[0])&&(o.left=a.left-30),e("#zimageedit__plus").attr({transform:"translate("+o.left+","+o.top+")"}).css("visibility","visible")},calculateElementPosition:function(e){var t=i.getValuesOfObject("#"+e);return"ellipse"===t.tool&&(t.top-=t.height,t.left-=t.width,t.width*=2,t.height*=2),t},hideProperties:function(){i.propertiesMenu.is(":visible")===!0&&(i.PropertiesMenuVisible=!1,i.propertiesMenu.zmenu("hide"),e("#zimageedit__done--splitMenu").is(":visible")===!0&&e("#zimageedit__done--splitMenu").zmenu("hide"))},hidePlusMenu:function(){e("#zimageeditor__plus--menu").is(":visible")===!0&&e("#zimageeditor__plus--menu").zmenu("hide")},removePlusAttributes:function(){e("#zimageedit__plus").css("visibility","hidden")},catureButtonClickFunction:function(){var t,o,a,n,r,s,l=i.editorSVG.getAttribute("viewBox").split(/\s+|,/),d=document.getElementById("zimageditCropCanvas"),c=e("#zimageedit__crop");a=parseInt(c.attr("x")),n=parseInt(c.attr("y")),r=parseInt(c.attr("width")),s=parseInt(c.attr("height"));var h=d.getContext("2d");if("none"===i._imageCanvas.css("display")){t=document.getElementById("zimageditCropCanvas"),o=i._imageCropCanvas,i._imageCropCanvas.clone().attr("id","zimageedit__crop--tempElement").appendTo("#zimageeditor__image");var u=document.getElementById("zimageedit__crop--tempElement").getContext("2d");u.drawImage(t,0,0),t=document.getElementById("zimageedit__crop--tempElement")}else t=i.mainCanvas,o=i._imageCanvas;var m=parseFloat(o.attr("width"))/parseFloat(o.css("width"));i._imageCropCanvas.attr({width:r*m,height:s*m}).css({display:"block",width:r,height:s}),h.drawImage(t,a*m,n*m,r*m,s*m,0,0,r*m,s*m);var p=a/i.fitToWidthZoomValue*100+parseFloat(l[0])+" "+(n/i.fitToWidthZoomValue*100+parseFloat(l[1]))+" "+r/i.fitToWidthZoomValue*100+" "+s/i.fitToWidthZoomValue*100;i.editorSVG.setAttribute("viewBox",p),i.SVGElement.attr({width:r,height:s}),e("#zimageeditor__svgcontainer").css({width:r,height:s}),i._idSelected="zimageedit__crop",i._imageCanvas.css("display","none"),i.isDraw=!0,i.pushIntoStack("create",1);var g=i.undoStack[i.undoStack.length-1];i.updateFinalCropPosition(g.canvasPosition[0],g.canvasPosition[1],g.canvasPosition[2],g.canvasPosition[3],g.canvasPosition[4]),i.isDraw=!1,i.addorRemoveTopBand(e(window).height(),s),i.placeCropAreaInCenter(n,a,r,s),a+=110,n+=85,i.cropImageWidth=r*m,i._crop_arr=[a,n,r,s,i._imageWidth/i.actualWidth,i.fitToWidthZoomValue],r=a+r,s=n+s,e("#zimageedit__crop--tempElement").remove()},updateFinalCropPosition:function(e,t,o,a,n){i.finalCropPosition=[e,t,o,a,n]},placeCropAreaInCenter:function(t,o,a,n){var r,s;s=e(window).height(),r=e(window).width();var l=(s-n)/2,d=(r-a)/2,c=e("#zimageeditor__image");c.css({left:0>d-110?0:d-110,top:0>l-85?0:l-85}),i.svgContainer.css({left:0>d-110?0:d-110,top:0>l-85?0:l-85}),e("#zimageeditor .zimageeditor__container").scrollLeft(a>s?(a-r)/2:0),e("#zimageeditor .zimageeditor__container").scrollTop(n>s?(n-s)/2:0)},createDiv:function(t,i){var o=e("<div>",{"class":t,id:i});return o},modifyTheCropAreaValues:function(t,o,a,n){n=Math.round(n),t=Math.round(t);var r=t<i.cropAreaHeight?t:i.cropAreaHeight,s=n+t<i.cropAreaHeight?n:i.cropAreaHeight-t;e("#zimaggeditor__crop--container .zimageedit__crop--top").css({height:r}),e("#zimaggeditor__crop--container .zimageedit__crop--right").css({top:r,height:s,width:i.cropAreaWidth-(o+a)}),e("#zimaggeditor__crop--container .zimageedit__crop--left").css({top:r,height:s,width:o}),e("#zimaggeditor__crop--container   .zimageedit__crop--bottom").css({height:i.cropAreaHeight-(t+n)<=0?1:i.cropAreaHeight-(t+n)})},checkForSelectedElement:function(t,i){var o,a;if(("undefined"==typeof i||0!==i.length)&&(a=e("#"+i).attr("class"),"undefined"!=typeof a)){for(o=0;o<t.length;o++)if("smudge"===t[o]){var n,r;if(n=e("#"+i).attr("class"),r=e("#"+i).attr("ctype"),"zimageedit__blur--canvas"===n)return!0;if(void 0!==r&&"smudge"===r)return!0}else if("crop"===t[o]){if("zimageedit__crop"===a||"zimaggeditor__crop--container"===e("#"+i).parent().attr("class"))return!0}else if("numbering"===t[o]){if("zimageedit__numbering--input zimageedit__numbering"===a||"zimageedit__numbering"===a||"zimagedit__numbering--fobject"===a)return!0}else if("svg"===t[o]){if(-1!=a.indexOf("zimageeditor__svgeditor"))return!0}else if("ellipse"===t[o]){if(-1!=a.indexOf("zimageedit__ellipse"))return!0}else if("rectangle"===t[o]){if(-1!=a.indexOf("zimageedit__rectangle"))return!0}else if("line"===t[o]){if(-1!=a.indexOf("zimageedit__line"))return!0}else if("marker"===t[o]){if(-1!=a.indexOf("zimageedit__marker"))return!0}else if("pencil"===t[o]){if(-1!=a.indexOf("zimageedit__polyline"))return!0}else if("textarea"===t[o]&&-1!=a.indexOf("zimageedit__textarea"))return!0;return!1}},typeOfElement:function(t){if("undefined"!=typeof t&&0===t.length)return"none";var i,o=e("#"+t).attr("class");return void 0===o?"none":(-1!=o.indexOf("zimageedit__textarea")?i="textarea":-1!=o.indexOf("zimageedit__ellipse")?i="ellipse":-1!=o.indexOf("zimageedit__marker")?i="marker":-1!=o.indexOf("zimageedit__rectangle")?i="rectangle":-1!==o.indexOf("zimageedit__polyline")?i="pencil":-1!=o.indexOf("zimageedit__line")?i="line":"zimageeditor__svgeditor"===o?i="svg":"zimageedit__numbering--input zimageedit__numbering"===o||-1!=o.indexOf("zimageedit__numbering")||"zimagedit__numbering--fobject"===o?i="numbering":("zimageedit__crop"===o||"zimaggeditor__crop--container"===e("#"+t).parent().attr("class"))&&(i="crop"),i)},convertTextArea:function(){var t,o,a,n,r,s,l,d,c,h="",u=1;for(c=[[]],a=e("#zimageeditor__svgeditor foreignObject"),i.isIEBrowser&&(a=e("#zimageeditor__svgcontainer div")),t=a.length,d=0;t>=u;){var m=a[u-1].id,p=e("#"+m).attr("class");u++;var g=e("#"+m).children().eq(0);g=e(g).attr("id"),g=e("#"+g),g[0].tagName&&"textarea"===g[0].tagName.toLowerCase()&&i.insertLineBreaksTorginalTextarea(m),o=e(g).val(),"zimagedit__numbering--fobject"===p&&(g=e("#zimageeditor__svgeditor .zimageedit__numbering")),r=e(g).css("color"),s=e(g).css("font-size"),l=g.css("text-shadow").length>10,g=e("#"+m);var _,f,v,b,y;_=parseFloat(e(g).attr("y")),f=parseFloat(e(g).attr("x")),-1!==g.attr("class").indexOf("zimagedit__numbering--fobject")?(y="numbering",f+=14,_+=5,o.length<=1&&"1"!==o&&(f-=4),"1"===o?f-=1:"2"===o||"3"===o||parseInt(o)>10?f+=2:parseInt(o)>=5&&parseInt(o)<=10&&(f+=1),o.length>1&&(f-=7,_+=1,i.isIEBrowser&&(f+=5),parseInt(o)>=20&&parseInt(o)<=30&&(f-=2))):f+=2,v=e(g).attr("width"),b=e(g).attr("height"),void 0!==o?n=o.split("\n"):o=" ",n=o.split("\n");var z,S=document.createElement("div");for(_+=parseFloat(s),z=0;z<n.length;z++){var w=document.createElementNS(i.svgPath,"text");e(w).attr("font-family","Montserrat").css("font-family","Montserrat"),i.setAttributeForObj(w,["x",f+5,"y",_-3,"fill","#0c9","font-size","22px"]);var x=document.createTextNode(n[z]);w.appendChild(x),S.appendChild(w),c[d]=[n[z],_,f,v,b,r,s,l,y],_+=parseFloat(s)+4,d++}h+=S.innerHTML}return c},insertLineBreaksTorginalTextarea:function(e){var t="--fobject";e=e.substr(0,e.length-t.length);var i=document.getElementById(e);if(i.setAttribute("wrap","off"),!i.wrap){var o=i.cloneNode(!0);o.value=i.value,i.parentNode.replaceChild(o,i),i=o}var a=i.value;i.value="";for(var n=i.scrollWidth,r=-1,s=0;s<a.length;s++){var l=a.charAt(s);if((" "==l||"-"==l||"+"==l)&&(r=s),i.value+=l,i.scrollWidth>n){var d="";if(r>=0){for(var c=r+1;s>c;c++)d+=a.charAt(c);r=-1}d+=l,i.value=i.value.substr(0,i.value.length-d.length),i.value+="\n"+d}}i.setAttribute("wrap","")},_touchInit:function(){var e=document.getElementById("zimageeditor__svgcontainer");e.addEventListener("touchstart",i._touchHandler,!0),e.addEventListener("touchmove",i._touchHandler,!0),e.addEventListener("touchend",i._touchHandler,!0),e.addEventListener("touchcancel",i._touchHandler,!0);var t=document.getElementById("zimageeditor__tools--header");t.addEventListener("touchstart",i._touchHandler,!0),t.addEventListener("touchmove",i._touchHandler,!0),t.addEventListener("touchend",i._touchHandler,!0),t.addEventListener("touchcancel",i._touchHandler,!0)},_touchHandler:function(e){var t=e.changedTouches,i=t[0],o="";switch(e.type){case"touchstart":o="mousedown";break;case"touchmove":o="mousemove";break;case"touchend":o="mouseup";break;default:return}var a=document.createEvent("MouseEvent");a.initMouseEvent(o,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(a),e.preventDefault()},_doubleTouchHandler:function(t){if("mouseup"===t.type&&("textarea"===t.target.type||"text"===t.target.type)){if(i.tapped)return clearTimeout(i.tapped),i.tapped=!1,void e("#"+t.target.id).trigger("dblclick");i.tapped=setTimeout(function(){i.tapped=!1},300),i.tapped=!0}},_triggerEvent:function(t,i){var o=i;void 0===i&&(o=e.extend(o,i)),e("body").trigger(this.widgetEventPrefix+t,o)}};return{init:function(e){i._create(e)},open:function(e){i._create(e)},close:function(){i._close()},updateOptions:function(e){i._create(e)},isDrawn:function(){return"undefined"!=typeof i.undoStack?i.undoStack.length>=1:!1}}}(window.jQuery);